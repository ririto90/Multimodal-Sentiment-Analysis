PyTorch version: 2.1.1
CUDA available: True
CUDA version: 12.3
True
1
0
NVIDIA A100-PCIE-40GB
************no tfn layer************
> training arguments:
>>> rand_seed: 25
>>> model_name: mmfusion
>>> dataset: mvsa-m
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f3facb09e40>
>>> learning_rate: 0.001
>>> dropout_rate: 0.5
>>> num_epoch: 100
>>> batch_size: 64
>>> log_step: 50
>>> logdir: log
>>> embed_dim: 100
>>> hidden_dim: 100
>>> max_seq_len: 24
>>> polarities_dim: 3
>>> hops: 3
>>> att_file: ./att_file/
>>> pred_file: ./pred_file/
>>> clip_grad: 5.0
>>> path_image: ../../Datasets/MVSA/mvsa_images
>>> crop_size: 224
>>> fine_tune_cnn: False
>>> att_mode: vis_concat_attimg_gate
>>> resnet_root: ./resnet
>>> checkpoint: ./checkpoint/
>>> load_check_point: False
>>> load_opt: False
>>> tfn: False
>>> model_class: <class 'models.mmfusion.MMFUSION'>
>>> inputs_cols: ['text_left_indicator', 'text_right_indicator', 'aspect_indices']
>>> device: cuda
Before model allocation:
Allocated: 0.00 MB
Cached:    0.00 MB
preparing mvsa-m dataset...
loading word vectors...
building embedding_matrix: 100_mvsa-m_embedding_matrix.dat
--------------./datasets/mvsa-m/train.txt---------------
image has problem!
image has problem!
image has problem!
the number of problematic samples: 3
--------------./datasets/mvsa-m/dev.txt---------------
image has problem!
the number of problematic samples: 1
--------------./datasets/mvsa-m/test.txt---------------
the number of problematic samples: 0
building model
Before absa_dataset allocation:
Allocated: 230.28 MB
Cached:    244.00 MB
After model allocation:
Allocated: 254.87 MB
Cached:    268.00 MB
DataParallel(
  (module): MMFUSION(
    (embed): Embedding(51574, 100)
    (lstm_aspect): DynamicLSTM(
      (RNN): LSTM(100, 100, batch_first=True)
    )
    (lstm_l): DynamicLSTM(
      (RNN): LSTM(100, 100, batch_first=True)
    )
    (lstm_r): DynamicLSTM(
      (RNN): LSTM(100, 100, batch_first=True)
    )
    (attention_l): Attention2(
      (proj): Linear(in_features=100, out_features=100, bias=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (attention_r): Attention2(
      (proj): Linear(in_features=100, out_features=100, bias=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (visaspect_att_l): MMAttention(
      (proj): Linear(in_features=100, out_features=100, bias=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (visaspect_att_r): MMAttention(
      (proj): Linear(in_features=100, out_features=100, bias=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (ltext2hidden): Linear(in_features=100, out_features=100, bias=True)
    (laspect2hidden): Linear(in_features=100, out_features=100, bias=True)
    (rtext2hidden): Linear(in_features=100, out_features=100, bias=True)
    (raspect2hidden): Linear(in_features=100, out_features=100, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
    (aspect2text): Linear(in_features=100, out_features=100, bias=True)
    (vismap2text): Linear(in_features=2048, out_features=100, bias=True)
    (vis2text): Linear(in_features=2048, out_features=100, bias=True)
    (gate): Linear(in_features=2448, out_features=100, bias=True)
    (madality_attetion): Linear(in_features=100, out_features=1, bias=True)
    (text2hiddenvis): Linear(in_features=400, out_features=100, bias=True)
    (vis2hiddenvis): Linear(in_features=100, out_features=100, bias=True)
    (dense_6): Linear(in_features=600, out_features=3, bias=True)
  )
)
n_trainable_params: 1200104, n_nontrainable_params: 5157400
parameters only include text parts without word embeddings
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  0
loss: 0.9571, acc: 0.5071, dev_acc: 0.5250, test_acc: 0.5036
dev_f1: 0.2887, test_f1: 0.2773
loss: 0.8823, acc: 0.5129, dev_acc: 0.5253, test_acc: 0.5082
dev_f1: 0.3006, test_f1: 0.2917
loss: 0.8063, acc: 0.5342, dev_acc: 0.5413, test_acc: 0.5224
dev_f1: 0.3418, test_f1: 0.3371
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  1
loss: 0.8809, acc: 0.5512, dev_acc: 0.5365, test_acc: 0.5347
dev_f1: 0.3859, test_f1: 0.4026
loss: 0.8904, acc: 0.5600, dev_acc: 0.5253, test_acc: 0.5401
dev_f1: 0.3918, test_f1: 0.4145
loss: 0.8550, acc: 0.5608, dev_acc: 0.5321, test_acc: 0.5426
dev_f1: 0.3717, test_f1: 0.3979
loss: 0.8863, acc: 0.5681, dev_acc: 0.5378, test_acc: 0.5462
dev_f1: 0.3901, test_f1: 0.4182
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  2
loss: 0.9315, acc: 0.5668, dev_acc: 0.5380, test_acc: 0.5464
dev_f1: 0.3742, test_f1: 0.3967
loss: 0.9411, acc: 0.5750, dev_acc: 0.5452, test_acc: 0.5436
dev_f1: 0.4060, test_f1: 0.4183
loss: 0.7691, acc: 0.5760, dev_acc: 0.5383, test_acc: 0.5436
dev_f1: 0.4044, test_f1: 0.4128
loss: 0.9397, acc: 0.5808, dev_acc: 0.5429, test_acc: 0.5490
dev_f1: 0.3809, test_f1: 0.3957
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  3
loss: 0.8028, acc: 0.5866, dev_acc: 0.5360, test_acc: 0.5431
dev_f1: 0.3999, test_f1: 0.4252
loss: 0.9390, acc: 0.5938, dev_acc: 0.5431, test_acc: 0.5500
dev_f1: 0.4247, test_f1: 0.4347
loss: 0.8877, acc: 0.5946, dev_acc: 0.5311, test_acc: 0.5508
dev_f1: 0.3921, test_f1: 0.4251
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  4
loss: 0.7522, acc: 0.6029, dev_acc: 0.5357, test_acc: 0.5526
dev_f1: 0.3978, test_f1: 0.4211
loss: 0.7743, acc: 0.6044, dev_acc: 0.5227, test_acc: 0.5436
dev_f1: 0.3903, test_f1: 0.4178
loss: 0.8122, acc: 0.6180, dev_acc: 0.5258, test_acc: 0.5334
dev_f1: 0.4152, test_f1: 0.4253
loss: 0.7019, acc: 0.6190, dev_acc: 0.5393, test_acc: 0.5480
dev_f1: 0.4182, test_f1: 0.4255
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  5
loss: 0.7289, acc: 0.5966, dev_acc: 0.5321, test_acc: 0.5265
dev_f1: 0.3915, test_f1: 0.3930
loss: 0.8184, acc: 0.6207, dev_acc: 0.5089, test_acc: 0.5362
dev_f1: 0.4186, test_f1: 0.4353
loss: 0.6992, acc: 0.6240, dev_acc: 0.5084, test_acc: 0.5253
dev_f1: 0.4170, test_f1: 0.4351
