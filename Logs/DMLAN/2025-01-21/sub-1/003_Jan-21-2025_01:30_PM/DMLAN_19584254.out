SLURM Job ID: 19584254
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/DMLAN/2025-01-21/sub-1/003_Jan-21-2025_01:30_PM
> training arguments:
>>> rand_seed: 8
>>> model_fusion: dmlanfusion
>>> dataset: mvsa-mts-v3-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f7f651c54e0>
>>> learning_rate: 0.001
>>> dropout_rate: 0.5
>>> weight_decay: 0.0
>>> num_layers: 3
>>> num_epoch: 20
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 768
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/DMLAN/2025-01-21/sub-1/003_Jan-21-2025_01:30_PM
>>> model_class: <class 'models.dmlanfusion.DMLANFUSION'>
Preparing mvsa-mts-v3-1000 dataset...
loading word vectors...
building embedding_matrix: 200_glove_embedding_matrix.dat
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-v3-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-v3-1000/train.tsv: 19.42 seconds (0.32 minutes)
The number of problematic samples: 0
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-v3-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-v3-1000/val.tsv: 2.36 seconds (0.04 minutes)
The number of problematic samples: 0
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-v3-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-v3-1000/test.tsv: 2.41 seconds (0.04 minutes)
The number of problematic samples: 0
Total Training Samples: 1000
Number of Training Samples: 800
Number of Validation Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 1446888, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.71 seconds (0.01 minutes)
New best val_f1: 0.169154 (previous best: 0.000000)
loss: 1.051061, val_acc: 34.00% (0.340000), val_f1: 16.92% (0.169154), test_acc: 35.00% (0.350000), test_f1: 17.28% (0.172840)
Epoch 0 completed in 2.27 seconds (0.04 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.07 seconds (0.00 minutes)
New best val_f1: 0.187050 (previous best: 0.169154)
loss: 1.148864, val_acc: 39.00% (0.390000), val_f1: 18.71% (0.187050), test_acc: 38.00% (0.380000), test_f1: 18.36% (0.183575)
Epoch 1 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.07 seconds (0.00 minutes)
New best val_f1: 0.187093 (previous best: 0.187050)
loss: 1.094271, val_acc: 35.00% (0.350000), val_f1: 18.71% (0.187093), test_acc: 34.00% (0.340000), test_f1: 17.17% (0.171717)
Epoch 2 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.07 seconds (0.00 minutes)
New best val_f1: 0.304791 (previous best: 0.187093)
loss: 1.047273, val_acc: 33.00% (0.330000), val_f1: 30.48% (0.304791), test_acc: 36.00% (0.360000), test_f1: 32.32% (0.323221)
Epoch 3 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.980761, val_acc: 38.00% (0.380000), val_f1: 24.61% (0.246128), test_acc: 38.00% (0.380000), test_f1: 23.28% (0.232804)
Epoch 4 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 1.013229, val_acc: 34.00% (0.340000), val_f1: 28.25% (0.282492), test_acc: 40.00% (0.400000), test_f1: 31.34% (0.313400)
Epoch 5 completed in 1.43 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.07 seconds (0.00 minutes)
New best val_f1: 0.330928 (previous best: 0.304791)
loss: 0.883278, val_acc: 34.00% (0.340000), val_f1: 33.09% (0.330928), test_acc: 41.00% (0.410000), test_f1: 37.84% (0.378355)
Epoch 6 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.07 seconds (0.00 minutes)
New best val_f1: 0.367408 (previous best: 0.330928)
loss: 0.920464, val_acc: 37.00% (0.370000), val_f1: 36.74% (0.367408), test_acc: 41.00% (0.410000), test_f1: 37.69% (0.376859)
Epoch 7 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.676578, val_acc: 34.00% (0.340000), val_f1: 34.05% (0.340502), test_acc: 41.00% (0.410000), test_f1: 38.10% (0.380952)
Epoch 8 completed in 1.47 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.624187, val_acc: 36.00% (0.360000), val_f1: 30.90% (0.309003), test_acc: 44.00% (0.440000), test_f1: 40.37% (0.403735)
Epoch 9 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.580456, val_acc: 37.00% (0.370000), val_f1: 30.65% (0.306481), test_acc: 43.00% (0.430000), test_f1: 36.12% (0.361218)
Epoch 10 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.804790, val_acc: 33.00% (0.330000), val_f1: 29.26% (0.292592), test_acc: 41.00% (0.410000), test_f1: 34.59% (0.345931)
Epoch 11 completed in 1.46 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.565741, val_acc: 35.00% (0.350000), val_f1: 33.93% (0.339264), test_acc: 43.00% (0.430000), test_f1: 43.01% (0.430069)
Epoch 12 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.873714, val_acc: 32.00% (0.320000), val_f1: 28.55% (0.285524), test_acc: 42.00% (0.420000), test_f1: 34.63% (0.346294)
Epoch 13 completed in 1.43 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.762518, val_acc: 36.00% (0.360000), val_f1: 34.68% (0.346824), test_acc: 36.00% (0.360000), test_f1: 36.13% (0.361329)
Epoch 14 completed in 1.46 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.565049, val_acc: 34.00% (0.340000), val_f1: 33.79% (0.337938), test_acc: 40.00% (0.400000), test_f1: 35.18% (0.351774)
Epoch 15 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.580878, val_acc: 33.00% (0.330000), val_f1: 33.06% (0.330551), test_acc: 40.00% (0.400000), test_f1: 39.05% (0.390472)
Epoch 16 completed in 1.45 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.786794, val_acc: 37.00% (0.370000), val_f1: 35.44% (0.354444), test_acc: 42.00% (0.420000), test_f1: 39.52% (0.395205)
Epoch 17 completed in 1.44 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
Batch 0 completed in 0.07 seconds (0.00 minutes)
New best val_f1: 0.375224 (previous best: 0.367408)
loss: 0.382703, val_acc: 39.00% (0.390000), val_f1: 37.52% (0.375224), test_acc: 47.00% (0.470000), test_f1: 43.77% (0.437676)
Epoch 18 completed in 1.42 seconds (0.02 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
Batch 0 completed in 0.07 seconds (0.00 minutes)
loss: 0.588374, val_acc: 35.00% (0.350000), val_f1: 34.77% (0.347661), test_acc: 39.00% (0.390000), test_f1: 38.85% (0.388467)
Epoch 19 completed in 1.43 seconds (0.02 minutes)
RESULT: Max Val F1: 0.375224, Max Test F1: 0.437676
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/DMLAN/2025-01-21/sub-1/003_Jan-21-2025_01:30_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/DMLAN/2025-01-21/sub-1/003_Jan-21-2025_01:30_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/DMLAN/2025-01-21/sub-1/003_Jan-21-2025_01:30_PM/trainval_loss_curves.png
Total Completion Time: 1.39 minutes. (0.02 hours) 
