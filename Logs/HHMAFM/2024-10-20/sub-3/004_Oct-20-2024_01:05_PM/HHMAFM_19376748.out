> NEW_LOG_DIR: 
Current directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-3/004_Oct-20-2024_01:05_PM
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-3/004_Oct-20-2024_01:05_PM
/home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-3/004_Oct-20-2024_01:05_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fa663781a80>
>>> learning_rate: 0.001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 128
>>> log_step: 20
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_heads: 8
>>> roberta_text_feature_dim: 768
>>> roberta_topic_feature_dim: 50
>>> resnet_feature_dim: 2048
>>> densenet_feature_dim: 1024
>>> common_dim: 512
>>> num_classes: 3
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/train.tsv: 255.53 seconds (4.26 minutes)
The number of problematic samples: 402
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/val.tsv: 84.92 seconds (1.42 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/test.tsv: 83.39 seconds (1.39 minutes)
The number of problematic samples: 142
Total Training Samples: 19600
Number of Training Samples: 11760
Number of Development Samples: 3920
Number of Test Samples: 3920
Number of unique sentiment classes: 3
building model
Using 2 GPUs
n_trainable_params: 11225091, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 3.66 seconds (0.06 minutes)
max_dev_f1: 0, max_test_f1: 0
loss: 0.965883, dev_acc: 52.91% (0.529082), dev_f1: 23.07% (0.230675), test_acc: 53.78% (0.537755), test_f1: 23.31% (0.233134)
Batch 20 completed in 1.23 seconds (0.02 minutes)
max_dev_f1: 0.23067511956400844, max_test_f1: 0.23313426233134263
loss: 5.757807, dev_acc: 43.70% (0.436990), dev_f1: 28.85% (0.288460), test_acc: 41.05% (0.410459), test_f1: 27.53% (0.275335)
Batch 40 completed in 1.23 seconds (0.02 minutes)
loss: 2.769679, dev_acc: 35.33% (0.353316), dev_f1: 24.92% (0.249218), test_acc: 34.21% (0.342092), test_f1: 26.06% (0.260562)
Batch 60 completed in 1.23 seconds (0.02 minutes)
loss: 9.862617, dev_acc: 35.71% (0.357143), dev_f1: 28.00% (0.280005), test_acc: 35.38% (0.353827), test_f1: 26.74% (0.267365)
Batch 80 completed in 1.23 seconds (0.02 minutes)
max_dev_f1: 0.28845985081175957, max_test_f1: 0.27533513335924625
loss: 3.479362, dev_acc: 44.72% (0.447194), dev_f1: 30.64% (0.306446), test_acc: 45.69% (0.456888), test_f1: 31.30% (0.312984)
Epoch 0 completed in 354.14 seconds (5.90 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.24 seconds (0.02 minutes)
loss: 2.237426, dev_acc: 22.50% (0.225000), dev_f1: 21.81% (0.218091), test_acc: 24.34% (0.243367), test_f1: 24.03% (0.240286)
Batch 20 completed in 1.23 seconds (0.02 minutes)
loss: 1.974571, dev_acc: 46.91% (0.469133), dev_f1: 29.08% (0.290805), test_acc: 46.73% (0.467347), test_f1: 30.55% (0.305506)
Batch 40 completed in 1.56 seconds (0.03 minutes)
max_dev_f1: 0.3064455833867947, max_test_f1: 0.31298406940635953
loss: 3.288601, dev_acc: 48.55% (0.485459), dev_f1: 30.82% (0.308232), test_acc: 49.01% (0.490051), test_f1: 32.02% (0.320172)
Batch 60 completed in 1.23 seconds (0.02 minutes)
loss: 5.556557, dev_acc: 40.13% (0.401276), dev_f1: 20.28% (0.202766), test_acc: 39.06% (0.390561), test_f1: 20.34% (0.203366)
Batch 80 completed in 1.28 seconds (0.02 minutes)
loss: 5.577919, dev_acc: 41.02% (0.410204), dev_f1: 22.61% (0.226103), test_acc: 39.62% (0.396173), test_f1: 21.45% (0.214541)
Epoch 1 completed in 355.55 seconds (5.93 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.23 seconds (0.02 minutes)
max_dev_f1: 0.3082318953277215, max_test_f1: 0.3201720376065513
loss: 12.701484, dev_acc: 50.59% (0.505867), dev_f1: 31.37% (0.313684), test_acc: 50.56% (0.505612), test_f1: 31.05% (0.310501)
Batch 20 completed in 1.23 seconds (0.02 minutes)
loss: 7.117821, dev_acc: 49.72% (0.497194), dev_f1: 29.48% (0.294813), test_acc: 50.46% (0.504592), test_f1: 29.03% (0.290273)
Batch 40 completed in 1.23 seconds (0.02 minutes)
loss: 7.483806, dev_acc: 52.91% (0.529082), dev_f1: 23.07% (0.230675), test_acc: 53.52% (0.535204), test_f1: 24.16% (0.241627)
Batch 60 completed in 1.23 seconds (0.02 minutes)
loss: 3.323912, dev_acc: 41.30% (0.413010), dev_f1: 24.75% (0.247495), test_acc: 42.78% (0.427806), test_f1: 28.30% (0.282968)
Batch 80 completed in 1.23 seconds (0.02 minutes)
loss: 3.142597, dev_acc: 48.21% (0.482143), dev_f1: 30.58% (0.305760), test_acc: 50.94% (0.509439), test_f1: 30.38% (0.303825)
Epoch 2 completed in 357.48 seconds (5.96 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.23 seconds (0.02 minutes)
max_dev_f1: 0.3136838700293068, max_test_f1: 0.31050068532700803
loss: 1.888803, dev_acc: 46.99% (0.469898), dev_f1: 32.38% (0.323800), test_acc: 46.07% (0.460714), test_f1: 31.31% (0.313093)
Batch 20 completed in 1.23 seconds (0.02 minutes)
loss: 2.590301, dev_acc: 48.19% (0.481888), dev_f1: 31.63% (0.316311), test_acc: 51.30% (0.513010), test_f1: 29.09% (0.290925)
