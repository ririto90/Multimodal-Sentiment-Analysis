Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-4/010_Oct-20-2024_08:43_PM
/home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-4/010_Oct-20-2024_08:43_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mmfusion
>>> dataset: mvsa-mts
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fcf3ff3da80>
>>> learning_rate: 0.001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 20
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> roberta_text_feature_dim: 768
>>> roberta_topic_feature_dim: 50
>>> resnet_feature_dim: 2048
>>> densenet_feature_dim: 1024
>>> common_dim: 512
>>> num_classes: 3
>>> model_class: <class 'models.mmfusion.MMFUSION'>
Preparing mvsa-mts dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/train.tsv: 254.39 seconds (4.24 minutes)
The number of problematic samples: 402
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/val.tsv: 84.39 seconds (1.41 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/test.tsv: 85.39 seconds (1.42 minutes)
The number of problematic samples: 142
Total Training Samples: 19600
Number of Training Samples: 11760
Number of Development Samples: 3920
Number of Test Samples: 3920
Number of unique sentiment classes: 3
building model
n_trainable_params: 26988547, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.47 seconds (0.02 minutes)
max_dev_f1: 0, max_test_f1: 0
loss: 1.118440, dev_acc: 52.91% (0.529082), dev_f1: 23.07% (0.230675), test_acc: 53.78% (0.537755), test_f1: 23.31% (0.233134)
Batch 20 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.23067511956400844, max_test_f1: 0.23313426233134263
loss: 1.638371, dev_acc: 48.83% (0.488265), dev_f1: 28.73% (0.287340), test_acc: 49.72% (0.497194), test_f1: 29.06% (0.290599)
Batch 40 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.2873401784471088, max_test_f1: 0.29059887725318007
loss: 1.083286, dev_acc: 52.91% (0.529082), dev_f1: 29.90% (0.298981), test_acc: 52.68% (0.526786), test_f1: 29.45% (0.294466)
Batch 60 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.2989813673901935, max_test_f1: 0.29446640076788283
loss: 0.989409, dev_acc: 52.42% (0.524235), dev_f1: 31.71% (0.317124), test_acc: 53.16% (0.531633), test_f1: 32.14% (0.321370)
Batch 80 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.31712406389589315, max_test_f1: 0.3213700592027166
loss: 0.892169, dev_acc: 53.67% (0.536735), dev_f1: 32.34% (0.323403), test_acc: 54.13% (0.541327), test_f1: 31.95% (0.319507)
Batch 100 completed in 0.57 seconds (0.01 minutes)
loss: 0.787045, dev_acc: 53.70% (0.536990), dev_f1: 31.74% (0.317435), test_acc: 54.80% (0.547959), test_f1: 32.20% (0.321999)
Batch 120 completed in 0.57 seconds (0.01 minutes)
loss: 0.934952, dev_acc: 53.42% (0.534184), dev_f1: 32.17% (0.321733), test_acc: 54.29% (0.542857), test_f1: 32.97% (0.329676)
Batch 140 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.32340330991944194, max_test_f1: 0.31950701813587457
loss: 0.914849, dev_acc: 56.66% (0.566582), dev_f1: 34.90% (0.348956), test_acc: 57.12% (0.571173), test_f1: 35.18% (0.351793)
Batch 160 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.3489560933061672, max_test_f1: 0.3517931663475479
loss: 0.861514, dev_acc: 57.53% (0.575255), dev_f1: 35.62% (0.356183), test_acc: 58.49% (0.584949), test_f1: 36.47% (0.364735)
Batch 180 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.35618307009493755, max_test_f1: 0.3647348030806543
loss: 0.790009, dev_acc: 57.83% (0.578316), dev_f1: 39.53% (0.395293), test_acc: 58.98% (0.589796), test_f1: 41.18% (0.411790)
Epoch 0 completed in 368.85 seconds (6.15 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.837703, dev_acc: 57.83% (0.578316), dev_f1: 38.73% (0.387344), test_acc: 58.98% (0.589796), test_f1: 40.14% (0.401401)
Batch 20 completed in 0.57 seconds (0.01 minutes)
loss: 0.766618, dev_acc: 58.19% (0.581888), dev_f1: 38.66% (0.386626), test_acc: 58.57% (0.585714), test_f1: 38.71% (0.387129)
Batch 40 completed in 0.57 seconds (0.01 minutes)
loss: 0.777311, dev_acc: 58.65% (0.586480), dev_f1: 37.93% (0.379344), test_acc: 59.59% (0.595918), test_f1: 39.99% (0.399890)
Batch 60 completed in 0.57 seconds (0.01 minutes)
loss: 0.694407, dev_acc: 56.79% (0.567857), dev_f1: 34.09% (0.340938), test_acc: 58.65% (0.586480), test_f1: 36.22% (0.362159)
Batch 80 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.39529273472299264, max_test_f1: 0.41178981241215107
loss: 0.768886, dev_acc: 58.95% (0.589541), dev_f1: 41.01% (0.410131), test_acc: 59.72% (0.597194), test_f1: 42.07% (0.420698)
Batch 100 completed in 0.58 seconds (0.01 minutes)
loss: 0.869436, dev_acc: 55.89% (0.558929), dev_f1: 31.69% (0.316934), test_acc: 57.14% (0.571429), test_f1: 32.29% (0.322878)
Batch 120 completed in 0.58 seconds (0.01 minutes)
loss: 0.744512, dev_acc: 58.16% (0.581633), dev_f1: 38.56% (0.385642), test_acc: 59.46% (0.594643), test_f1: 39.36% (0.393587)
Batch 140 completed in 0.58 seconds (0.01 minutes)
loss: 0.887983, dev_acc: 59.08% (0.590816), dev_f1: 39.69% (0.396905), test_acc: 59.46% (0.594643), test_f1: 40.42% (0.404246)
Batch 160 completed in 0.58 seconds (0.01 minutes)
loss: 0.846019, dev_acc: 55.99% (0.559949), dev_f1: 39.39% (0.393930), test_acc: 56.33% (0.563265), test_f1: 39.24% (0.392378)
Batch 180 completed in 0.58 seconds (0.01 minutes)
max_dev_f1: 0.4101307483653523, max_test_f1: 0.42069790589241357
loss: 0.786557, dev_acc: 58.67% (0.586735), dev_f1: 41.24% (0.412385), test_acc: 59.23% (0.592347), test_f1: 43.41% (0.434051)
Epoch 1 completed in 372.08 seconds (6.20 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.58 seconds (0.01 minutes)
max_dev_f1: 0.4123853263717892, max_test_f1: 0.4340514418563057
loss: 0.814986, dev_acc: 58.70% (0.586990), dev_f1: 41.58% (0.415801), test_acc: 59.36% (0.593622), test_f1: 43.62% (0.436175)
Batch 20 completed in 0.58 seconds (0.01 minutes)
max_dev_f1: 0.4158009481708583, max_test_f1: 0.43617500519364966
loss: 0.662009, dev_acc: 58.06% (0.580612), dev_f1: 42.17% (0.421689), test_acc: 58.72% (0.587245), test_f1: 42.82% (0.428224)
Batch 40 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.4216893189341362, max_test_f1: 0.42822358152648166
loss: 0.664952, dev_acc: 56.58% (0.565816), dev_f1: 44.39% (0.443874), test_acc: 57.32% (0.573214), test_f1: 44.90% (0.448991)
Batch 60 completed in 0.57 seconds (0.01 minutes)
loss: 0.662874, dev_acc: 54.97% (0.549745), dev_f1: 30.05% (0.300485), test_acc: 57.02% (0.570153), test_f1: 32.88% (0.328827)
Batch 80 completed in 0.57 seconds (0.01 minutes)
loss: 0.702858, dev_acc: 54.18% (0.541837), dev_f1: 38.45% (0.384515), test_acc: 54.39% (0.543878), test_f1: 39.31% (0.393055)
Batch 100 completed in 0.57 seconds (0.01 minutes)
loss: 0.784889, dev_acc: 58.49% (0.584949), dev_f1: 43.99% (0.439901), test_acc: 59.59% (0.595918), test_f1: 46.32% (0.463184)
Batch 120 completed in 0.57 seconds (0.01 minutes)
loss: 0.873746, dev_acc: 58.75% (0.587500), dev_f1: 40.98% (0.409796), test_acc: 61.45% (0.614541), test_f1: 46.12% (0.461168)
Batch 140 completed in 0.57 seconds (0.01 minutes)
loss: 0.720016, dev_acc: 58.39% (0.583929), dev_f1: 41.18% (0.411795), test_acc: 59.44% (0.594388), test_f1: 42.78% (0.427823)
Batch 160 completed in 0.57 seconds (0.01 minutes)
loss: 0.852842, dev_acc: 59.57% (0.595663), dev_f1: 42.89% (0.428902), test_acc: 59.49% (0.594898), test_f1: 43.64% (0.436370)
Batch 180 completed in 0.57 seconds (0.01 minutes)
loss: 0.715248, dev_acc: 58.16% (0.581633), dev_f1: 39.27% (0.392709), test_acc: 59.74% (0.597449), test_f1: 41.60% (0.416011)
Epoch 2 completed in 373.09 seconds (6.22 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.806255, dev_acc: 55.82% (0.558163), dev_f1: 43.83% (0.438258), test_acc: 55.61% (0.556122), test_f1: 45.90% (0.458967)
Batch 20 completed in 0.57 seconds (0.01 minutes)
loss: 0.749042, dev_acc: 57.60% (0.576020), dev_f1: 38.36% (0.383573), test_acc: 59.31% (0.593112), test_f1: 40.64% (0.406397)
Batch 40 completed in 0.57 seconds (0.01 minutes)
loss: 0.767609, dev_acc: 57.42% (0.574235), dev_f1: 39.25% (0.392456), test_acc: 58.95% (0.589541), test_f1: 41.35% (0.413525)
Batch 60 completed in 0.57 seconds (0.01 minutes)
loss: 0.667915, dev_acc: 58.55% (0.585459), dev_f1: 38.56% (0.385587), test_acc: 59.23% (0.592347), test_f1: 38.87% (0.388731)
Batch 80 completed in 0.57 seconds (0.01 minutes)
loss: 0.607449, dev_acc: 58.75% (0.587500), dev_f1: 41.36% (0.413611), test_acc: 60.23% (0.602296), test_f1: 42.47% (0.424666)
Batch 100 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.443873838681736, max_test_f1: 0.44899110996120295
loss: 0.844309, dev_acc: 57.76% (0.577551), dev_f1: 46.43% (0.464319), test_acc: 57.65% (0.576531), test_f1: 46.39% (0.463911)
Batch 120 completed in 0.57 seconds (0.01 minutes)
loss: 0.686394, dev_acc: 58.80% (0.588010), dev_f1: 43.31% (0.433059), test_acc: 60.23% (0.602296), test_f1: 45.71% (0.457072)
Batch 140 completed in 0.57 seconds (0.01 minutes)
loss: 0.569691, dev_acc: 60.05% (0.600510), dev_f1: 42.19% (0.421876), test_acc: 61.07% (0.610714), test_f1: 44.58% (0.445805)
Batch 160 completed in 0.57 seconds (0.01 minutes)
loss: 0.765149, dev_acc: 59.41% (0.594133), dev_f1: 43.97% (0.439742), test_acc: 61.05% (0.610459), test_f1: 47.74% (0.477449)
Batch 180 completed in 0.57 seconds (0.01 minutes)
loss: 0.746768, dev_acc: 58.95% (0.589541), dev_f1: 43.01% (0.430141), test_acc: 59.80% (0.597959), test_f1: 45.13% (0.451276)
Epoch 3 completed in 372.24 seconds (6.20 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.670033, dev_acc: 59.01% (0.590051), dev_f1: 43.09% (0.430852), test_acc: 59.80% (0.597959), test_f1: 45.79% (0.457864)
Batch 20 completed in 0.57 seconds (0.01 minutes)
loss: 0.666748, dev_acc: 57.86% (0.578571), dev_f1: 42.76% (0.427578), test_acc: 59.11% (0.591071), test_f1: 44.90% (0.448987)
Batch 40 completed in 0.57 seconds (0.01 minutes)
loss: 0.639096, dev_acc: 57.12% (0.571173), dev_f1: 43.34% (0.433396), test_acc: 58.75% (0.587500), test_f1: 45.48% (0.454769)
Batch 60 completed in 0.57 seconds (0.01 minutes)
loss: 0.745719, dev_acc: 56.76% (0.567602), dev_f1: 43.70% (0.436991), test_acc: 58.95% (0.589541), test_f1: 45.49% (0.454912)
Batch 80 completed in 0.57 seconds (0.01 minutes)
loss: 0.740145, dev_acc: 58.98% (0.589796), dev_f1: 41.55% (0.415517), test_acc: 60.43% (0.604337), test_f1: 43.21% (0.432141)
Batch 100 completed in 0.57 seconds (0.01 minutes)
loss: 0.820515, dev_acc: 57.91% (0.579082), dev_f1: 41.32% (0.413233), test_acc: 58.98% (0.589796), test_f1: 44.35% (0.443461)
Batch 120 completed in 0.57 seconds (0.01 minutes)
loss: 0.676153, dev_acc: 57.81% (0.578061), dev_f1: 42.45% (0.424464), test_acc: 58.60% (0.585969), test_f1: 46.30% (0.463048)
Batch 140 completed in 0.57 seconds (0.01 minutes)
loss: 0.820307, dev_acc: 58.49% (0.584949), dev_f1: 44.51% (0.445072), test_acc: 59.64% (0.596429), test_f1: 46.97% (0.469738)
Batch 160 completed in 0.57 seconds (0.01 minutes)
loss: 0.764304, dev_acc: 58.75% (0.587500), dev_f1: 45.89% (0.458919), test_acc: 59.97% (0.599745), test_f1: 49.10% (0.490996)
Batch 180 completed in 0.57 seconds (0.01 minutes)
loss: 0.664084, dev_acc: 59.11% (0.591071), dev_f1: 39.51% (0.395062), test_acc: 60.20% (0.602041), test_f1: 41.09% (0.410871)
Epoch 4 completed in 371.72 seconds (6.20 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.868956, dev_acc: 57.17% (0.571684), dev_f1: 43.22% (0.432155), test_acc: 56.61% (0.566071), test_f1: 43.63% (0.436314)
Batch 20 completed in 0.57 seconds (0.01 minutes)
loss: 0.804049, dev_acc: 58.27% (0.582653), dev_f1: 43.60% (0.435995), test_acc: 59.69% (0.596939), test_f1: 47.08% (0.470804)
Batch 40 completed in 0.57 seconds (0.01 minutes)
loss: 0.740038, dev_acc: 54.59% (0.545918), dev_f1: 43.05% (0.430545), test_acc: 54.31% (0.543112), test_f1: 43.25% (0.432460)
Batch 60 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.4643189796561644, max_test_f1: 0.4639109695561219
loss: 0.801925, dev_acc: 56.38% (0.563776), dev_f1: 47.35% (0.473524), test_acc: 57.24% (0.572449), test_f1: 49.28% (0.492846)
Batch 80 completed in 0.57 seconds (0.01 minutes)
loss: 0.898953, dev_acc: 59.26% (0.592602), dev_f1: 45.68% (0.456751), test_acc: 60.56% (0.605612), test_f1: 48.32% (0.483174)
Batch 100 completed in 0.57 seconds (0.01 minutes)
loss: 0.670256, dev_acc: 57.04% (0.570408), dev_f1: 37.82% (0.378199), test_acc: 57.76% (0.577551), test_f1: 39.67% (0.396706)
Batch 120 completed in 0.57 seconds (0.01 minutes)
loss: 0.671620, dev_acc: 55.05% (0.550510), dev_f1: 43.91% (0.439103), test_acc: 57.50% (0.575000), test_f1: 46.33% (0.463314)
Batch 140 completed in 0.57 seconds (0.01 minutes)
loss: 0.686513, dev_acc: 58.16% (0.581633), dev_f1: 41.98% (0.419797), test_acc: 60.38% (0.603827), test_f1: 43.62% (0.436197)
Batch 160 completed in 0.57 seconds (0.01 minutes)
loss: 0.592355, dev_acc: 57.91% (0.579082), dev_f1: 44.19% (0.441859), test_acc: 59.44% (0.594388), test_f1: 44.29% (0.442938)
Batch 180 completed in 0.57 seconds (0.01 minutes)
loss: 0.767431, dev_acc: 56.96% (0.569643), dev_f1: 45.52% (0.455195), test_acc: 58.65% (0.586480), test_f1: 48.06% (0.480577)
Epoch 5 completed in 372.46 seconds (6.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.793564, dev_acc: 56.94% (0.569388), dev_f1: 40.12% (0.401189), test_acc: 59.85% (0.598469), test_f1: 45.13% (0.451251)
Batch 20 completed in 0.57 seconds (0.01 minutes)
loss: 0.704688, dev_acc: 54.03% (0.540306), dev_f1: 42.43% (0.424272), test_acc: 56.51% (0.565051), test_f1: 44.05% (0.440458)
Batch 40 completed in 0.57 seconds (0.01 minutes)
loss: 0.755690, dev_acc: 54.16% (0.541582), dev_f1: 45.55% (0.455494), test_acc: 56.10% (0.560969), test_f1: 45.49% (0.454928)
Batch 60 completed in 0.57 seconds (0.01 minutes)
loss: 0.700510, dev_acc: 56.61% (0.566071), dev_f1: 45.62% (0.456186), test_acc: 57.70% (0.577041), test_f1: 45.15% (0.451453)
Batch 80 completed in 0.57 seconds (0.01 minutes)
loss: 0.681337, dev_acc: 56.07% (0.560714), dev_f1: 47.10% (0.471011), test_acc: 56.61% (0.566071), test_f1: 46.23% (0.462258)
Batch 100 completed in 0.57 seconds (0.01 minutes)
loss: 0.682438, dev_acc: 56.99% (0.569898), dev_f1: 42.15% (0.421542), test_acc: 59.11% (0.591071), test_f1: 45.94% (0.459372)
Batch 120 completed in 0.57 seconds (0.01 minutes)
loss: 0.601299, dev_acc: 56.61% (0.566071), dev_f1: 42.38% (0.423754), test_acc: 57.02% (0.570153), test_f1: 42.00% (0.420006)
Batch 140 completed in 0.57 seconds (0.01 minutes)
loss: 0.686560, dev_acc: 57.14% (0.571429), dev_f1: 44.16% (0.441584), test_acc: 58.78% (0.587755), test_f1: 45.99% (0.459878)
Batch 160 completed in 0.57 seconds (0.01 minutes)
loss: 0.675817, dev_acc: 57.19% (0.571939), dev_f1: 42.85% (0.428502), test_acc: 58.75% (0.587500), test_f1: 46.17% (0.461703)
Batch 180 completed in 0.57 seconds (0.01 minutes)
loss: 0.663737, dev_acc: 58.01% (0.580102), dev_f1: 42.22% (0.422214), test_acc: 60.41% (0.604082), test_f1: 44.10% (0.440972)
Epoch 6 completed in 371.81 seconds (6.20 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.577984, dev_acc: 56.68% (0.566837), dev_f1: 45.04% (0.450422), test_acc: 59.03% (0.590306), test_f1: 47.25% (0.472537)
Batch 20 completed in 0.57 seconds (0.01 minutes)
loss: 0.472991, dev_acc: 57.07% (0.570663), dev_f1: 43.31% (0.433133), test_acc: 58.04% (0.580357), test_f1: 44.86% (0.448622)
Batch 40 completed in 0.57 seconds (0.01 minutes)
loss: 0.712873, dev_acc: 55.26% (0.552551), dev_f1: 41.32% (0.413202), test_acc: 56.84% (0.568367), test_f1: 42.87% (0.428722)
Batch 60 completed in 0.57 seconds (0.01 minutes)
loss: 0.603546, dev_acc: 56.43% (0.564286), dev_f1: 44.76% (0.447587), test_acc: 57.27% (0.572704), test_f1: 46.37% (0.463718)
