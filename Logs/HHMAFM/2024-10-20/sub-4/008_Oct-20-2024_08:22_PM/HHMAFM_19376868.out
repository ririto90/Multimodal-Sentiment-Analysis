Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-4/008_Oct-20-2024_08:22_PM
/home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-4/008_Oct-20-2024_08:22_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mmfusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f380891da80>
>>> learning_rate: 0.001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 20
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> roberta_text_feature_dim: 768
>>> roberta_topic_feature_dim: 50
>>> resnet_feature_dim: 2048
>>> densenet_feature_dim: 1024
>>> common_dim: 512
>>> num_classes: 3
>>> model_class: <class 'models.mmfusion.MMFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 13.32 seconds (0.22 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 1.56 seconds (0.03 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 1.72 seconds (0.03 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
building model
n_trainable_params: 26988547, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.42 seconds (0.02 minutes)
max_dev_f1: 0, max_test_f1: 0
loss: 1.063204, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 9.50 seconds (0.16 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.19718309859154928, max_test_f1: 0.21621621621621623
loss: 1.011060, dev_acc: 47.00% (0.470000), dev_f1: 27.99% (0.279877), test_acc: 44.00% (0.440000), test_f1: 20.51% (0.205128)
Epoch 1 completed in 8.02 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.27987720969619984, max_test_f1: 0.20512820512820515
loss: 0.997600, dev_acc: 43.00% (0.430000), dev_f1: 31.66% (0.316584), test_acc: 43.00% (0.430000), test_f1: 25.16% (0.251634)
Epoch 2 completed in 7.95 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.820411, dev_acc: 43.00% (0.430000), dev_f1: 28.08% (0.280808), test_acc: 48.00% (0.480000), test_f1: 26.83% (0.268340)
Epoch 3 completed in 8.05 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.316583522297808, max_test_f1: 0.25163398692810457
loss: 0.691082, dev_acc: 50.00% (0.500000), dev_f1: 45.65% (0.456513), test_acc: 45.00% (0.450000), test_f1: 25.47% (0.254663)
Epoch 4 completed in 8.07 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.556547, dev_acc: 46.00% (0.460000), dev_f1: 42.52% (0.425172), test_acc: 36.00% (0.360000), test_f1: 29.55% (0.295517)
Epoch 5 completed in 7.98 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.414181, dev_acc: 41.00% (0.410000), dev_f1: 36.46% (0.364619), test_acc: 40.00% (0.400000), test_f1: 33.05% (0.330463)
Epoch 6 completed in 8.03 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.4565134099616858, max_test_f1: 0.25466284074605455
loss: 0.341642, dev_acc: 56.00% (0.560000), dev_f1: 51.68% (0.516751), test_acc: 44.00% (0.440000), test_f1: 32.14% (0.321358)
Epoch 7 completed in 8.08 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.5167508558069633, max_test_f1: 0.3213575495590868
loss: 0.244965, dev_acc: 53.00% (0.530000), dev_f1: 52.17% (0.521739), test_acc: 41.00% (0.410000), test_f1: 37.21% (0.372118)
Epoch 8 completed in 8.09 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.164173, dev_acc: 50.00% (0.500000), dev_f1: 48.19% (0.481888), test_acc: 43.00% (0.430000), test_f1: 37.01% (0.370137)
Epoch 9 completed in 8.01 seconds (0.13 minutes)
Max dev F1: 52.17% (0.521739), Max test F1: 37.21% (0.372118)
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Step: 0, Loss: 1.0632036924362183
Step: 0, Loss: 17.945051193237305
Step: 0, Loss: 49.7321662902832
Step: 0, Loss: 15.439454078674316
Step: 0, Loss: 16.63958740234375
Step: 0, Loss: 4.381288528442383
Step: 0, Loss: 8.577237129211426
Step: 0, Loss: 3.377566337585449
Step: 0, Loss: 2.742433547973633
Step: 0, Loss: 4.306613445281982
Step: 0, Loss: 4.6909708976745605
Step: 0, Loss: 3.953956127166748
Step: 0, Loss: 2.52536678314209
Step: 1, Loss: 1.0110596418380737
Step: 1, Loss: 0.9272414445877075
Step: 1, Loss: 1.4089642763137817
Step: 1, Loss: 1.8008095026016235
Step: 1, Loss: 1.6821091175079346
Step: 1, Loss: 1.1063168048858643
Step: 1, Loss: 1.260469675064087
Step: 1, Loss: 1.1169233322143555
Step: 1, Loss: 0.9163680672645569
Step: 1, Loss: 1.1304830312728882
Step: 1, Loss: 1.1007368564605713
Step: 1, Loss: 1.12031090259552
Step: 1, Loss: 0.9724251627922058
Step: 2, Loss: 0.9976000189781189
Step: 2, Loss: 0.8469754457473755
Step: 2, Loss: 1.1083698272705078
Step: 2, Loss: 0.9710597991943359
Step: 2, Loss: 1.2024803161621094
Step: 2, Loss: 1.1003670692443848
Step: 2, Loss: 0.9152886867523193
Step: 2, Loss: 0.927372395992279
Step: 2, Loss: 0.927108883857727
Step: 2, Loss: 0.9934238195419312
Step: 2, Loss: 0.8163949251174927
Step: 2, Loss: 0.9531524181365967
Step: 2, Loss: 1.0387485027313232
Step: 3, Loss: 0.8204109072685242
Step: 3, Loss: 0.9485841393470764
Step: 3, Loss: 0.8900719285011292
Step: 3, Loss: 0.761425793170929
Step: 3, Loss: 0.7446591258049011
Step: 3, Loss: 0.7297384738922119
Step: 3, Loss: 0.6651373505592346
Step: 3, Loss: 0.89995276927948
Step: 3, Loss: 0.8739688992500305
Step: 3, Loss: 0.7781884670257568
Step: 3, Loss: 0.8086743950843811
Step: 3, Loss: 0.8031551241874695
Step: 3, Loss: 0.9651783108711243
Step: 4, Loss: 0.6910817623138428
Step: 4, Loss: 0.6782007813453674
Step: 4, Loss: 0.6859197020530701
Step: 4, Loss: 0.7728711366653442
Step: 4, Loss: 0.7072002291679382
Step: 4, Loss: 0.668332040309906
Step: 4, Loss: 0.8362545967102051
Step: 4, Loss: 0.8254051208496094
Step: 4, Loss: 0.6564300060272217
Step: 4, Loss: 0.6994491219520569
Step: 4, Loss: 0.74708491563797
Step: 4, Loss: 0.7204261422157288
Step: 4, Loss: 0.8167267441749573
Step: 5, Loss: 0.5565469861030579
Step: 5, Loss: 0.6408270597457886
Step: 5, Loss: 0.6583245992660522
Step: 5, Loss: 0.6056133508682251
Step: 5, Loss: 0.6533640027046204
Step: 5, Loss: 0.6305130124092102
Step: 5, Loss: 0.5588912963867188
Step: 5, Loss: 0.6552159190177917
Step: 5, Loss: 0.44798436760902405
Step: 5, Loss: 0.48408421874046326
Step: 5, Loss: 0.6221896409988403
Step: 5, Loss: 0.6365830302238464
Step: 5, Loss: 0.3888606131076813
Step: 6, Loss: 0.41418129205703735
Step: 6, Loss: 0.3970390260219574
Step: 6, Loss: 0.43772852420806885
Step: 6, Loss: 0.3833032250404358
Step: 6, Loss: 0.41728466749191284
Step: 6, Loss: 0.5180372595787048
Step: 6, Loss: 0.5025800466537476
Step: 6, Loss: 0.44649258255958557
Step: 6, Loss: 0.4275237023830414
Step: 6, Loss: 0.4554039239883423
Step: 6, Loss: 0.3963783085346222
Step: 6, Loss: 0.499599426984787
Step: 6, Loss: 0.4858849048614502
Step: 7, Loss: 0.34164246916770935
Step: 7, Loss: 0.23382827639579773
Step: 7, Loss: 0.27302542328834534
Step: 7, Loss: 0.26252689957618713
Step: 7, Loss: 0.3283659517765045
Step: 7, Loss: 0.34952273964881897
Step: 7, Loss: 0.34973302483558655
Step: 7, Loss: 0.2490331530570984
Step: 7, Loss: 0.4092262387275696
Step: 7, Loss: 0.40307557582855225
Step: 7, Loss: 0.3794507682323456
Step: 7, Loss: 0.3494539260864258
Step: 7, Loss: 0.5227321982383728
Step: 8, Loss: 0.2449651062488556
Step: 8, Loss: 0.2157294601202011
Step: 8, Loss: 0.22783447802066803
Step: 8, Loss: 0.20908454060554504
Step: 8, Loss: 0.22654546797275543
Step: 8, Loss: 0.22686295211315155
Step: 8, Loss: 0.3120139241218567
Step: 8, Loss: 0.31070899963378906
Step: 8, Loss: 0.14759156107902527
Step: 8, Loss: 0.22230088710784912
Step: 8, Loss: 0.31845608353614807
Step: 8, Loss: 0.2650061845779419
Step: 8, Loss: 0.6541271805763245
Step: 9, Loss: 0.16417296230793
Step: 9, Loss: 0.15849323570728302
Step: 9, Loss: 0.24262991547584534
Step: 9, Loss: 0.24921463429927826
Step: 9, Loss: 0.5948607325553894
Step: 9, Loss: 0.1390170454978943
Step: 9, Loss: 0.52129727602005
Step: 9, Loss: 0.4357697367668152
Step: 9, Loss: 0.28462424874305725
Step: 9, Loss: 0.25244852900505066
Step: 9, Loss: 0.4847084581851959
Step: 9, Loss: 0.4454977214336395
Step: 9, Loss: 0.9229871034622192
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-4/008_Oct-20-2024_08:22_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-20/sub-4/008_Oct-20-2024_08:22_PM/trainval_loss_curves.png
Total Completion Time: 1.96 minutes. (0.03 hours) 
