SLURM Job ID: 19387047
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/001_Oct-22-2024_08:52_AM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fde0ede5580>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> common_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/001_Oct-22-2024_08:52_AM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/train.tsv: 253.29 seconds (4.22 minutes)
The number of problematic samples: 402
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/val.tsv: 83.57 seconds (1.39 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/test.tsv: 84.22 seconds (1.40 minutes)
The number of problematic samples: 142
Total Training Samples: 19600
Number of Training Samples: 11760
Number of Development Samples: 3920
Number of Test Samples: 3920
Number of unique sentiment classes: 3
Building model
Using 2 GPUs
n_trainable_params: 305641475, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 4.13 seconds (0.07 minutes)
New best dev_f1: 0.322351 (previous best: 0.000000)
loss: 1.098511, dev_acc: 52.63% (0.526276), dev_f1: 32.24% (0.322351), test_acc: 53.57% (0.535714), test_f1: 33.11% (0.331146)
Batch 60 completed in 1.23 seconds (0.02 minutes)
loss: 0.927459, dev_acc: 53.78% (0.537755), dev_f1: 26.46% (0.264564), test_acc: 54.44% (0.544388), test_f1: 26.56% (0.265587)
Batch 120 completed in 1.22 seconds (0.02 minutes)
New best dev_f1: 0.358661 (previous best: 0.322351)
loss: 0.801507, dev_acc: 51.58% (0.515816), dev_f1: 35.87% (0.358661), test_acc: 52.53% (0.525255), test_f1: 36.57% (0.365734)
Batch 180 completed in 1.22 seconds (0.02 minutes)
loss: 0.834306, dev_acc: 55.13% (0.551276), dev_f1: 33.32% (0.333184), test_acc: 55.10% (0.551020), test_f1: 32.77% (0.327750)
Epoch 0 completed in 610.15 seconds (10.17 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.22 seconds (0.02 minutes)
New best dev_f1: 0.365659 (previous best: 0.358661)
loss: 0.844862, dev_acc: 53.34% (0.533418), dev_f1: 36.57% (0.365659), test_acc: 53.72% (0.537245), test_f1: 36.88% (0.368782)
Batch 60 completed in 1.23 seconds (0.02 minutes)
New best dev_f1: 0.384269 (previous best: 0.365659)
loss: 0.829430, dev_acc: 55.13% (0.551276), dev_f1: 38.43% (0.384269), test_acc: 55.97% (0.559694), test_f1: 39.93% (0.399315)
Batch 120 completed in 1.23 seconds (0.02 minutes)
New best dev_f1: 0.389875 (previous best: 0.384269)
loss: 0.805946, dev_acc: 57.55% (0.575510), dev_f1: 38.99% (0.389875), test_acc: 58.19% (0.581888), test_f1: 39.60% (0.396024)
Batch 180 completed in 1.23 seconds (0.02 minutes)
loss: 1.146925, dev_acc: 57.02% (0.570153), dev_f1: 37.42% (0.374233), test_acc: 57.73% (0.577296), test_f1: 39.16% (0.391570)
Epoch 1 completed in 619.62 seconds (10.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.20 seconds (0.02 minutes)
loss: 0.851840, dev_acc: 56.05% (0.560459), dev_f1: 38.96% (0.389620), test_acc: 56.40% (0.564031), test_f1: 40.08% (0.400802)
Batch 60 completed in 1.23 seconds (0.02 minutes)
New best dev_f1: 0.467525 (previous best: 0.389875)
loss: 0.745410, dev_acc: 55.84% (0.558418), dev_f1: 46.75% (0.467525), test_acc: 56.40% (0.564031), test_f1: 48.21% (0.482082)
Batch 120 completed in 1.24 seconds (0.02 minutes)
loss: 0.724282, dev_acc: 56.45% (0.564541), dev_f1: 40.99% (0.409853), test_acc: 56.81% (0.568112), test_f1: 43.00% (0.430033)
Batch 180 completed in 1.23 seconds (0.02 minutes)
New best dev_f1: 0.476754 (previous best: 0.467525)
loss: 0.928841, dev_acc: 57.09% (0.570918), dev_f1: 47.68% (0.476754), test_acc: 58.06% (0.580612), test_f1: 48.08% (0.480812)
Epoch 2 completed in 619.59 seconds (10.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.23 seconds (0.02 minutes)
loss: 0.820310, dev_acc: 56.66% (0.566582), dev_f1: 36.02% (0.360208), test_acc: 59.08% (0.590816), test_f1: 41.28% (0.412791)
Batch 60 completed in 1.22 seconds (0.02 minutes)
loss: 0.698029, dev_acc: 55.99% (0.559949), dev_f1: 41.74% (0.417392), test_acc: 57.81% (0.578061), test_f1: 45.07% (0.450663)
Batch 120 completed in 1.23 seconds (0.02 minutes)
loss: 0.748509, dev_acc: 57.91% (0.579082), dev_f1: 43.84% (0.438428), test_acc: 58.85% (0.588520), test_f1: 45.89% (0.458910)
Batch 180 completed in 1.23 seconds (0.02 minutes)
loss: 0.721423, dev_acc: 59.08% (0.590816), dev_f1: 45.65% (0.456486), test_acc: 60.94% (0.609439), test_f1: 48.66% (0.486614)
Epoch 3 completed in 618.26 seconds (10.30 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 1.21 seconds (0.02 minutes)
loss: 0.801398, dev_acc: 59.11% (0.591071), dev_f1: 44.98% (0.449819), test_acc: 59.87% (0.598724), test_f1: 46.99% (0.469948)
Batch 60 completed in 1.22 seconds (0.02 minutes)
loss: 0.649045, dev_acc: 56.28% (0.562755), dev_f1: 40.55% (0.405471), test_acc: 58.06% (0.580612), test_f1: 42.23% (0.422331)
Batch 120 completed in 1.22 seconds (0.02 minutes)
loss: 0.738610, dev_acc: 55.64% (0.556378), dev_f1: 46.22% (0.462235), test_acc: 56.58% (0.565816), test_f1: 48.04% (0.480445)
Batch 180 completed in 1.22 seconds (0.02 minutes)
loss: 0.671821, dev_acc: 56.58% (0.565816), dev_f1: 39.67% (0.396748), test_acc: 58.32% (0.583163), test_f1: 41.33% (0.413330)
Epoch 4 completed in 617.33 seconds (10.29 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 1.22 seconds (0.02 minutes)
loss: 0.749450, dev_acc: 56.58% (0.565816), dev_f1: 45.36% (0.453630), test_acc: 58.93% (0.589286), test_f1: 47.41% (0.474124)
Batch 60 completed in 1.23 seconds (0.02 minutes)
loss: 0.580279, dev_acc: 56.58% (0.565816), dev_f1: 41.16% (0.411556), test_acc: 58.24% (0.582398), test_f1: 43.93% (0.439321)
Batch 120 completed in 1.22 seconds (0.02 minutes)
loss: 0.790133, dev_acc: 54.74% (0.547449), dev_f1: 43.75% (0.437506), test_acc: 56.68% (0.566837), test_f1: 46.98% (0.469817)
Batch 180 completed in 1.23 seconds (0.02 minutes)
loss: 0.659384, dev_acc: 55.59% (0.555867), dev_f1: 45.81% (0.458067), test_acc: 57.81% (0.578061), test_f1: 47.97% (0.479731)
Epoch 5 completed in 619.80 seconds (10.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 1.22 seconds (0.02 minutes)
loss: 0.557592, dev_acc: 56.66% (0.566582), dev_f1: 42.98% (0.429819), test_acc: 58.78% (0.587755), test_f1: 46.15% (0.461505)
Batch 60 completed in 1.22 seconds (0.02 minutes)
loss: 0.476590, dev_acc: 54.67% (0.546684), dev_f1: 42.99% (0.429900), test_acc: 55.18% (0.551786), test_f1: 43.85% (0.438491)
Batch 120 completed in 1.23 seconds (0.02 minutes)
loss: 0.599066, dev_acc: 55.97% (0.559694), dev_f1: 44.66% (0.446641), test_acc: 58.62% (0.586224), test_f1: 47.58% (0.475837)
Batch 180 completed in 1.23 seconds (0.02 minutes)
loss: 0.666002, dev_acc: 56.28% (0.562755), dev_f1: 45.04% (0.450364), test_acc: 57.68% (0.576786), test_f1: 47.26% (0.472637)
Epoch 6 completed in 618.74 seconds (10.31 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 1.23 seconds (0.02 minutes)
loss: 0.556621, dev_acc: 56.05% (0.560459), dev_f1: 43.05% (0.430531), test_acc: 58.52% (0.585204), test_f1: 46.64% (0.466432)
Batch 60 completed in 1.23 seconds (0.02 minutes)
loss: 0.537821, dev_acc: 53.80% (0.538010), dev_f1: 43.74% (0.437412), test_acc: 54.67% (0.546684), test_f1: 43.90% (0.439003)
Batch 120 completed in 1.22 seconds (0.02 minutes)
loss: 0.476035, dev_acc: 53.90% (0.539031), dev_f1: 44.03% (0.440347), test_acc: 55.89% (0.558929), test_f1: 45.76% (0.457585)
Batch 180 completed in 1.22 seconds (0.02 minutes)
loss: 0.723765, dev_acc: 53.72% (0.537245), dev_f1: 41.95% (0.419479), test_acc: 55.41% (0.554082), test_f1: 43.25% (0.432529)
Epoch 7 completed in 618.86 seconds (10.31 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 1.23 seconds (0.02 minutes)
loss: 0.363496, dev_acc: 53.14% (0.531378), dev_f1: 42.54% (0.425356), test_acc: 55.00% (0.550000), test_f1: 43.88% (0.438767)
Batch 60 completed in 1.22 seconds (0.02 minutes)
loss: 0.489365, dev_acc: 53.55% (0.535459), dev_f1: 44.00% (0.439984), test_acc: 54.08% (0.540816), test_f1: 43.77% (0.437690)
Batch 120 completed in 1.23 seconds (0.02 minutes)
loss: 0.414535, dev_acc: 51.84% (0.518367), dev_f1: 42.81% (0.428092), test_acc: 52.27% (0.522704), test_f1: 44.19% (0.441912)
