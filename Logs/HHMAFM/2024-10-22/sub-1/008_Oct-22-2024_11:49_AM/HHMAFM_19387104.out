SLURM Job ID: 19387104
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/008_Oct-22-2024_11:49_AM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fc7326f9580>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> common_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/008_Oct-22-2024_11:49_AM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 16.87 seconds (0.28 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 2.00 seconds (0.03 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 2.20 seconds (0.04 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
Using 2 GPUs
n_trainable_params: 281867427, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 4.06 seconds (0.07 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.079112, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 22.86 seconds (0.38 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.30 seconds (0.02 minutes)
New best dev_f1: 0.281905 (previous best: 0.197183)
loss: 0.927612, dev_acc: 43.00% (0.430000), dev_f1: 28.19% (0.281905), test_acc: 50.00% (0.500000), test_f1: 33.69% (0.336886)
Epoch 1 completed in 19.74 seconds (0.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.24 seconds (0.02 minutes)
loss: 1.043960, dev_acc: 44.00% (0.440000), dev_f1: 27.33% (0.273303), test_acc: 49.00% (0.490000), test_f1: 27.31% (0.273105)
Epoch 2 completed in 19.79 seconds (0.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.24 seconds (0.02 minutes)
loss: 0.944976, dev_acc: 42.00% (0.420000), dev_f1: 24.77% (0.247664), test_acc: 48.00% (0.480000), test_f1: 29.13% (0.291296)
Epoch 3 completed in 19.53 seconds (0.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 1.25 seconds (0.02 minutes)
New best dev_f1: 0.450267 (previous best: 0.281905)
loss: 0.954389, dev_acc: 49.00% (0.490000), dev_f1: 45.03% (0.450267), test_acc: 46.00% (0.460000), test_f1: 36.96% (0.369555)
Epoch 4 completed in 19.85 seconds (0.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 1.26 seconds (0.02 minutes)
loss: 0.813394, dev_acc: 52.00% (0.520000), dev_f1: 44.04% (0.440393), test_acc: 50.00% (0.500000), test_f1: 36.85% (0.368525)
Epoch 5 completed in 19.66 seconds (0.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 1.29 seconds (0.02 minutes)
loss: 0.789637, dev_acc: 43.00% (0.430000), dev_f1: 35.81% (0.358095), test_acc: 47.00% (0.470000), test_f1: 39.51% (0.395146)
Epoch 6 completed in 19.46 seconds (0.32 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 1.25 seconds (0.02 minutes)
loss: 1.058108, dev_acc: 47.00% (0.470000), dev_f1: 36.89% (0.368898), test_acc: 46.00% (0.460000), test_f1: 32.15% (0.321468)
Epoch 7 completed in 19.82 seconds (0.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 1.30 seconds (0.02 minutes)
loss: 0.740466, dev_acc: 42.00% (0.420000), dev_f1: 37.31% (0.373125), test_acc: 47.00% (0.470000), test_f1: 44.11% (0.441106)
Epoch 8 completed in 19.77 seconds (0.33 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 1.29 seconds (0.02 minutes)
loss: 0.945613, dev_acc: 31.00% (0.310000), dev_f1: 27.43% (0.274276), test_acc: 35.00% (0.350000), test_f1: 28.62% (0.286182)
Epoch 9 completed in 19.65 seconds (0.33 minutes)
RESULT: Max Dev F1: 0.450267, Max Test F1: 0.369555
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Step: 1, Loss: 1.0791122913360596
Step: 2, Loss: 1.0811281204223633
Step: 3, Loss: 1.0642083883285522
Step: 4, Loss: 1.0783880949020386
Step: 5, Loss: 1.0174269676208496
Step: 6, Loss: 0.9684610366821289
Step: 7, Loss: 1.0964915752410889
Step: 8, Loss: 1.0181782245635986
Step: 9, Loss: 1.0504920482635498
Step: 10, Loss: 1.0603588819503784
Step: 11, Loss: 0.9728780388832092
Step: 12, Loss: 0.9908656477928162
Step: 13, Loss: 1.1751166582107544
Step: 14, Loss: 0.9276122450828552
Step: 15, Loss: 0.9698082208633423
Step: 16, Loss: 1.0461978912353516
Step: 17, Loss: 1.1562386751174927
Step: 18, Loss: 0.9533332586288452
Step: 19, Loss: 1.0414267778396606
Step: 20, Loss: 1.0862637758255005
Step: 21, Loss: 0.9926176071166992
Step: 22, Loss: 1.1236590147018433
Step: 23, Loss: 0.9928870797157288
Step: 24, Loss: 0.9389241933822632
Step: 25, Loss: 1.0028501749038696
Step: 26, Loss: 0.6424375772476196
Step: 27, Loss: 1.0439603328704834
Step: 28, Loss: 1.3570606708526611
Step: 29, Loss: 0.9065492749214172
Step: 30, Loss: 0.9147801995277405
Step: 31, Loss: 1.0179508924484253
Step: 32, Loss: 0.9387415647506714
Step: 33, Loss: 1.1408809423446655
Step: 34, Loss: 0.9379866719245911
Step: 35, Loss: 1.036207675933838
Step: 36, Loss: 1.016384243965149
Step: 37, Loss: 1.029758334159851
Step: 38, Loss: 0.9652835726737976
Step: 39, Loss: 0.8741673827171326
Step: 40, Loss: 0.9449762105941772
Step: 41, Loss: 0.8500990867614746
Step: 42, Loss: 1.0908310413360596
Step: 43, Loss: 0.9445480704307556
Step: 44, Loss: 0.8540939092636108
Step: 45, Loss: 0.9474861025810242
Step: 46, Loss: 0.8107749223709106
Step: 47, Loss: 0.8973689675331116
Step: 48, Loss: 1.0370062589645386
Step: 49, Loss: 0.9154529571533203
Step: 50, Loss: 0.905717134475708
Step: 51, Loss: 1.0230507850646973
Step: 52, Loss: 1.0510977506637573
Step: 53, Loss: 0.9543890953063965
Step: 54, Loss: 0.9097280502319336
Step: 55, Loss: 0.8153519630432129
Step: 56, Loss: 0.8754951357841492
Step: 57, Loss: 0.9736462235450745
Step: 58, Loss: 0.8804309964179993
Step: 59, Loss: 0.8104847073554993
Step: 60, Loss: 0.912071943283081
Step: 61, Loss: 0.8755941987037659
Step: 62, Loss: 0.8527762293815613
Step: 63, Loss: 0.856311559677124
Step: 64, Loss: 0.8022431135177612
Step: 65, Loss: 0.9203836917877197
Step: 66, Loss: 0.8133935332298279
Step: 67, Loss: 0.6641149520874023
Step: 68, Loss: 0.9206832051277161
Step: 69, Loss: 0.7863507270812988
Step: 70, Loss: 0.7702516913414001
Step: 71, Loss: 0.931941032409668
Step: 72, Loss: 1.3311936855316162
Step: 73, Loss: 0.8792412281036377
Step: 74, Loss: 0.7332198619842529
Step: 75, Loss: 0.842146098613739
Step: 76, Loss: 1.1864261627197266
Step: 77, Loss: 1.0857784748077393
Step: 78, Loss: 0.9286891222000122
Step: 79, Loss: 0.7896366119384766
Step: 80, Loss: 0.8197275400161743
Step: 81, Loss: 0.6902031898498535
Step: 82, Loss: 0.8419268727302551
Step: 83, Loss: 0.9588775038719177
Step: 84, Loss: 0.7382203340530396
Step: 85, Loss: 0.7841899991035461
Step: 86, Loss: 1.0546090602874756
Step: 87, Loss: 0.885995090007782
Step: 88, Loss: 0.942731499671936
Step: 89, Loss: 0.9547490477561951
Step: 90, Loss: 0.9299744367599487
Step: 91, Loss: 0.8254086375236511
Step: 92, Loss: 1.0581084489822388
Step: 93, Loss: 0.8108296394348145
Step: 94, Loss: 0.8245984315872192
Step: 95, Loss: 0.5843145251274109
Step: 96, Loss: 0.7616596221923828
Step: 97, Loss: 0.7379238605499268
Step: 98, Loss: 0.7561126947402954
Step: 99, Loss: 0.8131429553031921
Step: 100, Loss: 0.8725747466087341
Step: 101, Loss: 0.905525803565979
Step: 102, Loss: 0.9473119974136353
Step: 103, Loss: 0.7939552664756775
Step: 104, Loss: 0.7343690991401672
Step: 105, Loss: 0.7404662370681763
Step: 106, Loss: 0.7436584830284119
Step: 107, Loss: 0.6976519823074341
Step: 108, Loss: 0.8350529670715332
Step: 109, Loss: 0.6663137078285217
Step: 110, Loss: 0.701587975025177
Step: 111, Loss: 0.7453134059906006
Step: 112, Loss: 0.9669593572616577
Step: 113, Loss: 0.8183610439300537
Step: 114, Loss: 0.8546855449676514
Step: 115, Loss: 0.631926953792572
Step: 116, Loss: 0.8378326892852783
Step: 117, Loss: 1.1265357732772827
Step: 118, Loss: 0.9456126689910889
Step: 119, Loss: 0.6991125345230103
Step: 120, Loss: 0.6764997243881226
Step: 121, Loss: 0.9056338667869568
Step: 122, Loss: 0.7986899614334106
Step: 123, Loss: 0.7396513819694519
Step: 124, Loss: 0.7445365190505981
Step: 125, Loss: 0.6270468831062317
Step: 126, Loss: 0.794125497341156
Step: 127, Loss: 0.7631195187568665
Step: 128, Loss: 0.7489523887634277
Step: 129, Loss: 0.889573335647583
Step: 130, Loss: 0.6367043852806091
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/008_Oct-22-2024_11:49_AM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/008_Oct-22-2024_11:49_AM/trainval_loss_curves.png
Total Completion Time: 4.05 minutes. (0.07 hours) 
