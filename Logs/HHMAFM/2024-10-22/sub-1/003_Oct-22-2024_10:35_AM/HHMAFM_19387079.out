SLURM Job ID: 19387079
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/003_Oct-22-2024_10:35_AM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f59465d5580>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> common_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/003_Oct-22-2024_10:35_AM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.96 seconds (0.05 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.38 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.37 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 281288611, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.34 seconds (0.02 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.095711, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 9.69 seconds (0.16 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.60 seconds (0.01 minutes)
New best dev_f1: 0.339880 (previous best: 0.197183)
loss: 1.113409, dev_acc: 49.00% (0.490000), dev_f1: 33.99% (0.339880), test_acc: 44.00% (0.440000), test_f1: 31.07% (0.310734)
Epoch 1 completed in 8.42 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.60 seconds (0.01 minutes)
loss: 0.829087, dev_acc: 46.00% (0.460000), dev_f1: 33.59% (0.335855), test_acc: 53.00% (0.530000), test_f1: 35.65% (0.356509)
Epoch 2 completed in 8.34 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.60 seconds (0.01 minutes)
New best dev_f1: 0.516669 (previous best: 0.339880)
loss: 0.662956, dev_acc: 55.00% (0.550000), dev_f1: 51.67% (0.516669), test_acc: 43.00% (0.430000), test_f1: 39.93% (0.399343)
Epoch 3 completed in 8.47 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.60 seconds (0.01 minutes)
loss: 0.609770, dev_acc: 53.00% (0.530000), dev_f1: 49.32% (0.493185), test_acc: 46.00% (0.460000), test_f1: 35.72% (0.357220)
Epoch 4 completed in 8.46 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.60 seconds (0.01 minutes)
loss: 0.609282, dev_acc: 42.00% (0.420000), dev_f1: 41.14% (0.411356), test_acc: 41.00% (0.410000), test_f1: 37.77% (0.377672)
Epoch 5 completed in 8.41 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.60 seconds (0.01 minutes)
loss: 0.853588, dev_acc: 40.00% (0.400000), dev_f1: 33.12% (0.331244), test_acc: 44.00% (0.440000), test_f1: 35.82% (0.358185)
Epoch 6 completed in 8.51 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.60 seconds (0.01 minutes)
loss: 0.436314, dev_acc: 49.00% (0.490000), dev_f1: 46.89% (0.468923), test_acc: 40.00% (0.400000), test_f1: 34.84% (0.348448)
Epoch 7 completed in 8.49 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.60 seconds (0.01 minutes)
loss: 0.595620, dev_acc: 44.00% (0.440000), dev_f1: 41.03% (0.410321), test_acc: 43.00% (0.430000), test_f1: 35.24% (0.352421)
Epoch 8 completed in 8.47 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.397818, dev_acc: 49.00% (0.490000), dev_f1: 42.67% (0.426742), test_acc: 44.00% (0.440000), test_f1: 32.53% (0.325344)
Epoch 9 completed in 8.43 seconds (0.14 minutes)
RESULT: Max Dev F1: 0.516669, Max Test F1: 0.399343
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Step: 1, Loss: 1.0957109928131104
Step: 2, Loss: 1.0853010416030884
Step: 3, Loss: 1.265287160873413
Step: 4, Loss: 1.0271559953689575
Step: 5, Loss: 1.1692564487457275
Step: 6, Loss: 1.0877025127410889
Step: 7, Loss: 1.0995056629180908
Step: 8, Loss: 1.0544010400772095
Step: 9, Loss: 0.9572412371635437
Step: 10, Loss: 0.9533554911613464
Step: 11, Loss: 1.0045021772384644
Step: 12, Loss: 1.1592557430267334
Step: 13, Loss: 0.9005573987960815
Step: 14, Loss: 1.1134092807769775
Step: 15, Loss: 0.9353751540184021
Step: 16, Loss: 0.9759320616722107
Step: 17, Loss: 0.9861778020858765
Step: 18, Loss: 0.9219457507133484
Step: 19, Loss: 0.9968600869178772
Step: 20, Loss: 1.0527701377868652
Step: 21, Loss: 0.8385140299797058
Step: 22, Loss: 0.9236125946044922
Step: 23, Loss: 0.981413722038269
Step: 24, Loss: 1.115810751914978
Step: 25, Loss: 0.9657279849052429
Step: 26, Loss: 0.860724687576294
Step: 27, Loss: 0.8290871977806091
Step: 28, Loss: 0.8528118133544922
Step: 29, Loss: 0.9548067450523376
Step: 30, Loss: 0.884070873260498
Step: 31, Loss: 0.8836289644241333
Step: 32, Loss: 0.8907074332237244
Step: 33, Loss: 0.8638257384300232
Step: 34, Loss: 0.8900234699249268
Step: 35, Loss: 0.7923339605331421
Step: 36, Loss: 0.8059478402137756
Step: 37, Loss: 0.8568114638328552
Step: 38, Loss: 0.9309582114219666
Step: 39, Loss: 0.7838969826698303
Step: 40, Loss: 0.6629561185836792
Step: 41, Loss: 0.7715035676956177
Step: 42, Loss: 0.7729414105415344
Step: 43, Loss: 0.8489928245544434
Step: 44, Loss: 0.911495566368103
Step: 45, Loss: 0.756697416305542
Step: 46, Loss: 0.6298917531967163
Step: 47, Loss: 0.7363829612731934
Step: 48, Loss: 0.8158183097839355
Step: 49, Loss: 0.6130198240280151
Step: 50, Loss: 0.768500566482544
Step: 51, Loss: 0.8125531077384949
Step: 52, Loss: 0.7621163129806519
Step: 53, Loss: 0.609769880771637
Step: 54, Loss: 0.5984466075897217
Step: 55, Loss: 0.588569700717926
Step: 56, Loss: 0.5197669863700867
Step: 57, Loss: 0.4315623641014099
Step: 58, Loss: 0.7189903259277344
Step: 59, Loss: 0.6437152624130249
Step: 60, Loss: 0.6656605005264282
Step: 61, Loss: 0.6463574767112732
Step: 62, Loss: 0.697252094745636
Step: 63, Loss: 0.7695333957672119
Step: 64, Loss: 0.9256237745285034
Step: 65, Loss: 0.6526364684104919
Step: 66, Loss: 0.6092819571495056
Step: 67, Loss: 0.6772077679634094
Step: 68, Loss: 0.44563475251197815
Step: 69, Loss: 0.8290809988975525
Step: 70, Loss: 0.5300376415252686
Step: 71, Loss: 0.8779515027999878
Step: 72, Loss: 0.8179295063018799
Step: 73, Loss: 0.5150943398475647
Step: 74, Loss: 0.806707501411438
Step: 75, Loss: 0.7120609879493713
Step: 76, Loss: 0.3966819643974304
Step: 77, Loss: 0.8148689270019531
Step: 78, Loss: 0.4688282907009125
Step: 79, Loss: 0.8535881638526917
Step: 80, Loss: 0.48893478512763977
Step: 81, Loss: 0.3877900242805481
Step: 82, Loss: 0.47953686118125916
Step: 83, Loss: 0.46973979473114014
Step: 84, Loss: 0.5701743960380554
Step: 85, Loss: 0.47584211826324463
Step: 86, Loss: 0.49029770493507385
Step: 87, Loss: 0.47994622588157654
Step: 88, Loss: 0.5292531847953796
Step: 89, Loss: 0.45745140314102173
Step: 90, Loss: 0.6897507905960083
Step: 91, Loss: 0.5553932785987854
Step: 92, Loss: 0.4363137185573578
Step: 93, Loss: 0.24376718699932098
Step: 94, Loss: 0.41824808716773987
Step: 95, Loss: 0.34734249114990234
Step: 96, Loss: 0.468018501996994
Step: 97, Loss: 0.5698139071464539
Step: 98, Loss: 0.5093065500259399
Step: 99, Loss: 0.3849773108959198
Step: 100, Loss: 0.6575550436973572
Step: 101, Loss: 0.768828809261322
Step: 102, Loss: 0.5230794548988342
Step: 103, Loss: 0.46442705392837524
Step: 104, Loss: 0.2497578263282776
Step: 105, Loss: 0.5956200361251831
Step: 106, Loss: 0.3486715853214264
Step: 107, Loss: 0.25986194610595703
Step: 108, Loss: 0.47927600145339966
Step: 109, Loss: 0.5570048689842224
Step: 110, Loss: 0.343443363904953
Step: 111, Loss: 0.41768956184387207
Step: 112, Loss: 0.26055169105529785
Step: 113, Loss: 0.461406946182251
Step: 114, Loss: 0.29130780696868896
Step: 115, Loss: 0.3656061589717865
Step: 116, Loss: 0.5240501165390015
Step: 117, Loss: 0.2702311873435974
Step: 118, Loss: 0.3978175222873688
Step: 119, Loss: 0.4660053551197052
Step: 120, Loss: 0.2608208954334259
Step: 121, Loss: 0.20223687589168549
Step: 122, Loss: 0.4746246337890625
Step: 123, Loss: 0.31220775842666626
Step: 124, Loss: 0.3474777340888977
Step: 125, Loss: 0.44192254543304443
Step: 126, Loss: 0.30063799023628235
Step: 127, Loss: 0.2732600271701813
Step: 128, Loss: 0.3472491502761841
Step: 129, Loss: 0.24111226201057434
Step: 130, Loss: 0.261433482170105
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/003_Oct-22-2024_10:35_AM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-22/sub-1/003_Oct-22-2024_10:35_AM/trainval_loss_curves.png
Total Completion Time: 1.79 minutes. (0.03 hours) 
