SLURM Job ID: 19404513
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-30/sub-1/005_Oct-30-2024_11:08_PM

Running hyperparameter combination 1/81
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fac6339dd00>
>>> learning_rate: 0.001
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 128
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 512
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/train.tsv: 228.50 seconds (3.81 minutes)
The number of problematic samples: 402
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/val.tsv: 82.16 seconds (1.37 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/test.tsv: 80.03 seconds (1.33 minutes)
The number of problematic samples: 142
Total Training Samples: 19600
Number of Training Samples: 11760
Number of Development Samples: 3920
Number of Test Samples: 3920
Number of unique sentiment classes: 3
Building model
Using 2 GPUs
n_trainable_params: 37478531, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 4.25 seconds (0.07 minutes)
New best dev_f1: 0.190996 (previous best: 0.000000)
loss: 1.386680, dev_acc: 40.15% (0.401531), dev_f1: 19.10% (0.190996), test_acc: 38.78% (0.387755), test_f1: 18.63% (0.186275)
Batch 60 completed in 1.22 seconds (0.02 minutes)
New best dev_f1: 0.272844 (previous best: 0.190996)
loss: 1.008219, dev_acc: 54.26% (0.542602), dev_f1: 27.28% (0.272844), test_acc: 55.94% (0.559439), test_f1: 28.60% (0.285960)
Epoch 0 completed in 210.61 seconds (3.51 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.16 seconds (0.02 minutes)
New best dev_f1: 0.400322 (previous best: 0.272844)
loss: 0.805166, dev_acc: 58.62% (0.586224), dev_f1: 40.03% (0.400322), test_acc: 58.47% (0.584694), test_f1: 40.02% (0.400195)
Batch 60 completed in 1.23 seconds (0.02 minutes)
loss: 0.796981, dev_acc: 56.63% (0.566327), dev_f1: 39.08% (0.390828), test_acc: 56.07% (0.560714), test_f1: 38.84% (0.388423)
Epoch 1 completed in 211.82 seconds (3.53 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.17 seconds (0.02 minutes)
loss: 0.840414, dev_acc: 58.90% (0.589031), dev_f1: 37.85% (0.378547), test_acc: 60.15% (0.601531), test_f1: 38.99% (0.389893)
Batch 60 completed in 1.17 seconds (0.02 minutes)
loss: 0.823081, dev_acc: 59.06% (0.590561), dev_f1: 39.89% (0.398938), test_acc: 60.41% (0.604082), test_f1: 40.96% (0.409636)
Epoch 2 completed in 211.63 seconds (3.53 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.17 seconds (0.02 minutes)
loss: 0.892283, dev_acc: 57.35% (0.573469), dev_f1: 34.46% (0.344647), test_acc: 59.36% (0.593622), test_f1: 36.19% (0.361906)
Batch 60 completed in 1.16 seconds (0.02 minutes)
New best dev_f1: 0.405257 (previous best: 0.400322)
loss: 0.816530, dev_acc: 59.54% (0.595408), dev_f1: 40.53% (0.405257), test_acc: 60.71% (0.607143), test_f1: 41.44% (0.414423)
Epoch 3 completed in 214.34 seconds (3.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 1.17 seconds (0.02 minutes)
loss: 0.736763, dev_acc: 58.83% (0.588265), dev_f1: 40.49% (0.404873), test_acc: 60.26% (0.602551), test_f1: 41.58% (0.415761)
Batch 60 completed in 1.50 seconds (0.03 minutes)
New best dev_f1: 0.499621 (previous best: 0.405257)
loss: 0.737408, dev_acc: 59.54% (0.595408), dev_f1: 49.96% (0.499621), test_acc: 61.05% (0.610459), test_f1: 53.05% (0.530549)
Epoch 4 completed in 214.46 seconds (3.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 1.17 seconds (0.02 minutes)
loss: 0.717247, dev_acc: 59.59% (0.595918), dev_f1: 42.06% (0.420643), test_acc: 61.12% (0.611224), test_f1: 44.29% (0.442944)
Batch 60 completed in 1.16 seconds (0.02 minutes)
loss: 0.804663, dev_acc: 60.46% (0.604592), dev_f1: 43.62% (0.436204), test_acc: 61.51% (0.615051), test_f1: 45.26% (0.452630)
Epoch 5 completed in 214.40 seconds (3.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 1.17 seconds (0.02 minutes)
loss: 0.757694, dev_acc: 59.21% (0.592092), dev_f1: 45.72% (0.457239), test_acc: 61.07% (0.610714), test_f1: 48.30% (0.482975)
Batch 60 completed in 1.16 seconds (0.02 minutes)
loss: 0.785115, dev_acc: 59.72% (0.597194), dev_f1: 45.93% (0.459279), test_acc: 60.77% (0.607653), test_f1: 47.51% (0.475149)
Epoch 6 completed in 213.83 seconds (3.56 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 1.23 seconds (0.02 minutes)
loss: 0.831201, dev_acc: 60.00% (0.600000), dev_f1: 48.83% (0.488305), test_acc: 61.71% (0.617092), test_f1: 51.54% (0.515401)
Batch 60 completed in 1.16 seconds (0.02 minutes)
loss: 0.745212, dev_acc: 59.92% (0.599235), dev_f1: 45.73% (0.457293), test_acc: 61.53% (0.615306), test_f1: 46.45% (0.464528)
Epoch 7 completed in 213.28 seconds (3.55 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 1.17 seconds (0.02 minutes)
loss: 0.763133, dev_acc: 60.26% (0.602551), dev_f1: 44.81% (0.448135), test_acc: 61.94% (0.619388), test_f1: 46.41% (0.464069)
Batch 60 completed in 1.16 seconds (0.02 minutes)
loss: 0.639385, dev_acc: 59.69% (0.596939), dev_f1: 43.29% (0.432932), test_acc: 60.79% (0.607908), test_f1: 44.58% (0.445850)
Epoch 8 completed in 214.88 seconds (3.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 1.16 seconds (0.02 minutes)
loss: 0.793769, dev_acc: 56.12% (0.561224), dev_f1: 47.79% (0.477862), test_acc: 56.33% (0.563265), test_f1: 48.01% (0.480120)
Batch 60 completed in 1.16 seconds (0.02 minutes)
loss: 0.772660, dev_acc: 58.93% (0.589286), dev_f1: 43.36% (0.433588), test_acc: 60.03% (0.600255), test_f1: 44.30% (0.442958)
Epoch 9 completed in 213.44 seconds (3.56 minutes)
RESULT: Max Dev F1: 0.499621, Max Test F1: 0.530549
Dev F1: 0.499621, Test F1: 0.530549

Running hyperparameter combination 2/81
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fac6339dd00>
>>> learning_rate: 0.001
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 128
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 768
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/train.tsv ---------------
