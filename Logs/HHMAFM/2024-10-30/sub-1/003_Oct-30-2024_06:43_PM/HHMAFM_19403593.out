SLURM Job ID: 19403593
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-30/sub-1/003_Oct-30-2024_06:43_PM

Running hyperparameter combination 1/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.001
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 18.74 seconds (0.31 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 2.29 seconds (0.04 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 2.31 seconds (0.04 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.84 seconds (0.03 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 9.11 seconds (0.15 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.50 seconds (0.01 minutes)
loss: 1.826201, dev_acc: 20.00% (0.200000), dev_f1: 14.54% (0.145380), test_acc: 22.00% (0.220000), test_f1: 15.20% (0.152047)
Epoch 1 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.50 seconds (0.01 minutes)
loss: 1.104078, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 2 completed in 7.19 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.005601, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.981368, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.916892, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.981980, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.24 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.999426, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.991912, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.941207, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 49.00% (0.490000), test_f1: 23.99% (0.239909)
Epoch 9 completed in 7.31 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.197183, Max Test F1: 0.216216
Dev F1: 0.197183, Test F1: 0.216216

Running hyperparameter combination 2/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.001
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.64 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.38 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.37 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.55 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 2.398118, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 7.26 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.275030 (previous best: 0.197183)
loss: 1.051321, dev_acc: 40.00% (0.400000), dev_f1: 27.50% (0.275030), test_acc: 34.00% (0.340000), test_f1: 24.15% (0.241478)
Epoch 2 completed in 7.25 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.042516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.26 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.918897, dev_acc: 42.00% (0.420000), dev_f1: 22.50% (0.224950), test_acc: 50.00% (0.500000), test_f1: 29.22% (0.292153)
Epoch 4 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.906784, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.905720, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.286470 (previous best: 0.275030)
loss: 0.935688, dev_acc: 44.00% (0.440000), dev_f1: 28.65% (0.286470), test_acc: 48.00% (0.480000), test_f1: 26.19% (0.261939)
Epoch 7 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.310229 (previous best: 0.286470)
loss: 0.900769, dev_acc: 48.00% (0.480000), dev_f1: 31.02% (0.310229), test_acc: 51.00% (0.510000), test_f1: 34.55% (0.345455)
Epoch 8 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.398093 (previous best: 0.310229)
loss: 0.914353, dev_acc: 46.00% (0.460000), dev_f1: 39.81% (0.398093), test_acc: 55.00% (0.550000), test_f1: 44.07% (0.440670)
Epoch 9 completed in 7.28 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.398093, Max Test F1: 0.440670
Dev F1: 0.398093, Test F1: 0.440670

Running hyperparameter combination 3/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.68 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.31 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 5.801356, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 1 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.004843, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 2 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.013350, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.25 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.979015, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.908655, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.30 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.956199, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.26 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.014197, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.997733, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.340190 (previous best: 0.197183)
loss: 0.887104, dev_acc: 49.00% (0.490000), dev_f1: 34.02% (0.340190), test_acc: 50.00% (0.500000), test_f1: 35.28% (0.352785)
Epoch 9 completed in 7.27 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.340190, Max Test F1: 0.352785
Dev F1: 0.340190, Test F1: 0.352785

Running hyperparameter combination 4/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.61 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.30 seconds (0.00 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.296916 (previous best: 0.197183)
loss: 0.941116, dev_acc: 42.00% (0.420000), dev_f1: 29.69% (0.296916), test_acc: 49.00% (0.490000), test_f1: 33.38% (0.333788)
Epoch 1 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.801678, dev_acc: 41.00% (0.410000), dev_f1: 19.39% (0.193853), test_acc: 47.00% (0.470000), test_f1: 21.32% (0.213152)
Epoch 2 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.827775, dev_acc: 40.00% (0.400000), dev_f1: 27.35% (0.273460), test_acc: 47.00% (0.470000), test_f1: 38.73% (0.387316)
Epoch 3 completed in 7.30 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.408131 (previous best: 0.296916)
loss: 0.765394, dev_acc: 44.00% (0.440000), dev_f1: 40.81% (0.408131), test_acc: 38.00% (0.380000), test_f1: 36.33% (0.363324)
Epoch 4 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.477522, dev_acc: 48.00% (0.480000), dev_f1: 35.13% (0.351307), test_acc: 45.00% (0.450000), test_f1: 33.56% (0.335572)
Epoch 5 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.428461, dev_acc: 37.00% (0.370000), dev_f1: 32.66% (0.326622), test_acc: 51.00% (0.510000), test_f1: 41.17% (0.411665)
Epoch 6 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.258880, dev_acc: 39.00% (0.390000), dev_f1: 34.48% (0.344782), test_acc: 45.00% (0.450000), test_f1: 35.74% (0.357363)
Epoch 7 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.124671, dev_acc: 44.00% (0.440000), dev_f1: 37.38% (0.373826), test_acc: 42.00% (0.420000), test_f1: 31.36% (0.313650)
Epoch 8 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.091922, dev_acc: 43.00% (0.430000), dev_f1: 32.92% (0.329193), test_acc: 50.00% (0.500000), test_f1: 37.73% (0.377297)
Epoch 9 completed in 7.33 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.408131, Max Test F1: 0.363324
Dev F1: 0.408131, Test F1: 0.363324

Running hyperparameter combination 5/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.73 seconds (0.05 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.246104 (previous best: 0.197183)
loss: 0.890444, dev_acc: 39.00% (0.390000), dev_f1: 24.61% (0.246104), test_acc: 50.00% (0.500000), test_f1: 34.14% (0.341385)
Epoch 1 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.819067, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 47.00% (0.470000), test_f1: 21.32% (0.213152)
Epoch 2 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.303990 (previous best: 0.246104)
loss: 0.843290, dev_acc: 46.00% (0.460000), dev_f1: 30.40% (0.303990), test_acc: 50.00% (0.500000), test_f1: 35.59% (0.355932)
Epoch 3 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.409160 (previous best: 0.303990)
loss: 0.731140, dev_acc: 42.00% (0.420000), dev_f1: 40.92% (0.409160), test_acc: 46.00% (0.460000), test_f1: 43.90% (0.438978)
Epoch 4 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.434506, dev_acc: 43.00% (0.430000), dev_f1: 29.67% (0.296729), test_acc: 48.00% (0.480000), test_f1: 34.32% (0.343226)
Epoch 5 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.446230, dev_acc: 40.00% (0.400000), dev_f1: 24.54% (0.245396), test_acc: 50.00% (0.500000), test_f1: 32.85% (0.328498)
Epoch 6 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.226455, dev_acc: 45.00% (0.450000), dev_f1: 32.98% (0.329773), test_acc: 47.00% (0.470000), test_f1: 29.51% (0.295127)
Epoch 7 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.146052, dev_acc: 44.00% (0.440000), dev_f1: 35.47% (0.354663), test_acc: 47.00% (0.470000), test_f1: 35.74% (0.357379)
Epoch 8 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.105371, dev_acc: 45.00% (0.450000), dev_f1: 37.22% (0.372174), test_acc: 45.00% (0.450000), test_f1: 34.05% (0.340492)
Epoch 9 completed in 7.35 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.409160, Max Test F1: 0.438978
Dev F1: 0.409160, Test F1: 0.438978

Running hyperparameter combination 6/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.64 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.59 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.280668 (previous best: 0.197183)
loss: 0.911997, dev_acc: 43.00% (0.430000), dev_f1: 28.07% (0.280668), test_acc: 49.00% (0.490000), test_f1: 33.37% (0.333660)
Epoch 1 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.816142, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 47.00% (0.470000), test_f1: 25.72% (0.257245)
Epoch 2 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.377710 (previous best: 0.280668)
loss: 0.859925, dev_acc: 45.00% (0.450000), dev_f1: 37.77% (0.377710), test_acc: 40.00% (0.400000), test_f1: 34.22% (0.342174)
Epoch 3 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.824676, dev_acc: 40.00% (0.400000), dev_f1: 35.36% (0.353601), test_acc: 36.00% (0.360000), test_f1: 34.51% (0.345118)
Epoch 4 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.501457, dev_acc: 46.00% (0.460000), dev_f1: 33.87% (0.338711), test_acc: 45.00% (0.450000), test_f1: 33.87% (0.338710)
Epoch 5 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.480222, dev_acc: 40.00% (0.400000), dev_f1: 26.59% (0.265928), test_acc: 47.00% (0.470000), test_f1: 34.87% (0.348747)
Epoch 6 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.388917 (previous best: 0.377710)
loss: 0.276908, dev_acc: 41.00% (0.410000), dev_f1: 38.89% (0.388917), test_acc: 43.00% (0.430000), test_f1: 36.43% (0.364320)
Epoch 7 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.181171, dev_acc: 46.00% (0.460000), dev_f1: 38.62% (0.386160), test_acc: 47.00% (0.470000), test_f1: 35.28% (0.352777)
Epoch 8 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.133110, dev_acc: 48.00% (0.480000), dev_f1: 37.17% (0.371714), test_acc: 47.00% (0.470000), test_f1: 31.04% (0.310422)
Epoch 9 completed in 7.35 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.388917, Max Test F1: 0.364320
Dev F1: 0.388917, Test F1: 0.364320

Running hyperparameter combination 7/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 1e-05
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.69 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.36 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.57 seconds (0.01 minutes)
New best dev_f1: 0.235621 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 23.56% (0.235621), test_acc: 46.00% (0.460000), test_f1: 24.71% (0.247067)
Epoch 0 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.876925, dev_acc: 42.00% (0.420000), dev_f1: 21.15% (0.211498), test_acc: 46.00% (0.460000), test_f1: 23.03% (0.230315)
Epoch 1 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.345981 (previous best: 0.235621)
loss: 0.859793, dev_acc: 47.00% (0.470000), dev_f1: 34.60% (0.345981), test_acc: 43.00% (0.430000), test_f1: 32.05% (0.320473)
Epoch 2 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.860628, dev_acc: 42.00% (0.420000), dev_f1: 32.33% (0.323253), test_acc: 49.00% (0.490000), test_f1: 40.75% (0.407463)
Epoch 3 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.800067, dev_acc: 41.00% (0.410000), dev_f1: 25.01% (0.250149), test_acc: 52.00% (0.520000), test_f1: 37.87% (0.378667)
Epoch 4 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.750964, dev_acc: 42.00% (0.420000), dev_f1: 23.66% (0.236583), test_acc: 50.00% (0.500000), test_f1: 31.41% (0.314112)
Epoch 5 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.725122, dev_acc: 43.00% (0.430000), dev_f1: 22.91% (0.229075), test_acc: 50.00% (0.500000), test_f1: 27.79% (0.277938)
Epoch 6 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.708090, dev_acc: 44.00% (0.440000), dev_f1: 26.46% (0.264617), test_acc: 52.00% (0.520000), test_f1: 38.91% (0.389102)
Epoch 7 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.785771, dev_acc: 43.00% (0.430000), dev_f1: 29.79% (0.297884), test_acc: 49.00% (0.490000), test_f1: 34.60% (0.346015)
Epoch 8 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.637563, dev_acc: 38.00% (0.380000), dev_f1: 24.86% (0.248577), test_acc: 50.00% (0.500000), test_f1: 35.47% (0.354720)
Epoch 9 completed in 7.37 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.345981, Max Test F1: 0.320473
Dev F1: 0.345981, Test F1: 0.320473

Running hyperparameter combination 8/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 1e-05
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.92 seconds (0.05 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.31 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.56 seconds (0.01 minutes)
New best dev_f1: 0.231133 (previous best: 0.000000)
loss: 1.110516, dev_acc: 41.00% (0.410000), dev_f1: 23.11% (0.231133), test_acc: 46.00% (0.460000), test_f1: 24.71% (0.247067)
Epoch 0 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.881182, dev_acc: 43.00% (0.430000), dev_f1: 22.91% (0.229075), test_acc: 46.00% (0.460000), test_f1: 23.13% (0.231284)
Epoch 1 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.346195 (previous best: 0.231133)
loss: 0.853730, dev_acc: 47.00% (0.470000), dev_f1: 34.62% (0.346195), test_acc: 46.00% (0.460000), test_f1: 34.05% (0.340519)
Epoch 2 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.860990, dev_acc: 41.00% (0.410000), dev_f1: 31.76% (0.317613), test_acc: 50.00% (0.500000), test_f1: 42.61% (0.426138)
Epoch 3 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.799157, dev_acc: 39.00% (0.390000), dev_f1: 23.22% (0.232161), test_acc: 51.00% (0.510000), test_f1: 37.24% (0.372439)
Epoch 4 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.757369, dev_acc: 42.00% (0.420000), dev_f1: 23.66% (0.236583), test_acc: 52.00% (0.520000), test_f1: 32.48% (0.324786)
Epoch 5 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.727791, dev_acc: 43.00% (0.430000), dev_f1: 22.91% (0.229075), test_acc: 51.00% (0.510000), test_f1: 29.68% (0.296848)
Epoch 6 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.700589, dev_acc: 44.00% (0.440000), dev_f1: 26.46% (0.264617), test_acc: 51.00% (0.510000), test_f1: 37.23% (0.372296)
Epoch 7 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.775506, dev_acc: 43.00% (0.430000), dev_f1: 26.82% (0.268180), test_acc: 51.00% (0.510000), test_f1: 38.01% (0.380135)
Epoch 8 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.646343, dev_acc: 43.00% (0.430000), dev_f1: 27.53% (0.275325), test_acc: 51.00% (0.510000), test_f1: 36.23% (0.362310)
Epoch 9 completed in 7.37 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.346195, Max Test F1: 0.340519
Dev F1: 0.346195, Test F1: 0.340519

Running hyperparameter combination 9/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 1e-05
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.64 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.34 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.56 seconds (0.01 minutes)
New best dev_f1: 0.231133 (previous best: 0.000000)
loss: 1.112022, dev_acc: 41.00% (0.410000), dev_f1: 23.11% (0.231133), test_acc: 46.00% (0.460000), test_f1: 24.71% (0.247067)
Epoch 0 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.883540, dev_acc: 41.00% (0.410000), dev_f1: 22.08% (0.220806), test_acc: 46.00% (0.460000), test_f1: 23.13% (0.231284)
Epoch 1 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.345887 (previous best: 0.231133)
loss: 0.848195, dev_acc: 47.00% (0.470000), dev_f1: 34.59% (0.345887), test_acc: 44.00% (0.440000), test_f1: 32.87% (0.328704)
Epoch 2 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.870357, dev_acc: 41.00% (0.410000), dev_f1: 31.76% (0.317613), test_acc: 50.00% (0.500000), test_f1: 42.01% (0.420056)
Epoch 3 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.804297, dev_acc: 39.00% (0.390000), dev_f1: 23.22% (0.232161), test_acc: 51.00% (0.510000), test_f1: 37.10% (0.371037)
Epoch 4 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.749987, dev_acc: 41.00% (0.410000), dev_f1: 22.16% (0.221578), test_acc: 51.00% (0.510000), test_f1: 32.00% (0.319955)
Epoch 5 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.740170, dev_acc: 43.00% (0.430000), dev_f1: 22.91% (0.229075), test_acc: 51.00% (0.510000), test_f1: 29.75% (0.297546)
Epoch 6 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.726575, dev_acc: 44.00% (0.440000), dev_f1: 26.46% (0.264617), test_acc: 53.00% (0.530000), test_f1: 39.53% (0.395326)
Epoch 7 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.774911, dev_acc: 42.00% (0.420000), dev_f1: 29.26% (0.292593), test_acc: 50.00% (0.500000), test_f1: 35.93% (0.359330)
Epoch 8 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.663856, dev_acc: 40.00% (0.400000), dev_f1: 29.95% (0.299497), test_acc: 51.00% (0.510000), test_f1: 36.50% (0.365030)
Epoch 9 completed in 7.37 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.345887, Max Test F1: 0.328704
Dev F1: 0.345887, Test F1: 0.328704

Running hyperparameter combination 10/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.003
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.66 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.34 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.55 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.243872 (previous best: 0.197183)
loss: 401.924377, dev_acc: 36.00% (0.360000), dev_f1: 24.39% (0.243872), test_acc: 43.00% (0.430000), test_f1: 29.20% (0.292029)
Epoch 1 completed in 7.30 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 15.492113, dev_acc: 23.00% (0.230000), dev_f1: 16.75% (0.167517), test_acc: 26.00% (0.260000), test_f1: 17.54% (0.175439)
Epoch 2 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 9.380561, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.051025, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.26 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.931256, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.26 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.978733, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.24 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.032341, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.005419, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.973389, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 9 completed in 7.24 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.243872, Max Test F1: 0.292029
Dev F1: 0.243872, Test F1: 0.292029

Running hyperparameter combination 11/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.003
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.66 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.34 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.55 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 78.566109, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.165902, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 2 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.023386, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.982383, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.938899, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.951406, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.25 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.022691, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.999709, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.969677, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 9 completed in 7.28 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.197183, Max Test F1: 0.216216
Dev F1: 0.197183, Test F1: 0.216216

Running hyperparameter combination 12/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.003
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.60 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.31 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1170.174927, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 1 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 67.391411, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 2 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.249709, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.191211, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.277280, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 15.10% (0.151042)
Epoch 5 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.950073, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.027581, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.001982, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.973289, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 9 completed in 7.30 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.197183, Max Test F1: 0.216216
Dev F1: 0.197183, Test F1: 0.216216

Running hyperparameter combination 13/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0003
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.68 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.34 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.57 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.026944, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.186808, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 2 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 1.099092, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.995710, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.361069 (previous best: 0.197183)
loss: 0.904205, dev_acc: 50.00% (0.500000), dev_f1: 36.11% (0.361069), test_acc: 49.00% (0.490000), test_f1: 35.59% (0.355932)
Epoch 5 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.831951, dev_acc: 43.00% (0.430000), dev_f1: 25.75% (0.257471), test_acc: 52.00% (0.520000), test_f1: 36.13% (0.361266)
Epoch 6 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.468961 (previous best: 0.361069)
loss: 0.765376, dev_acc: 49.00% (0.490000), dev_f1: 46.90% (0.468961), test_acc: 49.00% (0.490000), test_f1: 46.65% (0.466522)
Epoch 7 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.648517, dev_acc: 44.00% (0.440000), dev_f1: 28.06% (0.280645), test_acc: 45.00% (0.450000), test_f1: 28.51% (0.285106)
Epoch 8 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.381897, dev_acc: 46.00% (0.460000), dev_f1: 34.74% (0.347380), test_acc: 47.00% (0.470000), test_f1: 34.66% (0.346595)
Epoch 9 completed in 7.33 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.468961, Max Test F1: 0.466522
Dev F1: 0.468961, Test F1: 0.466522

Running hyperparameter combination 14/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0003
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.65 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.56 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 2.231122, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 1 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.967145, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 2 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.061224, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.220806 (previous best: 0.197183)
loss: 0.976114, dev_acc: 41.00% (0.410000), dev_f1: 22.08% (0.220806), test_acc: 30.00% (0.300000), test_f1: 16.65% (0.166511)
Epoch 4 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.886879, dev_acc: 42.00% (0.420000), dev_f1: 21.15% (0.211498), test_acc: 50.00% (0.500000), test_f1: 26.22% (0.262189)
Epoch 5 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.932712, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.994191, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.275333 (previous best: 0.220806)
loss: 0.911868, dev_acc: 43.00% (0.430000), dev_f1: 27.53% (0.275333), test_acc: 47.00% (0.470000), test_f1: 32.14% (0.321382)
Epoch 8 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.303137 (previous best: 0.275333)
loss: 0.784208, dev_acc: 45.00% (0.450000), dev_f1: 30.31% (0.303137), test_acc: 45.00% (0.450000), test_f1: 20.69% (0.206897)
Epoch 9 completed in 7.34 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.303137, Max Test F1: 0.206897
Dev F1: 0.303137, Test F1: 0.206897

Running hyperparameter combination 15/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0003
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.69 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.36 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.55 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.528395, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 1 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.029473, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 2 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.243413 (previous best: 0.197183)
loss: 1.061314, dev_acc: 41.00% (0.410000), dev_f1: 24.34% (0.243413), test_acc: 49.00% (0.490000), test_f1: 30.03% (0.300307)
Epoch 3 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.954268, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 4 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.897698, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 49.00% (0.490000), test_f1: 23.99% (0.239909)
Epoch 5 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.884808, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.913485, dev_acc: 43.00% (0.430000), dev_f1: 21.52% (0.215248), test_acc: 52.00% (0.520000), test_f1: 30.30% (0.303030)
Epoch 7 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.264933 (previous best: 0.243413)
loss: 0.782149, dev_acc: 44.00% (0.440000), dev_f1: 26.49% (0.264933), test_acc: 48.00% (0.480000), test_f1: 31.25% (0.312507)
Epoch 8 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.289814 (previous best: 0.264933)
loss: 0.707304, dev_acc: 43.00% (0.430000), dev_f1: 28.98% (0.289814), test_acc: 48.00% (0.480000), test_f1: 31.16% (0.311574)
Epoch 9 completed in 7.34 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.289814, Max Test F1: 0.311574
Dev F1: 0.289814, Test F1: 0.311574

Running hyperparameter combination 16/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 3e-05
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.68 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 8.71 seconds (0.15 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.55 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.198582 (previous best: 0.197183)
loss: 0.795780, dev_acc: 42.00% (0.420000), dev_f1: 19.86% (0.198582), test_acc: 52.00% (0.520000), test_f1: 31.25% (0.312500)
Epoch 1 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.285859 (previous best: 0.198582)
loss: 0.727203, dev_acc: 44.00% (0.440000), dev_f1: 28.59% (0.285859), test_acc: 50.00% (0.500000), test_f1: 33.82% (0.338158)
Epoch 2 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.760983, dev_acc: 44.00% (0.440000), dev_f1: 26.39% (0.263854), test_acc: 51.00% (0.510000), test_f1: 30.83% (0.308281)
Epoch 3 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.391742 (previous best: 0.285859)
loss: 0.702309, dev_acc: 44.00% (0.440000), dev_f1: 39.17% (0.391742), test_acc: 39.00% (0.390000), test_f1: 33.51% (0.335055)
Epoch 4 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.584948, dev_acc: 42.00% (0.420000), dev_f1: 26.30% (0.262972), test_acc: 53.00% (0.530000), test_f1: 37.04% (0.370370)
Epoch 5 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.616278, dev_acc: 43.00% (0.430000), dev_f1: 31.58% (0.315807), test_acc: 41.00% (0.410000), test_f1: 30.68% (0.306842)
Epoch 6 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.482239, dev_acc: 42.00% (0.420000), dev_f1: 26.32% (0.263203), test_acc: 51.00% (0.510000), test_f1: 36.59% (0.365873)
Epoch 7 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.478554, dev_acc: 43.00% (0.430000), dev_f1: 33.63% (0.336319), test_acc: 51.00% (0.510000), test_f1: 41.34% (0.413386)
Epoch 8 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.335700, dev_acc: 41.00% (0.410000), dev_f1: 31.86% (0.318563), test_acc: 49.00% (0.490000), test_f1: 38.10% (0.380962)
Epoch 9 completed in 7.35 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.391742, Max Test F1: 0.335055
Dev F1: 0.391742, Test F1: 0.335055

Running hyperparameter combination 17/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 3e-05
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.77 seconds (0.05 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.35 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.215248 (previous best: 0.197183)
loss: 0.787195, dev_acc: 43.00% (0.430000), dev_f1: 21.52% (0.215248), test_acc: 52.00% (0.520000), test_f1: 30.30% (0.303030)
Epoch 1 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.285560 (previous best: 0.215248)
loss: 0.733245, dev_acc: 44.00% (0.440000), dev_f1: 28.56% (0.285560), test_acc: 49.00% (0.490000), test_f1: 33.18% (0.331811)
Epoch 2 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.771582, dev_acc: 43.00% (0.430000), dev_f1: 24.73% (0.247274), test_acc: 49.00% (0.490000), test_f1: 29.90% (0.299013)
Epoch 3 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.409087 (previous best: 0.285560)
loss: 0.696858, dev_acc: 46.00% (0.460000), dev_f1: 40.91% (0.409087), test_acc: 46.00% (0.460000), test_f1: 38.57% (0.385679)
Epoch 4 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.588130, dev_acc: 46.00% (0.460000), dev_f1: 31.44% (0.314358), test_acc: 50.00% (0.500000), test_f1: 36.34% (0.363409)
Epoch 5 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.635350, dev_acc: 42.00% (0.420000), dev_f1: 29.80% (0.297984), test_acc: 48.00% (0.480000), test_f1: 35.15% (0.351493)
Epoch 6 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.497341, dev_acc: 42.00% (0.420000), dev_f1: 26.32% (0.263203), test_acc: 49.00% (0.490000), test_f1: 34.35% (0.343453)
Epoch 7 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.472867, dev_acc: 45.00% (0.450000), dev_f1: 35.64% (0.356405), test_acc: 47.00% (0.470000), test_f1: 35.59% (0.355915)
Epoch 8 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.354237, dev_acc: 43.00% (0.430000), dev_f1: 32.98% (0.329791), test_acc: 49.00% (0.490000), test_f1: 38.06% (0.380645)
Epoch 9 completed in 7.34 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.409087, Max Test F1: 0.385679
Dev F1: 0.409087, Test F1: 0.385679

Running hyperparameter combination 18/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 3e-05
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.66 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.31 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.55 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.198582 (previous best: 0.197183)
loss: 0.778840, dev_acc: 42.00% (0.420000), dev_f1: 19.86% (0.198582), test_acc: 51.00% (0.510000), test_f1: 28.32% (0.283190)
Epoch 1 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.244968 (previous best: 0.198582)
loss: 0.745450, dev_acc: 44.00% (0.440000), dev_f1: 24.50% (0.244968), test_acc: 51.00% (0.510000), test_f1: 35.33% (0.353317)
Epoch 2 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.263854 (previous best: 0.244968)
loss: 0.794215, dev_acc: 44.00% (0.440000), dev_f1: 26.39% (0.263854), test_acc: 51.00% (0.510000), test_f1: 30.88% (0.308798)
Epoch 3 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.430399 (previous best: 0.263854)
loss: 0.732286, dev_acc: 49.00% (0.490000), dev_f1: 43.04% (0.430399), test_acc: 43.00% (0.430000), test_f1: 38.10% (0.380952)
Epoch 4 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.601181, dev_acc: 45.00% (0.450000), dev_f1: 30.39% (0.303949), test_acc: 50.00% (0.500000), test_f1: 36.27% (0.362740)
Epoch 5 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.653108, dev_acc: 43.00% (0.430000), dev_f1: 30.07% (0.300690), test_acc: 49.00% (0.490000), test_f1: 35.57% (0.355719)
Epoch 6 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.509336, dev_acc: 40.00% (0.400000), dev_f1: 24.58% (0.245791), test_acc: 50.00% (0.500000), test_f1: 35.76% (0.357602)
Epoch 7 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.488337, dev_acc: 42.00% (0.420000), dev_f1: 35.51% (0.355076), test_acc: 47.00% (0.470000), test_f1: 37.74% (0.377427)
Epoch 8 completed in 7.39 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.402742, dev_acc: 43.00% (0.430000), dev_f1: 36.20% (0.362038), test_acc: 49.00% (0.490000), test_f1: 41.45% (0.414510)
Epoch 9 completed in 7.37 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.430399, Max Test F1: 0.380952
Dev F1: 0.430399, Test F1: 0.380952

Running hyperparameter combination 19/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.005
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.72 seconds (0.05 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.57 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1018.397034, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 1 completed in 7.30 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.226097 (previous best: 0.197183)
loss: 663.153687, dev_acc: 35.00% (0.350000), dev_f1: 22.61% (0.226097), test_acc: 40.00% (0.400000), test_f1: 25.03% (0.250286)
Epoch 2 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 90.188026, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 3 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.255069 (previous best: 0.226097)
loss: 4.163260, dev_acc: 43.00% (0.430000), dev_f1: 25.51% (0.255069), test_acc: 49.00% (0.490000), test_f1: 26.70% (0.266975)
Epoch 4 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.205038, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.967907, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 448.275299, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.074370, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.976936, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 9 completed in 7.26 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.255069, Max Test F1: 0.266975
Dev F1: 0.255069, Test F1: 0.266975

Running hyperparameter combination 20/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.005
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.58 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.56 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 3611.898193, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 11252.762695, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 2 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 174.645416, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 3 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 14.981224, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 4 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 21.184845, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 2.150466, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 6 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.026723, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.25 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.009090, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.27 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.970197, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 9 completed in 7.26 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.197183, Max Test F1: 0.216216
Dev F1: 0.197183, Test F1: 0.216216

Running hyperparameter combination 21/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.005
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.61 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.30 seconds (0.00 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.56 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 4147.142090, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1301.127197, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 2 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 642.972900, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 3 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 29.877260, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 4.339143, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 5 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.969043, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.031494, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.29 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.006963, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.28 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.984478, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 9 completed in 7.27 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.197183, Max Test F1: 0.216216
Dev F1: 0.197183, Test F1: 0.216216

Running hyperparameter combination 22/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.59 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.59 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.40 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 3.968498, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 1 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.384982, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 2 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 1.040508, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.979331, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 4 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.911784, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.950827, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.972781, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.943797, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 8 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.867026, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 9 completed in 7.33 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.197183, Max Test F1: 0.216216
Dev F1: 0.197183, Test F1: 0.216216

Running hyperparameter combination 23/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.66 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.31 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.57 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 1.426702, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 1 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 1.078025, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 2 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 1.065807, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 3 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.359566 (previous best: 0.197183)
loss: 0.981676, dev_acc: 49.00% (0.490000), dev_f1: 35.96% (0.359566), test_acc: 45.00% (0.450000), test_f1: 33.69% (0.336919)
Epoch 4 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.906202, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.918169, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.956111, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.376514 (previous best: 0.359566)
loss: 0.931875, dev_acc: 52.00% (0.520000), dev_f1: 37.65% (0.376514), test_acc: 49.00% (0.490000), test_f1: 36.16% (0.361582)
Epoch 8 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.876733, dev_acc: 43.00% (0.430000), dev_f1: 24.01% (0.240102), test_acc: 51.00% (0.510000), test_f1: 31.01% (0.310087)
Epoch 9 completed in 7.34 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.376514, Max Test F1: 0.361582
Dev F1: 0.376514, Test F1: 0.361582

Running hyperparameter combination 24/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.66 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.59 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.39 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 5.910298, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 7.31 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 1.440175, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 2 completed in 7.32 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 1.006778, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 3 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.994669, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 4 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.912894, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 5 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.924613, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.51 seconds (0.01 minutes)
loss: 0.949826, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 7 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.361846 (previous best: 0.197183)
loss: 0.955333, dev_acc: 49.00% (0.490000), dev_f1: 36.18% (0.361846), test_acc: 46.00% (0.460000), test_f1: 34.54% (0.345361)
Epoch 8 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.851606, dev_acc: 44.00% (0.440000), dev_f1: 25.55% (0.255502), test_acc: 52.00% (0.520000), test_f1: 32.72% (0.327156)
Epoch 9 completed in 7.34 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.361846, Max Test F1: 0.345361
Dev F1: 0.361846, Test F1: 0.345361

Running hyperparameter combination 25/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 5e-05
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.71 seconds (0.05 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.107865, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.40 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.224950 (previous best: 0.197183)
loss: 0.806370, dev_acc: 42.00% (0.420000), dev_f1: 22.50% (0.224950), test_acc: 51.00% (0.510000), test_f1: 32.11% (0.321090)
Epoch 1 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.266159 (previous best: 0.224950)
loss: 0.735198, dev_acc: 40.00% (0.400000), dev_f1: 26.62% (0.266159), test_acc: 52.00% (0.520000), test_f1: 38.24% (0.382363)
Epoch 2 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.823699, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 50.00% (0.500000), test_f1: 28.73% (0.287270)
Epoch 3 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.336367 (previous best: 0.266159)
loss: 0.652294, dev_acc: 42.00% (0.420000), dev_f1: 33.64% (0.336367), test_acc: 47.00% (0.470000), test_f1: 39.09% (0.390881)
Epoch 4 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.463386, dev_acc: 45.00% (0.450000), dev_f1: 32.84% (0.328369), test_acc: 41.00% (0.410000), test_f1: 31.07% (0.310732)
Epoch 5 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.595450, dev_acc: 43.00% (0.430000), dev_f1: 27.54% (0.275396), test_acc: 46.00% (0.460000), test_f1: 31.17% (0.311653)
Epoch 6 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.362091, dev_acc: 42.00% (0.420000), dev_f1: 30.13% (0.301253), test_acc: 47.00% (0.470000), test_f1: 31.91% (0.319111)
Epoch 7 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.390285 (previous best: 0.336367)
loss: 0.309580, dev_acc: 42.00% (0.420000), dev_f1: 39.03% (0.390285), test_acc: 47.00% (0.470000), test_f1: 39.71% (0.397121)
Epoch 8 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.175802, dev_acc: 43.00% (0.430000), dev_f1: 31.29% (0.312915), test_acc: 47.00% (0.470000), test_f1: 30.01% (0.300094)
Epoch 9 completed in 7.37 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.390285, Max Test F1: 0.397121
Dev F1: 0.390285, Test F1: 0.397121

Running hyperparameter combination 26/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 5e-05
>>> dropout_rate: 0.3
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.67 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.32 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.34 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.57 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.110516, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.38 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.241290 (previous best: 0.197183)
loss: 0.810635, dev_acc: 41.00% (0.410000), dev_f1: 24.13% (0.241290), test_acc: 50.00% (0.500000), test_f1: 32.46% (0.324605)
Epoch 1 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.51 seconds (0.01 minutes)
New best dev_f1: 0.337729 (previous best: 0.241290)
loss: 0.752123, dev_acc: 45.00% (0.450000), dev_f1: 33.77% (0.337729), test_acc: 53.00% (0.530000), test_f1: 41.33% (0.413250)
Epoch 2 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.782280, dev_acc: 44.00% (0.440000), dev_f1: 23.25% (0.232520), test_acc: 51.00% (0.510000), test_f1: 30.83% (0.308281)
Epoch 3 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.382372 (previous best: 0.337729)
loss: 0.673077, dev_acc: 48.00% (0.480000), dev_f1: 38.24% (0.382372), test_acc: 44.00% (0.440000), test_f1: 36.86% (0.368590)
Epoch 4 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.487655, dev_acc: 46.00% (0.460000), dev_f1: 33.90% (0.338951), test_acc: 41.00% (0.410000), test_f1: 30.58% (0.305819)
Epoch 5 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.591781, dev_acc: 44.00% (0.440000), dev_f1: 27.33% (0.273306), test_acc: 51.00% (0.510000), test_f1: 35.34% (0.353419)
Epoch 6 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.369751, dev_acc: 40.00% (0.400000), dev_f1: 27.08% (0.270833), test_acc: 50.00% (0.500000), test_f1: 34.29% (0.342883)
Epoch 7 completed in 7.36 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.341185, dev_acc: 41.00% (0.410000), dev_f1: 37.44% (0.374420), test_acc: 48.00% (0.480000), test_f1: 42.93% (0.429302)
Epoch 8 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.212133, dev_acc: 42.00% (0.420000), dev_f1: 30.19% (0.301870), test_acc: 46.00% (0.460000), test_f1: 28.46% (0.284590)
Epoch 9 completed in 7.35 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.382372, Max Test F1: 0.368590
Dev F1: 0.382372, Test F1: 0.368590

Running hyperparameter combination 27/27
> training arguments:
>>> rand_seed: 8
>>> model_name: cmhafusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fbd96cd9d00>
>>> learning_rate: 5e-05
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: None
>>> model_class: <class 'models.cmhafusion.CMHAFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.66 seconds (0.04 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.31 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.33 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
n_trainable_params: 142087811, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.112022, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 7.41 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.804222, dev_acc: 41.00% (0.410000), dev_f1: 19.52% (0.195238), test_acc: 50.00% (0.500000), test_f1: 29.22% (0.292153)
Epoch 1 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.298512 (previous best: 0.197183)
loss: 0.761193, dev_acc: 44.00% (0.440000), dev_f1: 29.85% (0.298512), test_acc: 51.00% (0.510000), test_f1: 32.90% (0.329036)
Epoch 2 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.816601, dev_acc: 43.00% (0.430000), dev_f1: 21.52% (0.215248), test_acc: 51.00% (0.510000), test_f1: 30.83% (0.308281)
Epoch 3 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.52 seconds (0.01 minutes)
New best dev_f1: 0.401410 (previous best: 0.298512)
loss: 0.676527, dev_acc: 43.00% (0.430000), dev_f1: 40.14% (0.401410), test_acc: 47.00% (0.470000), test_f1: 40.57% (0.405666)
Epoch 4 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.481202, dev_acc: 45.00% (0.450000), dev_f1: 33.10% (0.330952), test_acc: 40.00% (0.400000), test_f1: 30.27% (0.302725)
Epoch 5 completed in 7.33 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.555601, dev_acc: 43.00% (0.430000), dev_f1: 25.10% (0.251044), test_acc: 48.00% (0.480000), test_f1: 32.11% (0.321070)
Epoch 6 completed in 7.34 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.377992, dev_acc: 47.00% (0.470000), dev_f1: 37.84% (0.378362), test_acc: 48.00% (0.480000), test_f1: 33.40% (0.334009)
Epoch 7 completed in 7.35 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.351281, dev_acc: 43.00% (0.430000), dev_f1: 38.70% (0.387035), test_acc: 48.00% (0.480000), test_f1: 39.91% (0.399079)
Epoch 8 completed in 7.37 seconds (0.12 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.52 seconds (0.01 minutes)
loss: 0.215394, dev_acc: 44.00% (0.440000), dev_f1: 30.99% (0.309909), test_acc: 46.00% (0.460000), test_f1: 28.46% (0.284590)
Epoch 9 completed in 7.37 seconds (0.12 minutes)
RESULT: Max Dev F1: 0.401410, Max Test F1: 0.405666
Dev F1: 0.401410, Test F1: 0.405666

Best Hyperparameters:
learning_rate: 0.0003
dropout_rate: 0.1
Best Dev F1: 0.468961
Corresponding Test F1: 0.466522
