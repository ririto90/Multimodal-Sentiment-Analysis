Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/002_Oct-21-2024_01:31_PM
/home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/002_Oct-21-2024_01:31_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mmfusion
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f333269dc60>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 30
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> common_dim: 512
>>> num_classes: 3
>>> model_class: <class 'models.mmfusion.MMFUSION'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 17.96 seconds (0.30 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 2.33 seconds (0.04 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 2.33 seconds (0.04 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
building model
n_trainable_params: 43766787, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.93 seconds (0.03 minutes)
max_dev_f1: 0, max_test_f1: 0
loss: 1.116304, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 10.02 seconds (0.17 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.56 seconds (0.01 minutes)
max_dev_f1: 0.19718309859154928, max_test_f1: 0.21621621621621623
loss: 0.969346, dev_acc: 41.00% (0.410000), dev_f1: 35.11% (0.351095), test_acc: 45.00% (0.450000), test_f1: 38.01% (0.380111)
Epoch 1 completed in 8.04 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.57 seconds (0.01 minutes)
max_dev_f1: 0.35109530991883936, max_test_f1: 0.3801108801108801
loss: 0.828517, dev_acc: 52.00% (0.520000), dev_f1: 49.59% (0.495881), test_acc: 48.00% (0.480000), test_f1: 40.03% (0.400311)
Epoch 2 completed in 7.96 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.652742, dev_acc: 51.00% (0.510000), dev_f1: 45.62% (0.456212), test_acc: 40.00% (0.400000), test_f1: 31.90% (0.318999)
Epoch 3 completed in 8.03 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.454753, dev_acc: 48.00% (0.480000), dev_f1: 39.99% (0.399948), test_acc: 44.00% (0.440000), test_f1: 30.40% (0.303951)
Epoch 4 completed in 8.11 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.467704, dev_acc: 50.00% (0.500000), dev_f1: 47.17% (0.471675), test_acc: 42.00% (0.420000), test_f1: 34.85% (0.348506)
Epoch 5 completed in 8.10 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.327016, dev_acc: 46.00% (0.460000), dev_f1: 40.01% (0.400149), test_acc: 43.00% (0.430000), test_f1: 31.12% (0.311215)
Epoch 6 completed in 8.06 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.266965, dev_acc: 49.00% (0.490000), dev_f1: 42.54% (0.425439), test_acc: 47.00% (0.470000), test_f1: 34.37% (0.343707)
Epoch 7 completed in 8.15 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.263640, dev_acc: 47.00% (0.470000), dev_f1: 43.82% (0.438152), test_acc: 39.00% (0.390000), test_f1: 34.73% (0.347263)
Epoch 8 completed in 8.12 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.58 seconds (0.01 minutes)
loss: 0.114622, dev_acc: 48.00% (0.480000), dev_f1: 41.41% (0.414139), test_acc: 43.00% (0.430000), test_f1: 31.57% (0.315671)
Epoch 9 completed in 8.10 seconds (0.13 minutes)
Max dev F1: 49.59% (0.495881), Max test F1: 40.03% (0.400311)
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Step: 1, Loss: 1.1163043975830078
Step: 2, Loss: 2.4052703380584717
Step: 3, Loss: 1.715410590171814
Step: 4, Loss: 1.4294965267181396
Step: 5, Loss: 0.989017903804779
Step: 6, Loss: 1.3220250606536865
Step: 7, Loss: 1.3408108949661255
Step: 8, Loss: 1.179555058479309
Step: 9, Loss: 1.3593600988388062
Step: 10, Loss: 1.0010229349136353
Step: 11, Loss: 1.4775829315185547
Step: 12, Loss: 1.1885318756103516
Step: 13, Loss: 0.9756001234054565
Step: 14, Loss: 0.9693461656570435
Step: 15, Loss: 0.8074425458908081
Step: 16, Loss: 0.933037281036377
Step: 17, Loss: 0.8275969624519348
Step: 18, Loss: 0.8128840923309326
Step: 19, Loss: 0.9122982621192932
Step: 20, Loss: 0.9556127786636353
Step: 21, Loss: 0.8735745549201965
Step: 22, Loss: 0.8735895752906799
Step: 23, Loss: 1.0087319612503052
Step: 24, Loss: 0.9044811725616455
Step: 25, Loss: 0.8292088508605957
Step: 26, Loss: 0.8299075961112976
Step: 27, Loss: 0.8285166025161743
Step: 28, Loss: 0.8122622966766357
Step: 29, Loss: 0.7533379793167114
Step: 30, Loss: 0.801831066608429
Step: 31, Loss: 0.8141810894012451
Step: 32, Loss: 0.6905539035797119
Step: 33, Loss: 0.7198307514190674
Step: 34, Loss: 0.8779506683349609
Step: 35, Loss: 0.7605917453765869
Step: 36, Loss: 0.700995922088623
Step: 37, Loss: 0.801634669303894
Step: 38, Loss: 0.8006193041801453
Step: 39, Loss: 0.9361635446548462
Step: 40, Loss: 0.652741551399231
Step: 41, Loss: 0.6413589119911194
Step: 42, Loss: 0.6888293027877808
Step: 43, Loss: 0.5481802821159363
Step: 44, Loss: 0.5997787714004517
Step: 45, Loss: 0.7544237971305847
Step: 46, Loss: 0.6307616829872131
Step: 47, Loss: 0.5687144994735718
Step: 48, Loss: 0.769709050655365
Step: 49, Loss: 0.7139396071434021
Step: 50, Loss: 0.6608160734176636
Step: 51, Loss: 0.783238410949707
Step: 52, Loss: 1.038260817527771
Step: 53, Loss: 0.4547532796859741
Step: 54, Loss: 0.4008185863494873
Step: 55, Loss: 0.5684576630592346
Step: 56, Loss: 0.75789475440979
Step: 57, Loss: 0.7814012765884399
Step: 58, Loss: 0.5487059950828552
Step: 59, Loss: 0.46850383281707764
Step: 60, Loss: 0.46541762351989746
Step: 61, Loss: 0.5340553522109985
Step: 62, Loss: 0.5010032653808594
Step: 63, Loss: 0.5040633678436279
Step: 64, Loss: 0.5946038961410522
Step: 65, Loss: 0.8547651171684265
Step: 66, Loss: 0.46770432591438293
Step: 67, Loss: 0.4349062740802765
Step: 68, Loss: 0.3770042657852173
Step: 69, Loss: 0.3631289601325989
Step: 70, Loss: 0.3920760452747345
Step: 71, Loss: 0.5397235155105591
Step: 72, Loss: 0.470952570438385
Step: 73, Loss: 0.45692938566207886
Step: 74, Loss: 0.3458021581172943
Step: 75, Loss: 0.364053875207901
Step: 76, Loss: 0.540363609790802
Step: 77, Loss: 0.5750071406364441
Step: 78, Loss: 0.5472696423530579
Step: 79, Loss: 0.3270164430141449
Step: 80, Loss: 0.2994326651096344
Step: 81, Loss: 0.32765868306159973
Step: 82, Loss: 0.31746259331703186
Step: 83, Loss: 0.2575468122959137
Step: 84, Loss: 0.2941168546676636
Step: 85, Loss: 0.30619364976882935
Step: 86, Loss: 0.5052580237388611
Step: 87, Loss: 0.2751053273677826
Step: 88, Loss: 0.28036636114120483
Step: 89, Loss: 0.4586353302001953
Step: 90, Loss: 0.2835657298564911
Step: 91, Loss: 0.3376511037349701
Step: 92, Loss: 0.26696470379829407
Step: 93, Loss: 0.37326598167419434
Step: 94, Loss: 0.20889928936958313
Step: 95, Loss: 0.26142093539237976
Step: 96, Loss: 0.1452939212322235
Step: 97, Loss: 0.3296991288661957
Step: 98, Loss: 0.31425660848617554
Step: 99, Loss: 0.3156284689903259
Step: 100, Loss: 0.16329479217529297
Step: 101, Loss: 0.24658910930156708
Step: 102, Loss: 0.28329405188560486
Step: 103, Loss: 0.3201371431350708
Step: 104, Loss: 0.3539329469203949
Step: 105, Loss: 0.26363977789878845
Step: 106, Loss: 0.2346806824207306
Step: 107, Loss: 0.16760164499282837
Step: 108, Loss: 0.18659305572509766
Step: 109, Loss: 0.122563436627388
Step: 110, Loss: 0.15456120669841766
Step: 111, Loss: 0.322904497385025
Step: 112, Loss: 0.22061502933502197
Step: 113, Loss: 0.26583194732666016
Step: 114, Loss: 0.16374781727790833
Step: 115, Loss: 0.20026054978370667
Step: 116, Loss: 0.5561103820800781
Step: 117, Loss: 0.36143171787261963
Step: 118, Loss: 0.11462237685918808
Step: 119, Loss: 0.1343764066696167
Step: 120, Loss: 0.13267570734024048
Step: 121, Loss: 0.1740923374891281
Step: 122, Loss: 0.17636913061141968
Step: 123, Loss: 0.08424948155879974
Step: 124, Loss: 0.24184419214725494
Step: 125, Loss: 0.2101055085659027
Step: 126, Loss: 0.15154984593391418
Step: 127, Loss: 0.21753789484500885
Step: 128, Loss: 0.2126029133796692
Step: 129, Loss: 0.24976614117622375
Step: 130, Loss: 0.2459181547164917
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/002_Oct-21-2024_01:31_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/002_Oct-21-2024_01:31_PM/trainval_loss_curves.png
Total Completion Time: 2.10 minutes. (0.03 hours) 
