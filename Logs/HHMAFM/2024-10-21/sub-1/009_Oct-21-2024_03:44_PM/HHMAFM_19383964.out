Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/009_Oct-21-2024_03:44_PM
/home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/009_Oct-21-2024_03:44_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f910a801c60>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 30
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> common_dim: 512
>>> num_classes: 3
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 16.85 seconds (0.28 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 2.01 seconds (0.03 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 2.12 seconds (0.04 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
building model
n_trainable_params: 77323267, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.88 seconds (0.03 minutes)
max_dev_f1: 0, max_test_f1: 0
loss: 1.100541, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 10.06 seconds (0.17 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.57 seconds (0.01 minutes)
loss: 0.914078, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 8.13 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.58 seconds (0.01 minutes)
max_dev_f1: 0.19718309859154928, max_test_f1: 0.21621621621621623
loss: 0.841686, dev_acc: 57.00% (0.570000), dev_f1: 51.44% (0.514387), test_acc: 42.00% (0.420000), test_f1: 31.36% (0.313649)
Epoch 2 completed in 8.07 seconds (0.13 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.58 seconds (0.01 minutes)
loss: 0.831564, dev_acc: 47.00% (0.470000), dev_f1: 40.03% (0.400331), test_acc: 47.00% (0.470000), test_f1: 36.08% (0.360765)
Epoch 3 completed in 8.18 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.58 seconds (0.01 minutes)
max_dev_f1: 0.5143868721881049, max_test_f1: 0.31364931364931364
loss: 0.666974, dev_acc: 57.00% (0.570000), dev_f1: 54.12% (0.541180), test_acc: 39.00% (0.390000), test_f1: 29.73% (0.297314)
Epoch 4 completed in 8.19 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.58 seconds (0.01 minutes)
loss: 0.553082, dev_acc: 52.00% (0.520000), dev_f1: 43.99% (0.439890), test_acc: 49.00% (0.490000), test_f1: 33.17% (0.331718)
Epoch 5 completed in 8.18 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.58 seconds (0.01 minutes)
loss: 0.356162, dev_acc: 45.00% (0.450000), dev_f1: 35.10% (0.351003), test_acc: 42.00% (0.420000), test_f1: 23.60% (0.236042)
Epoch 6 completed in 8.17 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.58 seconds (0.01 minutes)
loss: 0.293180, dev_acc: 50.00% (0.500000), dev_f1: 47.54% (0.475376), test_acc: 42.00% (0.420000), test_f1: 37.84% (0.378436)
Epoch 7 completed in 8.26 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.58 seconds (0.01 minutes)
loss: 0.361274, dev_acc: 37.00% (0.370000), dev_f1: 34.32% (0.343197), test_acc: 43.00% (0.430000), test_f1: 39.01% (0.390101)
Epoch 8 completed in 8.21 seconds (0.14 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.59 seconds (0.01 minutes)
loss: 0.141076, dev_acc: 38.00% (0.380000), dev_f1: 30.08% (0.300795), test_acc: 45.00% (0.450000), test_f1: 29.91% (0.299096)
Epoch 9 completed in 8.23 seconds (0.14 minutes)
Max dev F1: 54.12% (0.541180), Max test F1: 29.73% (0.297314)
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Step: 1, Loss: 1.1005407571792603
Step: 2, Loss: 1.0352497100830078
Step: 3, Loss: 0.9837816953659058
Step: 4, Loss: 1.1175001859664917
Step: 5, Loss: 0.9603274464607239
Step: 6, Loss: 1.2398505210876465
Step: 7, Loss: 1.1573634147644043
Step: 8, Loss: 0.9807177782058716
Step: 9, Loss: 0.9994187951087952
Step: 10, Loss: 1.1622443199157715
Step: 11, Loss: 1.0678406953811646
Step: 12, Loss: 1.0477083921432495
Step: 13, Loss: 1.0395479202270508
Step: 14, Loss: 0.914078414440155
Step: 15, Loss: 0.9988962411880493
Step: 16, Loss: 0.8327019810676575
Step: 17, Loss: 1.1289678812026978
Step: 18, Loss: 1.0074331760406494
Step: 19, Loss: 0.9524074792861938
Step: 20, Loss: 1.020729422569275
Step: 21, Loss: 0.9479195475578308
Step: 22, Loss: 0.9243888854980469
Step: 23, Loss: 0.8688092827796936
Step: 24, Loss: 0.978886067867279
Step: 25, Loss: 1.0984171628952026
Step: 26, Loss: 0.988449215888977
Step: 27, Loss: 0.8416855931282043
Step: 28, Loss: 0.8361796140670776
Step: 29, Loss: 0.9837071299552917
Step: 30, Loss: 0.8804529905319214
Step: 31, Loss: 0.8761522769927979
Step: 32, Loss: 0.8499753475189209
Step: 33, Loss: 0.8742138743400574
Step: 34, Loss: 0.8000664114952087
Step: 35, Loss: 0.7765412926673889
Step: 36, Loss: 0.9485508799552917
Step: 37, Loss: 1.1427723169326782
Step: 38, Loss: 0.9027780890464783
Step: 39, Loss: 0.863664448261261
Step: 40, Loss: 0.8315635323524475
Step: 41, Loss: 0.7990325093269348
Step: 42, Loss: 0.7566398978233337
Step: 43, Loss: 0.839811384677887
Step: 44, Loss: 0.8118950128555298
Step: 45, Loss: 0.8533059358596802
Step: 46, Loss: 0.6813100576400757
Step: 47, Loss: 0.8027499318122864
Step: 48, Loss: 0.9034961462020874
Step: 49, Loss: 0.795226514339447
Step: 50, Loss: 0.9224265813827515
Step: 51, Loss: 1.0043959617614746
Step: 52, Loss: 1.0009918212890625
Step: 53, Loss: 0.666973888874054
Step: 54, Loss: 0.7771510481834412
Step: 55, Loss: 0.7773907780647278
Step: 56, Loss: 0.6857891082763672
Step: 57, Loss: 0.646515429019928
Step: 58, Loss: 0.6641687750816345
Step: 59, Loss: 0.8798248767852783
Step: 60, Loss: 0.7853608131408691
Step: 61, Loss: 0.7093436121940613
Step: 62, Loss: 0.7129513025283813
Step: 63, Loss: 0.7643702030181885
Step: 64, Loss: 0.7137895822525024
Step: 65, Loss: 0.6283836960792542
Step: 66, Loss: 0.5530818700790405
Step: 67, Loss: 0.5811300873756409
Step: 68, Loss: 0.6362415552139282
Step: 69, Loss: 0.632016658782959
Step: 70, Loss: 0.5575504302978516
Step: 71, Loss: 0.6546080708503723
Step: 72, Loss: 0.7149900197982788
Step: 73, Loss: 0.5403660535812378
Step: 74, Loss: 0.4436003565788269
Step: 75, Loss: 0.49365007877349854
Step: 76, Loss: 0.5403464436531067
Step: 77, Loss: 0.5722357034683228
Step: 78, Loss: 0.6800926327705383
Step: 79, Loss: 0.35616156458854675
Step: 80, Loss: 0.5836368203163147
Step: 81, Loss: 0.5135493874549866
Step: 82, Loss: 0.5070961117744446
Step: 83, Loss: 0.681392252445221
Step: 84, Loss: 0.5479074120521545
Step: 85, Loss: 0.963386595249176
Step: 86, Loss: 0.7413411736488342
Step: 87, Loss: 0.39003580808639526
Step: 88, Loss: 0.34159302711486816
Step: 89, Loss: 0.517424464225769
Step: 90, Loss: 0.42397645115852356
Step: 91, Loss: 0.6273233890533447
Step: 92, Loss: 0.2931798994541168
Step: 93, Loss: 0.38434287905693054
Step: 94, Loss: 0.3951122760772705
Step: 95, Loss: 0.3739089071750641
Step: 96, Loss: 0.40976759791374207
Step: 97, Loss: 0.3371817469596863
Step: 98, Loss: 0.2323823869228363
Step: 99, Loss: 0.5316821932792664
Step: 100, Loss: 0.47229835391044617
Step: 101, Loss: 0.37196028232574463
Step: 102, Loss: 0.2914698123931885
Step: 103, Loss: 0.2964516580104828
Step: 104, Loss: 0.5225919485092163
Step: 105, Loss: 0.3612740933895111
Step: 106, Loss: 0.22577649354934692
Step: 107, Loss: 0.2580614984035492
Step: 108, Loss: 0.15178300440311432
Step: 109, Loss: 0.21319378912448883
Step: 110, Loss: 0.22124432027339935
Step: 111, Loss: 0.35394373536109924
Step: 112, Loss: 0.2617255449295044
Step: 113, Loss: 0.20981377363204956
Step: 114, Loss: 0.26409775018692017
Step: 115, Loss: 0.3457353413105011
Step: 116, Loss: 0.2487543523311615
Step: 117, Loss: 0.3880475163459778
Step: 118, Loss: 0.1410759687423706
Step: 119, Loss: 0.20307719707489014
Step: 120, Loss: 0.14525748789310455
Step: 121, Loss: 0.17238132655620575
Step: 122, Loss: 0.4514729380607605
Step: 123, Loss: 0.19538596272468567
Step: 124, Loss: 0.13249045610427856
Step: 125, Loss: 0.3673655092716217
Step: 126, Loss: 0.1525617092847824
Step: 127, Loss: 0.29338932037353516
Step: 128, Loss: 0.18720662593841553
Step: 129, Loss: 0.1677556037902832
Step: 130, Loss: 0.2055457979440689
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/009_Oct-21-2024_03:44_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-1/009_Oct-21-2024_03:44_PM/trainval_loss_curves.png
Total Completion Time: 2.08 minutes. (0.03 hours) 
