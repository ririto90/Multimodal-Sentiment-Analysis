Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-2/002_Oct-21-2024_05:41_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f2168a9d580>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 30
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> common_dim: 512
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-10-21/sub-2/002_Oct-21-2024_05:41_PM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/train.tsv: 292.32 seconds (4.87 minutes)
The number of problematic samples: 402
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/val.tsv: 96.86 seconds (1.61 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/test.tsv: 116.98 seconds (1.95 minutes)
The number of problematic samples: 142
Total Training Samples: 19600
Number of Training Samples: 11760
Number of Development Samples: 3920
Number of Test Samples: 3920
Number of unique sentiment classes: 3
Building model
n_trainable_params: 77323267, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.97 seconds (0.03 minutes)
New best dev_f1: 0.230675 (previous best: 0.000000)
loss: 1.094184, dev_acc: 52.91% (0.529082), dev_f1: 23.07% (0.230675), test_acc: 53.78% (0.537755), test_f1: 23.31% (0.233134)
Batch 30 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.335354 (previous best: 0.230675)
loss: 0.880484, dev_acc: 54.59% (0.545918), dev_f1: 33.54% (0.335354), test_acc: 55.43% (0.554337), test_f1: 33.87% (0.338739)
Batch 60 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.373438 (previous best: 0.335354)
loss: 0.904555, dev_acc: 53.72% (0.537245), dev_f1: 37.34% (0.373438), test_acc: 54.26% (0.542602), test_f1: 38.00% (0.379973)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.782108, dev_acc: 54.77% (0.547704), dev_f1: 31.34% (0.313370), test_acc: 55.54% (0.555357), test_f1: 31.80% (0.318021)
Batch 120 completed in 0.59 seconds (0.01 minutes)
loss: 0.912659, dev_acc: 52.35% (0.523469), dev_f1: 36.76% (0.367578), test_acc: 51.40% (0.514031), test_f1: 36.19% (0.361924)
Batch 150 completed in 0.59 seconds (0.01 minutes)
loss: 0.882587, dev_acc: 53.90% (0.539031), dev_f1: 36.48% (0.364846), test_acc: 54.64% (0.546429), test_f1: 37.00% (0.370017)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.809125, dev_acc: 54.80% (0.547959), dev_f1: 30.79% (0.307903), test_acc: 55.20% (0.552041), test_f1: 31.10% (0.311008)
Epoch 0 completed in 295.27 seconds (4.92 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.59 seconds (0.01 minutes)
loss: 0.845642, dev_acc: 55.00% (0.550000), dev_f1: 33.80% (0.338010), test_acc: 55.56% (0.555612), test_f1: 35.12% (0.351210)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.827188, dev_acc: 55.31% (0.553061), dev_f1: 31.83% (0.318342), test_acc: 55.23% (0.552296), test_f1: 31.66% (0.316608)
Batch 60 completed in 0.58 seconds (0.01 minutes)
loss: 0.943311, dev_acc: 56.15% (0.561480), dev_f1: 35.19% (0.351875), test_acc: 56.28% (0.562755), test_f1: 35.84% (0.358360)
Batch 90 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.404294 (previous best: 0.373438)
loss: 0.781222, dev_acc: 51.61% (0.516071), dev_f1: 40.43% (0.404294), test_acc: 51.84% (0.518367), test_f1: 41.81% (0.418050)
Batch 120 completed in 0.59 seconds (0.01 minutes)
loss: 0.854157, dev_acc: 56.86% (0.568622), dev_f1: 39.15% (0.391545), test_acc: 57.81% (0.578061), test_f1: 40.62% (0.406150)
Batch 150 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.409816 (previous best: 0.404294)
loss: 0.785944, dev_acc: 58.78% (0.587755), dev_f1: 40.98% (0.409816), test_acc: 58.14% (0.581378), test_f1: 41.31% (0.413106)
Batch 180 completed in 0.58 seconds (0.01 minutes)
loss: 0.796390, dev_acc: 55.99% (0.559949), dev_f1: 35.26% (0.352600), test_acc: 58.14% (0.581378), test_f1: 38.82% (0.388195)
Epoch 1 completed in 302.29 seconds (5.04 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.58 seconds (0.01 minutes)
loss: 0.712320, dev_acc: 54.87% (0.548724), dev_f1: 31.92% (0.319227), test_acc: 56.76% (0.567602), test_f1: 35.43% (0.354334)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.910611, dev_acc: 57.93% (0.579337), dev_f1: 38.07% (0.380741), test_acc: 58.85% (0.588520), test_f1: 40.98% (0.409845)
Batch 60 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.437909 (previous best: 0.409816)
loss: 0.771142, dev_acc: 58.09% (0.580867), dev_f1: 43.79% (0.437909), test_acc: 58.85% (0.588520), test_f1: 45.54% (0.455370)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.739520, dev_acc: 57.12% (0.571173), dev_f1: 37.48% (0.374783), test_acc: 58.29% (0.582908), test_f1: 39.93% (0.399305)
Batch 120 completed in 0.59 seconds (0.01 minutes)
New best dev_f1: 0.451340 (previous best: 0.437909)
loss: 0.782219, dev_acc: 56.91% (0.569133), dev_f1: 45.13% (0.451340), test_acc: 57.47% (0.574745), test_f1: 47.01% (0.470115)
Batch 150 completed in 0.59 seconds (0.01 minutes)
loss: 0.805592, dev_acc: 58.65% (0.586480), dev_f1: 43.27% (0.432670), test_acc: 59.74% (0.597449), test_f1: 46.50% (0.464995)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.895600, dev_acc: 58.27% (0.582653), dev_f1: 42.54% (0.425415), test_acc: 58.62% (0.586224), test_f1: 45.09% (0.450892)
Epoch 2 completed in 297.22 seconds (4.95 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.59 seconds (0.01 minutes)
loss: 0.606201, dev_acc: 58.62% (0.586224), dev_f1: 40.65% (0.406476), test_acc: 58.90% (0.589031), test_f1: 41.97% (0.419703)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.632993, dev_acc: 57.65% (0.576531), dev_f1: 40.75% (0.407526), test_acc: 59.64% (0.596429), test_f1: 43.03% (0.430327)
Batch 60 completed in 0.59 seconds (0.01 minutes)
loss: 0.756544, dev_acc: 58.01% (0.580102), dev_f1: 45.01% (0.450094), test_acc: 58.70% (0.586990), test_f1: 47.29% (0.472878)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.698842, dev_acc: 57.86% (0.578571), dev_f1: 40.75% (0.407523), test_acc: 58.37% (0.583673), test_f1: 41.72% (0.417244)
Batch 120 completed in 0.58 seconds (0.01 minutes)
loss: 0.736810, dev_acc: 57.22% (0.572194), dev_f1: 41.02% (0.410236), test_acc: 59.74% (0.597449), test_f1: 44.18% (0.441773)
Batch 150 completed in 0.58 seconds (0.01 minutes)
New best dev_f1: 0.471412 (previous best: 0.451340)
loss: 0.717425, dev_acc: 58.09% (0.580867), dev_f1: 47.14% (0.471412), test_acc: 58.52% (0.585204), test_f1: 47.58% (0.475755)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.733972, dev_acc: 58.85% (0.588520), dev_f1: 42.08% (0.420840), test_acc: 59.69% (0.596939), test_f1: 44.67% (0.446682)
Epoch 3 completed in 300.57 seconds (5.01 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.67 seconds (0.01 minutes)
loss: 0.662134, dev_acc: 58.49% (0.584949), dev_f1: 43.18% (0.431765), test_acc: 59.59% (0.595918), test_f1: 44.54% (0.445367)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.702020, dev_acc: 54.44% (0.544388), dev_f1: 44.57% (0.445692), test_acc: 54.36% (0.543622), test_f1: 44.23% (0.442320)
Batch 60 completed in 0.59 seconds (0.01 minutes)
loss: 0.636327, dev_acc: 56.15% (0.561480), dev_f1: 41.15% (0.411496), test_acc: 57.70% (0.577041), test_f1: 43.56% (0.435639)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.688268, dev_acc: 55.28% (0.552806), dev_f1: 44.87% (0.448717), test_acc: 55.77% (0.557653), test_f1: 46.09% (0.460910)
Batch 120 completed in 0.59 seconds (0.01 minutes)
loss: 0.599447, dev_acc: 55.56% (0.555612), dev_f1: 42.86% (0.428644), test_acc: 56.66% (0.566582), test_f1: 44.73% (0.447342)
Batch 150 completed in 0.59 seconds (0.01 minutes)
loss: 0.654755, dev_acc: 58.34% (0.583418), dev_f1: 42.57% (0.425668), test_acc: 59.59% (0.595918), test_f1: 44.60% (0.445959)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.700288, dev_acc: 57.09% (0.570918), dev_f1: 44.09% (0.440920), test_acc: 57.65% (0.576531), test_f1: 45.02% (0.450196)
Epoch 4 completed in 298.41 seconds (4.97 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.59 seconds (0.01 minutes)
loss: 0.692576, dev_acc: 54.03% (0.540306), dev_f1: 45.80% (0.457997), test_acc: 55.28% (0.552806), test_f1: 47.52% (0.475228)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.693550, dev_acc: 53.37% (0.533673), dev_f1: 42.18% (0.421750), test_acc: 55.15% (0.551531), test_f1: 44.31% (0.443130)
Batch 60 completed in 0.59 seconds (0.01 minutes)
loss: 0.662847, dev_acc: 54.34% (0.543367), dev_f1: 40.12% (0.401185), test_acc: 56.91% (0.569133), test_f1: 41.82% (0.418203)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.564199, dev_acc: 56.86% (0.568622), dev_f1: 43.45% (0.434533), test_acc: 58.83% (0.588265), test_f1: 44.86% (0.448644)
Batch 120 completed in 0.59 seconds (0.01 minutes)
loss: 0.682543, dev_acc: 55.00% (0.550000), dev_f1: 44.50% (0.445032), test_acc: 56.76% (0.567602), test_f1: 47.54% (0.475448)
Batch 150 completed in 0.59 seconds (0.01 minutes)
loss: 0.611728, dev_acc: 55.13% (0.551276), dev_f1: 43.14% (0.431403), test_acc: 57.50% (0.575000), test_f1: 46.36% (0.463634)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.644203, dev_acc: 54.21% (0.542092), dev_f1: 46.22% (0.462249), test_acc: 55.10% (0.551020), test_f1: 47.33% (0.473251)
Epoch 5 completed in 297.38 seconds (4.96 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.59 seconds (0.01 minutes)
loss: 0.501206, dev_acc: 56.96% (0.569643), dev_f1: 44.20% (0.442041), test_acc: 58.34% (0.583418), test_f1: 46.28% (0.462845)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.411138, dev_acc: 53.24% (0.532398), dev_f1: 43.54% (0.435413), test_acc: 54.64% (0.546429), test_f1: 45.22% (0.452155)
Batch 60 completed in 0.59 seconds (0.01 minutes)
loss: 0.645355, dev_acc: 55.48% (0.554847), dev_f1: 41.41% (0.414098), test_acc: 58.47% (0.584694), test_f1: 44.69% (0.446930)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.671027, dev_acc: 52.04% (0.520408), dev_f1: 41.37% (0.413668), test_acc: 54.31% (0.543112), test_f1: 43.37% (0.433712)
Batch 120 completed in 0.59 seconds (0.01 minutes)
loss: 0.424648, dev_acc: 54.87% (0.548724), dev_f1: 41.28% (0.412829), test_acc: 57.45% (0.574490), test_f1: 46.18% (0.461841)
Batch 150 completed in 0.59 seconds (0.01 minutes)
loss: 0.467287, dev_acc: 53.93% (0.539286), dev_f1: 42.04% (0.420377), test_acc: 55.26% (0.552551), test_f1: 42.23% (0.422349)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.522249, dev_acc: 53.27% (0.532653), dev_f1: 44.54% (0.445402), test_acc: 54.44% (0.544388), test_f1: 44.85% (0.448482)
Epoch 6 completed in 297.20 seconds (4.95 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.59 seconds (0.01 minutes)
loss: 0.453665, dev_acc: 54.54% (0.545408), dev_f1: 41.33% (0.413270), test_acc: 56.53% (0.565306), test_f1: 43.22% (0.432185)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.480809, dev_acc: 52.22% (0.522194), dev_f1: 43.07% (0.430655), test_acc: 53.88% (0.538776), test_f1: 44.61% (0.446096)
Batch 60 completed in 0.59 seconds (0.01 minutes)
loss: 0.426206, dev_acc: 53.65% (0.536480), dev_f1: 42.13% (0.421347), test_acc: 55.99% (0.559949), test_f1: 44.81% (0.448130)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.570865, dev_acc: 52.68% (0.526786), dev_f1: 42.33% (0.423294), test_acc: 55.03% (0.550255), test_f1: 45.02% (0.450184)
Batch 120 completed in 0.59 seconds (0.01 minutes)
loss: 0.566436, dev_acc: 55.03% (0.550255), dev_f1: 43.73% (0.437271), test_acc: 58.14% (0.581378), test_f1: 47.32% (0.473171)
Batch 150 completed in 0.59 seconds (0.01 minutes)
loss: 0.395483, dev_acc: 53.70% (0.536990), dev_f1: 42.78% (0.427799), test_acc: 55.59% (0.555867), test_f1: 44.69% (0.446921)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.776316, dev_acc: 54.31% (0.543112), dev_f1: 43.80% (0.437987), test_acc: 55.41% (0.554082), test_f1: 43.89% (0.438921)
Epoch 7 completed in 297.35 seconds (4.96 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.59 seconds (0.01 minutes)
loss: 0.406339, dev_acc: 53.55% (0.535459), dev_f1: 45.07% (0.450670), test_acc: 53.16% (0.531633), test_f1: 44.36% (0.443613)
Batch 30 completed in 0.59 seconds (0.01 minutes)
loss: 0.304944, dev_acc: 55.05% (0.550510), dev_f1: 41.12% (0.411219), test_acc: 57.91% (0.579082), test_f1: 43.41% (0.434090)
Batch 60 completed in 0.59 seconds (0.01 minutes)
loss: 0.338433, dev_acc: 52.68% (0.526786), dev_f1: 41.42% (0.414242), test_acc: 55.41% (0.554082), test_f1: 43.43% (0.434319)
Batch 90 completed in 0.59 seconds (0.01 minutes)
loss: 0.494451, dev_acc: 53.21% (0.532143), dev_f1: 41.77% (0.417689), test_acc: 54.69% (0.546939), test_f1: 42.63% (0.426298)
Batch 120 completed in 0.59 seconds (0.01 minutes)
loss: 0.265933, dev_acc: 53.55% (0.535459), dev_f1: 44.00% (0.440019), test_acc: 56.45% (0.564541), test_f1: 46.57% (0.465748)
Batch 150 completed in 0.59 seconds (0.01 minutes)
loss: 0.522245, dev_acc: 51.30% (0.513010), dev_f1: 41.91% (0.419070), test_acc: 52.09% (0.520918), test_f1: 42.38% (0.423820)
Batch 180 completed in 0.59 seconds (0.01 minutes)
loss: 0.317063, dev_acc: 52.50% (0.525000), dev_f1: 41.15% (0.411529), test_acc: 55.69% (0.556888), test_f1: 43.24% (0.432427)
Epoch 8 completed in 296.87 seconds (4.95 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
