SLURM Job ID: 19420534
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-09/sub-3/003_Nov-09-2024_10:31_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts-1000
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f401d48d580>
>>> learning_rate: 0.0003
>>> dropout_rate: 0.1
>>> num_epoch: 10
>>> batch_size: 128
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-09/sub-3/003_Nov-09-2024_10:31_PM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts-1000 dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/train.tsv: 2.99 seconds (0.05 minutes)
The number of problematic samples: 69
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/val.tsv: 0.37 seconds (0.01 minutes)
The number of problematic samples: 10
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-1000/test.tsv: 0.37 seconds (0.01 minutes)
The number of problematic samples: 6
Total Training Samples: 1000
Number of Training Samples: 800
Number of Development Samples: 100
Number of Test Samples: 100
Number of unique sentiment classes: 3
Building model
Using 2 GPUs
n_trainable_params: 360211459, n_nontrainable_params: 0
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 3.88 seconds (0.06 minutes)
New best dev_f1: 0.197183 (previous best: 0.000000)
loss: 1.102138, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 0 completed in 15.51 seconds (0.26 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.52 seconds (0.03 minutes)
loss: 3.193287, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 1 completed in 12.44 seconds (0.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.57 seconds (0.03 minutes)
loss: 3.874054, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 2 completed in 12.32 seconds (0.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.70 seconds (0.03 minutes)
New best dev_f1: 0.222050 (previous best: 0.197183)
loss: 4.228427, dev_acc: 33.00% (0.330000), dev_f1: 22.20% (0.222050), test_acc: 29.00% (0.290000), test_f1: 24.32% (0.243189)
Epoch 3 completed in 12.55 seconds (0.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 1.54 seconds (0.03 minutes)
loss: 1.689761, dev_acc: 19.00% (0.190000), dev_f1: 10.64% (0.106443), test_acc: 23.00% (0.230000), test_f1: 12.47% (0.124661)
Epoch 4 completed in 12.29 seconds (0.20 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 1.55 seconds (0.03 minutes)
loss: 1.208202, dev_acc: 39.00% (0.390000), dev_f1: 18.71% (0.187050), test_acc: 29.00% (0.290000), test_f1: 14.99% (0.149871)
Epoch 5 completed in 12.89 seconds (0.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 1.57 seconds (0.03 minutes)
loss: 1.059796, dev_acc: 42.00% (0.420000), dev_f1: 19.72% (0.197183), test_acc: 48.00% (0.480000), test_f1: 21.62% (0.216216)
Epoch 6 completed in 12.45 seconds (0.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 1.52 seconds (0.03 minutes)
loss: 1.028475, dev_acc: 39.00% (0.390000), dev_f1: 18.98% (0.189781), test_acc: 29.00% (0.290000), test_f1: 15.22% (0.152231)
Epoch 7 completed in 12.31 seconds (0.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 1.52 seconds (0.03 minutes)
New best dev_f1: 0.355489 (previous best: 0.222050)
loss: 1.013382, dev_acc: 45.00% (0.450000), dev_f1: 35.55% (0.355489), test_acc: 29.00% (0.290000), test_f1: 17.38% (0.173789)
Epoch 8 completed in 12.67 seconds (0.21 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 1.52 seconds (0.03 minutes)
loss: 1.765902, dev_acc: 38.00% (0.380000), dev_f1: 18.36% (0.183575), test_acc: 28.00% (0.280000), test_f1: 14.58% (0.145833)
Epoch 9 completed in 12.33 seconds (0.21 minutes)
RESULT: Max Dev F1: 0.355489, Max Test F1: 0.173789
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Step: 1, Loss: 1.1021380424499512
Step: 2, Loss: 1.0896525382995605
Step: 3, Loss: 19.980989456176758
Step: 4, Loss: 1.2169702053070068
Step: 5, Loss: 1.2810802459716797
Step: 6, Loss: 1.1771906614303589
Step: 7, Loss: 9.639986038208008
Step: 8, Loss: 3.1932871341705322
Step: 9, Loss: 1.7185148000717163
Step: 10, Loss: 2.263180732727051
Step: 11, Loss: 2.7189292907714844
Step: 12, Loss: 14.157809257507324
Step: 13, Loss: 4.2640862464904785
Step: 14, Loss: 2.384821891784668
Step: 15, Loss: 3.874054431915283
Step: 16, Loss: 11.47929573059082
Step: 17, Loss: 5.117571830749512
Step: 18, Loss: 6.063357830047607
Step: 19, Loss: 1.853102684020996
Step: 20, Loss: 3.359722375869751
Step: 21, Loss: 5.32878303527832
Step: 22, Loss: 4.228426933288574
Step: 23, Loss: 4.946781158447266
Step: 24, Loss: 5.604698657989502
Step: 25, Loss: 3.7863259315490723
Step: 26, Loss: 2.5543553829193115
Step: 27, Loss: 2.2706613540649414
Step: 28, Loss: 1.4744834899902344
Step: 29, Loss: 1.6897611618041992
Step: 30, Loss: 4.358614444732666
Step: 31, Loss: 1.1490817070007324
Step: 32, Loss: 1.728048324584961
Step: 33, Loss: 1.2488913536071777
Step: 34, Loss: 1.0470120906829834
Step: 35, Loss: 0.9640476107597351
Step: 36, Loss: 1.2082018852233887
Step: 37, Loss: 1.6313109397888184
Step: 38, Loss: 1.0667967796325684
Step: 39, Loss: 0.9600393176078796
Step: 40, Loss: 1.0922502279281616
Step: 41, Loss: 1.142147421836853
Step: 42, Loss: 1.808449625968933
Step: 43, Loss: 1.0597960948944092
Step: 44, Loss: 1.0838137865066528
Step: 45, Loss: 1.002215027809143
Step: 46, Loss: 0.9785233736038208
Step: 47, Loss: 1.3947370052337646
Step: 48, Loss: 1.0370192527770996
Step: 49, Loss: 2.5389394760131836
Step: 50, Loss: 1.0284746885299683
Step: 51, Loss: 1.7000805139541626
Step: 52, Loss: 0.9695031642913818
Step: 53, Loss: 1.2032620906829834
Step: 54, Loss: 2.0470147132873535
Step: 55, Loss: 1.1758705377578735
Step: 56, Loss: 1.137486219406128
Step: 57, Loss: 1.0133823156356812
Step: 58, Loss: 1.3210798501968384
Step: 59, Loss: 1.0324897766113281
Step: 60, Loss: 1.0515332221984863
Step: 61, Loss: 1.244886875152588
Step: 62, Loss: 1.012210488319397
Step: 63, Loss: 0.8341278433799744
Step: 64, Loss: 1.7659021615982056
Step: 65, Loss: 1.6326353549957275
Step: 66, Loss: 0.9688202738761902
Step: 67, Loss: 0.9304226040840149
Step: 68, Loss: 1.050493836402893
Step: 69, Loss: 1.0547773838043213
Step: 70, Loss: 0.8859731554985046
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-09/sub-3/003_Nov-09-2024_10:31_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-09/sub-3/003_Nov-09-2024_10:31_PM/trainval_loss_curves.png
Total Completion Time: 2.45 minutes. (0.04 hours) 
