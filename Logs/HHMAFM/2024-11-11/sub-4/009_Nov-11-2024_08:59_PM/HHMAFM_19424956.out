HHMAFM_mfcchfusion4_mvsa-mts-oversampled_lr0.0005_dr0.5
SLURM Job ID: 19424956
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/009_Nov-11-2024_08:59_PM
> training arguments:
>>> rand_seed: 8
>>> model_fusion: mfcchfusion4
>>> dataset: mvsa-mts-oversampled
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f1c5bc05620>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.5
>>> weight_decay: 0.0
>>> num_epoch: 10
>>> batch_size: 128
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/009_Nov-11-2024_08:59_PM
>>> model_class: <class 'models.mfcchfusion4.MFCCHFUSION4'>
Preparing mvsa-mts-oversampled dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/train.tsv: 371.21 seconds (6.19 minutes)
The number of problematic samples: 900
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/val.tsv: 103.62 seconds (1.73 minutes)
The number of problematic samples: 325
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/test.tsv: 98.00 seconds (1.63 minutes)
The number of problematic samples: 296
Total Training Samples: 36108
Number of Training Samples: 21664
Number of Development Samples: 7222
Number of Test Samples: 7222
Number of unique sentiment classes: 3
Building model
Using 2 GPUs
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 4.31 seconds (0.07 minutes)
New best dev_f1: 0.168600 (previous best: 0.000000)
loss: 1.265575, dev_acc: 33.52% (0.335226), dev_f1: 16.86% (0.168600), test_acc: 34.34% (0.343395), test_f1: 17.04% (0.170412)
Batch 60 completed in 1.94 seconds (0.03 minutes)
New best dev_f1: 0.211254 (previous best: 0.168600)
loss: 2.459768, dev_acc: 34.44% (0.344364), dev_f1: 21.13% (0.211254), test_acc: 34.99% (0.349903), test_f1: 21.69% (0.216875)
Batch 120 completed in 1.52 seconds (0.03 minutes)
New best dev_f1: 0.450128 (previous best: 0.211254)
loss: 1.059789, dev_acc: 52.89% (0.528939), dev_f1: 45.01% (0.450128), test_acc: 52.19% (0.521878), test_f1: 44.57% (0.445729)
Epoch 0 completed in 559.09 seconds (9.32 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.52 seconds (0.03 minutes)
New best dev_f1: 0.493038 (previous best: 0.450128)
loss: 0.923634, dev_acc: 50.42% (0.504154), dev_f1: 49.30% (0.493038), test_acc: 50.10% (0.500969), test_f1: 48.70% (0.487016)
Batch 60 completed in 1.53 seconds (0.03 minutes)
New best dev_f1: 0.526347 (previous best: 0.493038)
loss: 0.752953, dev_acc: 52.56% (0.525616), dev_f1: 52.63% (0.526347), test_acc: 52.56% (0.525616), test_f1: 52.55% (0.525456)
Batch 120 completed in 1.53 seconds (0.03 minutes)
New best dev_f1: 0.566983 (previous best: 0.526347)
loss: 0.902345, dev_acc: 57.80% (0.577956), dev_f1: 56.70% (0.566983), test_acc: 56.49% (0.564940), test_f1: 55.43% (0.554259)
Epoch 1 completed in 570.60 seconds (9.51 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.53 seconds (0.03 minutes)
loss: 0.950235, dev_acc: 57.32% (0.573248), dev_f1: 55.84% (0.558365), test_acc: 56.00% (0.559956), test_f1: 54.50% (0.545031)
Batch 60 completed in 1.52 seconds (0.03 minutes)
loss: 0.876145, dev_acc: 57.38% (0.573802), dev_f1: 56.56% (0.565588), test_acc: 57.20% (0.572002), test_f1: 56.42% (0.564182)
Batch 120 completed in 1.53 seconds (0.03 minutes)
New best dev_f1: 0.581559 (previous best: 0.566983)
loss: 0.865035, dev_acc: 58.71% (0.587095), dev_f1: 58.16% (0.581559), test_acc: 57.91% (0.579064), test_f1: 57.40% (0.573954)
Epoch 2 completed in 570.67 seconds (9.51 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.52 seconds (0.03 minutes)
loss: 0.848184, dev_acc: 57.99% (0.579895), dev_f1: 56.85% (0.568534), test_acc: 57.74% (0.577402), test_f1: 56.63% (0.566278)
Batch 60 completed in 1.53 seconds (0.03 minutes)
loss: 0.821247, dev_acc: 58.93% (0.589310), dev_f1: 58.09% (0.580874), test_acc: 58.67% (0.586680), test_f1: 57.81% (0.578115)
Batch 120 completed in 1.52 seconds (0.03 minutes)
New best dev_f1: 0.588729 (previous best: 0.581559)
loss: 0.856564, dev_acc: 60.12% (0.601218), dev_f1: 58.87% (0.588729), test_acc: 59.44% (0.594434), test_f1: 58.26% (0.582642)
Epoch 3 completed in 571.70 seconds (9.53 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 1.51 seconds (0.03 minutes)
New best dev_f1: 0.591880 (previous best: 0.588729)
loss: 0.990607, dev_acc: 59.29% (0.592911), dev_f1: 59.19% (0.591880), test_acc: 57.99% (0.579895), test_f1: 57.93% (0.579265)
Batch 60 completed in 1.52 seconds (0.03 minutes)
loss: 0.973537, dev_acc: 58.81% (0.588064), dev_f1: 59.01% (0.590104), test_acc: 57.92% (0.579202), test_f1: 58.11% (0.581133)
Batch 120 completed in 1.53 seconds (0.03 minutes)
loss: 0.687197, dev_acc: 60.20% (0.602049), dev_f1: 58.79% (0.587898), test_acc: 58.56% (0.585572), test_f1: 57.02% (0.570241)
Epoch 4 completed in 570.19 seconds (9.50 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 1.51 seconds (0.03 minutes)
loss: 1.023400, dev_acc: 58.39% (0.583910), dev_f1: 57.69% (0.576929), test_acc: 57.62% (0.576156), test_f1: 57.03% (0.570340)
Batch 60 completed in 1.53 seconds (0.03 minutes)
loss: 0.751118, dev_acc: 58.96% (0.589587), dev_f1: 58.08% (0.580804), test_acc: 58.25% (0.582526), test_f1: 57.34% (0.573439)
Batch 120 completed in 1.53 seconds (0.03 minutes)
New best dev_f1: 0.600489 (previous best: 0.591880)
loss: 0.845818, dev_acc: 60.32% (0.603157), dev_f1: 60.05% (0.600489), test_acc: 59.91% (0.599142), test_f1: 59.64% (0.596351)
Epoch 5 completed in 570.11 seconds (9.50 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 1.52 seconds (0.03 minutes)
loss: 0.953409, dev_acc: 52.69% (0.526862), dev_f1: 48.09% (0.480938), test_acc: 53.09% (0.530878), test_f1: 48.63% (0.486299)
Batch 60 completed in 1.53 seconds (0.03 minutes)
loss: 0.792397, dev_acc: 59.94% (0.599418), dev_f1: 58.79% (0.587935), test_acc: 58.90% (0.589034), test_f1: 57.77% (0.577706)
Batch 120 completed in 1.53 seconds (0.03 minutes)
New best dev_f1: 0.600491 (previous best: 0.600489)
loss: 0.889089, dev_acc: 60.47% (0.604680), dev_f1: 60.05% (0.600491), test_acc: 60.43% (0.604265), test_f1: 59.96% (0.599619)
Epoch 6 completed in 570.31 seconds (9.51 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 1.95 seconds (0.03 minutes)
loss: 0.748245, dev_acc: 58.79% (0.587926), dev_f1: 56.33% (0.563322), test_acc: 58.20% (0.581972), test_f1: 55.76% (0.557641)
Batch 60 completed in 1.48 seconds (0.02 minutes)
loss: 0.883001, dev_acc: 56.81% (0.568125), dev_f1: 54.82% (0.548244), test_acc: 55.87% (0.558709), test_f1: 53.89% (0.538917)
Batch 120 completed in 1.93 seconds (0.03 minutes)
loss: 0.729897, dev_acc: 55.65% (0.556494), dev_f1: 55.42% (0.554187), test_acc: 54.83% (0.548325), test_f1: 54.67% (0.546725)
Epoch 7 completed in 571.56 seconds (9.53 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 1.52 seconds (0.03 minutes)
loss: 0.767146, dev_acc: 60.63% (0.606342), dev_f1: 58.97% (0.589678), test_acc: 59.61% (0.596095), test_f1: 57.94% (0.579402)
Batch 60 completed in 1.53 seconds (0.03 minutes)
loss: 0.817507, dev_acc: 59.43% (0.594295), dev_f1: 59.67% (0.596665), test_acc: 59.25% (0.592495), test_f1: 59.47% (0.594742)
Batch 120 completed in 1.95 seconds (0.03 minutes)
loss: 0.753692, dev_acc: 58.52% (0.585156), dev_f1: 57.19% (0.571914), test_acc: 59.15% (0.591526), test_f1: 57.86% (0.578564)
Epoch 8 completed in 571.04 seconds (9.52 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 1.57 seconds (0.03 minutes)
loss: 0.873433, dev_acc: 58.61% (0.586126), dev_f1: 58.00% (0.580012), test_acc: 58.43% (0.584326), test_f1: 57.83% (0.578311)
Batch 60 completed in 1.52 seconds (0.03 minutes)
loss: 0.852983, dev_acc: 59.24% (0.592357), dev_f1: 58.25% (0.582478), test_acc: 59.39% (0.593880), test_f1: 58.46% (0.584562)
Batch 120 completed in 1.52 seconds (0.03 minutes)
loss: 0.887336, dev_acc: 59.87% (0.598726), dev_f1: 57.65% (0.576474), test_acc: 59.40% (0.594018), test_f1: 57.21% (0.572088)
Epoch 9 completed in 570.39 seconds (9.51 minutes)
RESULT: Max Dev F1: 0.600491, Max Test F1: 0.599619
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/009_Nov-11-2024_08:59_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/009_Nov-11-2024_08:59_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/009_Nov-11-2024_08:59_PM/trainval_loss_curves.png
Total Completion Time: 105.93 minutes. (1.77 hours) 
