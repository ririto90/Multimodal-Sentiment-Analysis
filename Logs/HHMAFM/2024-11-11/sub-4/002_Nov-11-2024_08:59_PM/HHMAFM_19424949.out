HHMAFM_mfcchfusion4_mvsa-mts-oversampled_lr0.0003_dr0.1
SLURM Job ID: 19424949
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/002_Nov-11-2024_08:59_PM
> training arguments:
>>> rand_seed: 8
>>> model_fusion: mfcchfusion4
>>> dataset: mvsa-mts-oversampled
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fade69f9620>
>>> learning_rate: 0.0003
>>> dropout_rate: 0.1
>>> weight_decay: 0.0
>>> num_epoch: 10
>>> batch_size: 128
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/002_Nov-11-2024_08:59_PM
>>> model_class: <class 'models.mfcchfusion4.MFCCHFUSION4'>
Preparing mvsa-mts-oversampled dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/train.tsv: 389.26 seconds (6.49 minutes)
The number of problematic samples: 900
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/val.tsv: 90.77 seconds (1.51 minutes)
The number of problematic samples: 325
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/test.tsv: 88.30 seconds (1.47 minutes)
The number of problematic samples: 296
Total Training Samples: 36108
Number of Training Samples: 21664
Number of Development Samples: 7222
Number of Test Samples: 7222
Number of unique sentiment classes: 3
Building model
Using 2 GPUs
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 4.41 seconds (0.07 minutes)
New best dev_f1: 0.168459 (previous best: 0.000000)
loss: 1.286494, dev_acc: 33.48% (0.334810), dev_f1: 16.85% (0.168459), test_acc: 34.33% (0.343257), test_f1: 17.04% (0.170378)
Batch 60 completed in 1.93 seconds (0.03 minutes)
New best dev_f1: 0.429250 (previous best: 0.168459)
loss: 1.198219, dev_acc: 46.62% (0.466214), dev_f1: 42.93% (0.429250), test_acc: 45.51% (0.455137), test_f1: 42.01% (0.420103)
Batch 120 completed in 1.97 seconds (0.03 minutes)
New best dev_f1: 0.520465 (previous best: 0.429250)
loss: 1.020005, dev_acc: 52.87% (0.528662), dev_f1: 52.05% (0.520465), test_acc: 51.48% (0.514816), test_f1: 50.69% (0.506851)
Epoch 0 completed in 569.86 seconds (9.50 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.52 seconds (0.03 minutes)
New best dev_f1: 0.541652 (previous best: 0.520465)
loss: 1.038790, dev_acc: 54.65% (0.546525), dev_f1: 54.17% (0.541652), test_acc: 53.38% (0.533786), test_f1: 52.83% (0.528295)
Batch 60 completed in 1.53 seconds (0.03 minutes)
loss: 0.936894, dev_acc: 52.37% (0.523678), dev_f1: 49.11% (0.491086), test_acc: 52.51% (0.525062), test_f1: 49.15% (0.491496)
Batch 120 completed in 1.51 seconds (0.03 minutes)
loss: 0.960644, dev_acc: 51.48% (0.514816), dev_f1: 50.56% (0.505622), test_acc: 50.15% (0.501523), test_f1: 49.10% (0.490981)
Epoch 1 completed in 579.71 seconds (9.66 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.54 seconds (0.03 minutes)
loss: 1.380180, dev_acc: 53.66% (0.536555), dev_f1: 51.70% (0.516974), test_acc: 53.79% (0.537940), test_f1: 51.77% (0.517656)
Batch 60 completed in 1.55 seconds (0.03 minutes)
New best dev_f1: 0.560165 (previous best: 0.541652)
loss: 0.928207, dev_acc: 56.27% (0.562725), dev_f1: 56.02% (0.560165), test_acc: 55.69% (0.556909), test_f1: 55.48% (0.554762)
Batch 120 completed in 1.51 seconds (0.03 minutes)
loss: 1.358822, dev_acc: 53.99% (0.539878), dev_f1: 47.82% (0.478217), test_acc: 52.98% (0.529770), test_f1: 46.77% (0.467739)
Epoch 2 completed in 580.13 seconds (9.67 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.54 seconds (0.03 minutes)
loss: 0.998589, dev_acc: 54.26% (0.542647), dev_f1: 52.62% (0.526151), test_acc: 54.33% (0.543340), test_f1: 52.76% (0.527618)
Batch 60 completed in 1.51 seconds (0.03 minutes)
loss: 0.846224, dev_acc: 55.34% (0.553448), dev_f1: 50.64% (0.506364), test_acc: 54.86% (0.548601), test_f1: 50.37% (0.503727)
Batch 120 completed in 1.56 seconds (0.03 minutes)
loss: 0.854424, dev_acc: 57.37% (0.573664), dev_f1: 55.76% (0.557626), test_acc: 56.76% (0.567571), test_f1: 55.30% (0.553023)
Epoch 3 completed in 581.55 seconds (9.69 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 1.52 seconds (0.03 minutes)
loss: 1.130621, dev_acc: 52.17% (0.521739), dev_f1: 49.68% (0.496827), test_acc: 51.95% (0.519524), test_f1: 49.22% (0.492236)
Batch 60 completed in 1.54 seconds (0.03 minutes)
New best dev_f1: 0.574019 (previous best: 0.560165)
loss: 0.955741, dev_acc: 58.56% (0.585572), dev_f1: 57.40% (0.574019), test_acc: 57.57% (0.575741), test_f1: 56.45% (0.564473)
Batch 120 completed in 1.51 seconds (0.03 minutes)
New best dev_f1: 0.587112 (previous best: 0.574019)
loss: 0.742439, dev_acc: 59.51% (0.595126), dev_f1: 58.71% (0.587112), test_acc: 58.65% (0.586541), test_f1: 57.87% (0.578746)
Epoch 4 completed in 581.43 seconds (9.69 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 1.51 seconds (0.03 minutes)
loss: 0.969491, dev_acc: 56.36% (0.563556), dev_f1: 53.66% (0.536570), test_acc: 55.39% (0.553863), test_f1: 52.55% (0.525490)
Batch 60 completed in 1.56 seconds (0.03 minutes)
New best dev_f1: 0.594655 (previous best: 0.587112)
loss: 0.699959, dev_acc: 60.07% (0.600665), dev_f1: 59.47% (0.594655), test_acc: 59.54% (0.595403), test_f1: 58.86% (0.588572)
Batch 120 completed in 1.56 seconds (0.03 minutes)
New best dev_f1: 0.610054 (previous best: 0.594655)
loss: 0.825703, dev_acc: 61.16% (0.611603), dev_f1: 61.01% (0.610054), test_acc: 60.32% (0.603157), test_f1: 60.17% (0.601719)
Epoch 5 completed in 580.55 seconds (9.68 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 1.55 seconds (0.03 minutes)
loss: 0.735173, dev_acc: 60.19% (0.601911), dev_f1: 58.98% (0.589790), test_acc: 59.25% (0.592495), test_f1: 58.07% (0.580745)
Batch 60 completed in 1.54 seconds (0.03 minutes)
loss: 0.786746, dev_acc: 60.15% (0.601495), dev_f1: 58.62% (0.586213), test_acc: 58.78% (0.587787), test_f1: 57.20% (0.571952)
Batch 120 completed in 1.51 seconds (0.03 minutes)
loss: 0.799853, dev_acc: 60.68% (0.606757), dev_f1: 60.01% (0.600110), test_acc: 60.22% (0.602188), test_f1: 59.54% (0.595408)
Epoch 6 completed in 579.09 seconds (9.65 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 1.51 seconds (0.03 minutes)
loss: 0.713787, dev_acc: 60.62% (0.606203), dev_f1: 59.09% (0.590921), test_acc: 59.25% (0.592495), test_f1: 57.78% (0.577802)
Batch 60 completed in 1.55 seconds (0.03 minutes)
loss: 0.833365, dev_acc: 58.45% (0.584464), dev_f1: 58.28% (0.582803), test_acc: 58.06% (0.580587), test_f1: 57.95% (0.579514)
Batch 120 completed in 1.54 seconds (0.03 minutes)
loss: 0.748165, dev_acc: 57.78% (0.577818), dev_f1: 57.77% (0.577691), test_acc: 57.09% (0.570894), test_f1: 57.10% (0.570957)
Epoch 7 completed in 581.47 seconds (9.69 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 1.54 seconds (0.03 minutes)
loss: 0.803234, dev_acc: 60.02% (0.600249), dev_f1: 59.05% (0.590507), test_acc: 60.01% (0.600111), test_f1: 59.17% (0.591711)
Batch 60 completed in 1.55 seconds (0.03 minutes)
loss: 0.818814, dev_acc: 57.38% (0.573802), dev_f1: 56.61% (0.566126), test_acc: 56.42% (0.564248), test_f1: 55.70% (0.556979)
Batch 120 completed in 1.56 seconds (0.03 minutes)
loss: 0.726828, dev_acc: 60.80% (0.608003), dev_f1: 59.96% (0.599571), test_acc: 60.98% (0.609803), test_f1: 60.17% (0.601653)
Epoch 8 completed in 580.65 seconds (9.68 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 1.51 seconds (0.03 minutes)
loss: 0.753408, dev_acc: 60.01% (0.600111), dev_f1: 59.27% (0.592739), test_acc: 59.47% (0.594711), test_f1: 58.76% (0.587613)
Batch 60 completed in 1.55 seconds (0.03 minutes)
loss: 0.758852, dev_acc: 59.91% (0.599142), dev_f1: 60.23% (0.602349), test_acc: 58.93% (0.589310), test_f1: 59.22% (0.592236)
Batch 120 completed in 1.51 seconds (0.03 minutes)
loss: 0.993019, dev_acc: 60.05% (0.600526), dev_f1: 60.39% (0.603853), test_acc: 59.43% (0.594295), test_f1: 59.78% (0.597792)
Epoch 9 completed in 580.02 seconds (9.67 minutes)
RESULT: Max Dev F1: 0.610054, Max Test F1: 0.601719
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/002_Nov-11-2024_08:59_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/002_Nov-11-2024_08:59_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/002_Nov-11-2024_08:59_PM/trainval_loss_curves.png
Total Completion Time: 107.30 minutes. (1.79 hours) 
