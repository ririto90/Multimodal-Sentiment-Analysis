HHMAFM_mfcchfusion4_mvsa-mts-oversampled_lr0.0003_dr0.2
SLURM Job ID: 19424952
Number of GPUs available: 2
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/005_Nov-11-2024_08:59_PM
> training arguments:
>>> rand_seed: 8
>>> model_fusion: mfcchfusion4
>>> dataset: mvsa-mts-oversampled
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f5acd625620>
>>> learning_rate: 0.0003
>>> dropout_rate: 0.2
>>> weight_decay: 0.0
>>> num_epoch: 10
>>> batch_size: 128
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/005_Nov-11-2024_08:59_PM
>>> model_class: <class 'models.mfcchfusion4.MFCCHFUSION4'>
Preparing mvsa-mts-oversampled dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/train.tsv: 389.26 seconds (6.49 minutes)
The number of problematic samples: 900
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/val.tsv: 90.78 seconds (1.51 minutes)
The number of problematic samples: 325
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-oversampled/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-oversampled/test.tsv: 88.30 seconds (1.47 minutes)
The number of problematic samples: 296
Total Training Samples: 36108
Number of Training Samples: 21664
Number of Development Samples: 7222
Number of Test Samples: 7222
Number of unique sentiment classes: 3
Building model
Using 2 GPUs
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 4.30 seconds (0.07 minutes)
New best dev_f1: 0.168304 (previous best: 0.000000)
loss: 1.286896, dev_acc: 33.51% (0.335087), dev_f1: 16.83% (0.168304), test_acc: 34.34% (0.343395), test_f1: 17.04% (0.170412)
Batch 60 completed in 1.91 seconds (0.03 minutes)
New best dev_f1: 0.439412 (previous best: 0.168304)
loss: 1.567409, dev_acc: 46.37% (0.463722), dev_f1: 43.94% (0.439412), test_acc: 46.01% (0.460122), test_f1: 43.45% (0.434482)
Batch 120 completed in 1.51 seconds (0.03 minutes)
New best dev_f1: 0.523553 (previous best: 0.439412)
loss: 1.005430, dev_acc: 54.65% (0.546525), dev_f1: 52.36% (0.523553), test_acc: 53.93% (0.539324), test_f1: 51.59% (0.515850)
Epoch 0 completed in 568.30 seconds (9.47 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 1.51 seconds (0.03 minutes)
loss: 1.003791, dev_acc: 46.88% (0.468845), dev_f1: 44.80% (0.447951), test_acc: 46.44% (0.464414), test_f1: 44.50% (0.445045)
Batch 60 completed in 1.53 seconds (0.03 minutes)
loss: 1.286981, dev_acc: 46.77% (0.467737), dev_f1: 43.71% (0.437080), test_acc: 46.11% (0.461091), test_f1: 43.11% (0.431065)
Batch 120 completed in 1.55 seconds (0.03 minutes)
New best dev_f1: 0.547456 (previous best: 0.523553)
loss: 1.063282, dev_acc: 56.34% (0.563417), dev_f1: 54.75% (0.547456), test_acc: 55.40% (0.554002), test_f1: 53.76% (0.537551)
Epoch 1 completed in 580.53 seconds (9.68 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 1.54 seconds (0.03 minutes)
loss: 1.108364, dev_acc: 54.22% (0.542232), dev_f1: 51.99% (0.519932), test_acc: 53.93% (0.539324), test_f1: 51.56% (0.515614)
Batch 60 completed in 1.51 seconds (0.03 minutes)
loss: 0.998758, dev_acc: 50.86% (0.508585), dev_f1: 45.07% (0.450682), test_acc: 49.83% (0.498338), test_f1: 44.38% (0.443768)
Batch 120 completed in 1.51 seconds (0.03 minutes)
loss: 0.955464, dev_acc: 52.81% (0.528109), dev_f1: 50.54% (0.505423), test_acc: 52.17% (0.521739), test_f1: 49.56% (0.495642)
Epoch 2 completed in 579.81 seconds (9.66 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 1.56 seconds (0.03 minutes)
loss: 1.088448, dev_acc: 52.77% (0.527693), dev_f1: 52.81% (0.528052), test_acc: 52.33% (0.523262), test_f1: 52.33% (0.523256)
Batch 60 completed in 1.51 seconds (0.03 minutes)
loss: 0.926928, dev_acc: 49.27% (0.492661), dev_f1: 43.82% (0.438217), test_acc: 50.11% (0.501108), test_f1: 44.90% (0.448951)
Batch 120 completed in 1.50 seconds (0.03 minutes)
loss: 0.832025, dev_acc: 55.54% (0.555386), dev_f1: 52.88% (0.528771), test_acc: 54.64% (0.546386), test_f1: 51.93% (0.519344)
Epoch 3 completed in 579.80 seconds (9.66 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 1.57 seconds (0.03 minutes)
New best dev_f1: 0.554277 (previous best: 0.547456)
loss: 0.967689, dev_acc: 55.08% (0.550817), dev_f1: 55.43% (0.554277), test_acc: 54.76% (0.547632), test_f1: 55.15% (0.551525)
Batch 60 completed in 2.06 seconds (0.03 minutes)
loss: 0.933440, dev_acc: 53.52% (0.535170), dev_f1: 53.46% (0.534597), test_acc: 52.92% (0.529216), test_f1: 52.86% (0.528600)
Batch 120 completed in 1.54 seconds (0.03 minutes)
loss: 0.862639, dev_acc: 57.75% (0.577541), dev_f1: 54.87% (0.548679), test_acc: 57.45% (0.574495), test_f1: 54.90% (0.549035)
Epoch 4 completed in 579.71 seconds (9.66 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 1.51 seconds (0.03 minutes)
New best dev_f1: 0.576377 (previous best: 0.554277)
loss: 0.924754, dev_acc: 57.16% (0.571587), dev_f1: 57.64% (0.576377), test_acc: 57.59% (0.575879), test_f1: 58.05% (0.580493)
Batch 60 completed in 1.51 seconds (0.03 minutes)
loss: 0.721730, dev_acc: 58.76% (0.587649), dev_f1: 57.35% (0.573528), test_acc: 57.91% (0.579064), test_f1: 56.47% (0.564707)
Batch 120 completed in 1.51 seconds (0.03 minutes)
New best dev_f1: 0.607904 (previous best: 0.576377)
loss: 0.849443, dev_acc: 60.88% (0.608834), dev_f1: 60.79% (0.607904), test_acc: 59.82% (0.598172), test_f1: 59.73% (0.597315)
Epoch 5 completed in 579.39 seconds (9.66 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 1.54 seconds (0.03 minutes)
loss: 0.729491, dev_acc: 60.59% (0.605926), dev_f1: 59.60% (0.596003), test_acc: 59.57% (0.595680), test_f1: 58.56% (0.585594)
Batch 60 completed in 1.54 seconds (0.03 minutes)
loss: 0.785511, dev_acc: 59.65% (0.596511), dev_f1: 58.12% (0.581206), test_acc: 58.49% (0.584880), test_f1: 56.93% (0.569259)
Batch 120 completed in 1.56 seconds (0.03 minutes)
loss: 0.786865, dev_acc: 61.05% (0.610496), dev_f1: 60.43% (0.604300), test_acc: 60.54% (0.605372), test_f1: 59.94% (0.599392)
Epoch 6 completed in 579.60 seconds (9.66 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 1.51 seconds (0.03 minutes)
loss: 0.697263, dev_acc: 60.63% (0.606342), dev_f1: 59.04% (0.590444), test_acc: 59.86% (0.598588), test_f1: 58.33% (0.583336)
Batch 60 completed in 1.51 seconds (0.03 minutes)
loss: 0.780868, dev_acc: 59.89% (0.598865), dev_f1: 58.27% (0.582729), test_acc: 58.64% (0.586403), test_f1: 57.03% (0.570331)
Batch 120 completed in 1.50 seconds (0.03 minutes)
loss: 0.764185, dev_acc: 57.24% (0.572418), dev_f1: 57.12% (0.571179), test_acc: 56.54% (0.565356), test_f1: 56.46% (0.564552)
Epoch 7 completed in 579.21 seconds (9.65 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 1.50 seconds (0.03 minutes)
loss: 0.771639, dev_acc: 59.75% (0.597480), dev_f1: 58.66% (0.586637), test_acc: 59.69% (0.596926), test_f1: 58.73% (0.587310)
Batch 60 completed in 1.53 seconds (0.03 minutes)
loss: 0.812137, dev_acc: 58.65% (0.586541), dev_f1: 58.92% (0.589159), test_acc: 57.73% (0.577264), test_f1: 57.96% (0.579613)
Batch 120 completed in 1.51 seconds (0.03 minutes)
loss: 0.802798, dev_acc: 58.70% (0.586957), dev_f1: 59.17% (0.591711), test_acc: 59.54% (0.595403), test_f1: 59.94% (0.599404)
Epoch 8 completed in 578.28 seconds (9.64 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 1.54 seconds (0.03 minutes)
loss: 0.760084, dev_acc: 60.88% (0.608834), dev_f1: 60.43% (0.604309), test_acc: 60.12% (0.601218), test_f1: 59.71% (0.597128)
Batch 60 completed in 1.51 seconds (0.03 minutes)
loss: 0.739071, dev_acc: 58.79% (0.587926), dev_f1: 59.19% (0.591911), test_acc: 59.28% (0.592772), test_f1: 59.63% (0.596280)
Batch 120 completed in 1.51 seconds (0.03 minutes)
loss: 0.964935, dev_acc: 60.73% (0.607311), dev_f1: 59.75% (0.597468), test_acc: 60.30% (0.603019), test_f1: 59.42% (0.594232)
Epoch 9 completed in 579.96 seconds (9.67 minutes)
RESULT: Max Dev F1: 0.607904, Max Test F1: 0.597315
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/005_Nov-11-2024_08:59_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/005_Nov-11-2024_08:59_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-4/005_Nov-11-2024_08:59_PM/trainval_loss_curves.png
Total Completion Time: 107.15 minutes. (1.79 hours) 
