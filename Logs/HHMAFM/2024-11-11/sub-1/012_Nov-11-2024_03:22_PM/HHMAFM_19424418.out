SLURM Job ID: 19424418
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/012_Nov-11-2024_03:22_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion3
>>> dataset: mvsa-mts-balanced
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f4e00dd9620>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.5
>>> weight_decay: 0.0
>>> num_epoch: 15
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/012_Nov-11-2024_03:22_PM
>>> model_class: <class 'models.mfcchfusion3.MFCCHFUSION3'>
Preparing mvsa-mts-balanced dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-balanced/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-balanced/train.tsv: 38.35 seconds (0.64 minutes)
The number of problematic samples: 454
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-balanced/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-balanced/val.tsv: 12.65 seconds (0.21 minutes)
The number of problematic samples: 135
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-balanced/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-balanced/test.tsv: 12.84 seconds (0.21 minutes)
The number of problematic samples: 155
Total Training Samples: 16752
Number of Training Samples: 10050
Number of Development Samples: 3351
Number of Test Samples: 3351
Number of unique sentiment classes: 3
Building model
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.49 seconds (0.02 minutes)
New best dev_f1: 0.170112 (previous best: 0.000000)
loss: 1.122226, dev_acc: 34.26% (0.342584), dev_f1: 17.01% (0.170112), test_acc: 33.45% (0.334527), test_f1: 16.71% (0.167114)
Batch 60 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.275502 (previous best: 0.170112)
loss: 2.444727, dev_acc: 34.86% (0.348553), dev_f1: 27.55% (0.275502), test_acc: 36.32% (0.363175), test_f1: 28.55% (0.285461)
Batch 120 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.306705 (previous best: 0.275502)
loss: 1.118238, dev_acc: 39.93% (0.399284), dev_f1: 30.67% (0.306705), test_acc: 40.94% (0.409430), test_f1: 32.10% (0.320993)
Epoch 0 completed in 170.12 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.441315 (previous best: 0.306705)
loss: 1.255665, dev_acc: 49.87% (0.498657), dev_f1: 44.13% (0.441315), test_acc: 47.09% (0.470904), test_f1: 41.62% (0.416155)
Batch 60 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.492673 (previous best: 0.441315)
loss: 0.801730, dev_acc: 51.09% (0.510892), dev_f1: 49.27% (0.492673), test_acc: 50.58% (0.505819), test_f1: 48.91% (0.489054)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 1.019793, dev_acc: 50.13% (0.501343), dev_f1: 48.56% (0.485640), test_acc: 49.84% (0.498359), test_f1: 48.13% (0.481263)
Epoch 1 completed in 171.78 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.501499 (previous best: 0.492673)
loss: 0.971811, dev_acc: 51.66% (0.516562), dev_f1: 50.15% (0.501499), test_acc: 49.96% (0.499552), test_f1: 48.70% (0.486994)
Batch 60 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.540023 (previous best: 0.501499)
loss: 0.950203, dev_acc: 54.31% (0.543121), dev_f1: 54.00% (0.540023), test_acc: 52.82% (0.528201), test_f1: 52.35% (0.523521)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.788574, dev_acc: 53.39% (0.533870), dev_f1: 53.50% (0.535018), test_acc: 52.40% (0.524023), test_f1: 52.58% (0.525757)
Epoch 2 completed in 171.54 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.542859 (previous best: 0.540023)
loss: 1.028776, dev_acc: 56.22% (0.562220), dev_f1: 54.29% (0.542859), test_acc: 54.22% (0.542226), test_f1: 52.32% (0.523198)
Batch 60 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.568689 (previous best: 0.542859)
loss: 0.950563, dev_acc: 56.85% (0.568487), dev_f1: 56.87% (0.568689), test_acc: 55.30% (0.552969), test_f1: 55.27% (0.552677)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.803811, dev_acc: 55.18% (0.551776), dev_f1: 54.35% (0.543473), test_acc: 53.51% (0.535064), test_f1: 52.62% (0.526228)
Epoch 3 completed in 171.68 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.958234, dev_acc: 53.66% (0.536556), dev_f1: 50.71% (0.507132), test_acc: 52.43% (0.524321), test_f1: 49.36% (0.493624)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.910168, dev_acc: 57.39% (0.573859), dev_f1: 55.42% (0.554209), test_acc: 56.28% (0.562817), test_f1: 54.57% (0.545668)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.765173, dev_acc: 58.10% (0.581021), dev_f1: 56.71% (0.567103), test_acc: 56.37% (0.563712), test_f1: 55.04% (0.550384)
Epoch 4 completed in 172.05 seconds (2.87 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.965961, dev_acc: 53.24% (0.532378), dev_f1: 50.16% (0.501555), test_acc: 51.63% (0.516264), test_f1: 47.98% (0.479809)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.821384, dev_acc: 51.72% (0.517159), dev_f1: 48.28% (0.482788), test_acc: 51.72% (0.517159), test_f1: 47.86% (0.478627)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 1.000968, dev_acc: 46.76% (0.467622), dev_f1: 44.14% (0.441378), test_acc: 45.42% (0.454193), test_f1: 42.84% (0.428415)
Epoch 5 completed in 171.82 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 1.018436, dev_acc: 51.00% (0.509997), dev_f1: 50.65% (0.506469), test_acc: 50.79% (0.507908), test_f1: 50.04% (0.500379)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.871468, dev_acc: 55.77% (0.557744), dev_f1: 53.33% (0.533316), test_acc: 54.34% (0.543420), test_f1: 52.38% (0.523831)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.820205, dev_acc: 55.24% (0.552372), dev_f1: 54.98% (0.549787), test_acc: 55.33% (0.553268), test_f1: 55.29% (0.552926)
Epoch 6 completed in 171.25 seconds (2.85 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.787338, dev_acc: 52.13% (0.521337), dev_f1: 52.30% (0.523029), test_acc: 51.48% (0.514772), test_f1: 51.71% (0.517097)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.953792, dev_acc: 55.66% (0.556550), dev_f1: 52.88% (0.528763), test_acc: 54.91% (0.549090), test_f1: 52.31% (0.523075)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.687328, dev_acc: 56.25% (0.562519), dev_f1: 54.60% (0.546013), test_acc: 54.22% (0.542226), test_f1: 52.35% (0.523453)
Epoch 7 completed in 171.36 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.905472, dev_acc: 54.34% (0.543420), dev_f1: 54.45% (0.544468), test_acc: 53.39% (0.533870), test_f1: 53.48% (0.534756)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.779378, dev_acc: 58.16% (0.581617), dev_f1: 56.81% (0.568141), test_acc: 55.57% (0.555655), test_f1: 54.33% (0.543267)
Batch 120 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.573803 (previous best: 0.568689)
loss: 0.851413, dev_acc: 58.13% (0.581319), dev_f1: 57.38% (0.573803), test_acc: 56.31% (0.563115), test_f1: 55.56% (0.555598)
Epoch 8 completed in 171.50 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 1.278283, dev_acc: 49.36% (0.493584), dev_f1: 46.53% (0.465348), test_acc: 48.79% (0.487914), test_f1: 45.82% (0.458205)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.707840, dev_acc: 57.45% (0.574455), dev_f1: 56.46% (0.564587), test_acc: 56.13% (0.561325), test_f1: 55.22% (0.552174)
Batch 120 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.576603 (previous best: 0.573803)
loss: 0.783143, dev_acc: 57.83% (0.578335), dev_f1: 57.66% (0.576603), test_acc: 55.80% (0.558042), test_f1: 55.68% (0.556825)
Epoch 9 completed in 171.36 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.863442, dev_acc: 52.67% (0.526708), dev_f1: 52.73% (0.527307), test_acc: 52.55% (0.525515), test_f1: 52.59% (0.525949)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.785784, dev_acc: 56.94% (0.569382), dev_f1: 56.96% (0.569557), test_acc: 56.07% (0.560728), test_f1: 56.22% (0.562150)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.816814, dev_acc: 51.98% (0.519845), dev_f1: 49.07% (0.490735), test_acc: 51.95% (0.519546), test_f1: 49.59% (0.495854)
Epoch 10 completed in 171.25 seconds (2.85 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 1.225685, dev_acc: 44.02% (0.440167), dev_f1: 38.55% (0.385464), test_acc: 44.73% (0.447329), test_f1: 38.83% (0.388253)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 1.003713, dev_acc: 51.39% (0.513876), dev_f1: 50.38% (0.503831), test_acc: 51.81% (0.518054), test_f1: 50.46% (0.504613)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.937000, dev_acc: 57.18% (0.571770), dev_f1: 56.86% (0.568583), test_acc: 55.48% (0.554760), test_f1: 55.31% (0.553084)
Epoch 11 completed in 171.92 seconds (2.87 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.885521, dev_acc: 53.66% (0.536556), dev_f1: 50.78% (0.507751), test_acc: 51.95% (0.519546), test_f1: 49.12% (0.491212)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.842111, dev_acc: 56.28% (0.562817), dev_f1: 55.36% (0.553634), test_acc: 54.64% (0.546404), test_f1: 54.06% (0.540584)
Batch 120 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.588087 (previous best: 0.576603)
loss: 0.816693, dev_acc: 59.39% (0.593853), dev_f1: 58.81% (0.588087), test_acc: 57.12% (0.571173), test_f1: 56.81% (0.568141)
Epoch 12 completed in 171.68 seconds (2.86 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.965717, dev_acc: 46.23% (0.462250), dev_f1: 45.06% (0.450602), test_acc: 45.93% (0.459266), test_f1: 44.57% (0.445677)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.617673, dev_acc: 55.86% (0.558639), dev_f1: 55.50% (0.554979), test_acc: 54.52% (0.545210), test_f1: 54.18% (0.541812)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.718124, dev_acc: 56.94% (0.569382), dev_f1: 57.23% (0.572296), test_acc: 54.76% (0.547598), test_f1: 55.12% (0.551209)
Epoch 13 completed in 171.24 seconds (2.85 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.632714, dev_acc: 54.64% (0.546404), dev_f1: 54.47% (0.544674), test_acc: 52.82% (0.528201), test_f1: 52.88% (0.528842)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.706651, dev_acc: 54.97% (0.549687), dev_f1: 49.86% (0.498643), test_acc: 53.36% (0.533572), test_f1: 48.96% (0.489623)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.896239, dev_acc: 54.10% (0.541033), dev_f1: 50.31% (0.503068), test_acc: 52.76% (0.527604), test_f1: 48.70% (0.486994)
Epoch 14 completed in 171.51 seconds (2.86 minutes)
RESULT: Max Dev F1: 0.588087, Max Test F1: 0.568141
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/012_Nov-11-2024_03:22_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/012_Nov-11-2024_03:22_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/012_Nov-11-2024_03:22_PM/trainval_loss_curves.png
Total Completion Time: 44.41 minutes. (0.74 hours) 
