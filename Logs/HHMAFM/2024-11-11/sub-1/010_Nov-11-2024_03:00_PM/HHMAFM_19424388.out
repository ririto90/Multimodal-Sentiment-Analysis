SLURM Job ID: 19424388
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/010_Nov-11-2024_03:00_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts-balanced
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f7be2a29620>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.5
>>> weight_decay: 0.0
>>> num_epoch: 15
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/010_Nov-11-2024_03:00_PM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts-balanced dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-balanced/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-balanced/train.tsv: 399.60 seconds (6.66 minutes)
The number of problematic samples: 454
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-balanced/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-balanced/val.tsv: 135.44 seconds (2.26 minutes)
The number of problematic samples: 135
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-balanced/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-balanced/test.tsv: 169.52 seconds (2.83 minutes)
The number of problematic samples: 155
Total Training Samples: 16752
Number of Training Samples: 10050
Number of Development Samples: 3351
Number of Test Samples: 3351
Number of unique sentiment classes: 3
Building model
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.94 seconds (0.03 minutes)
New best dev_f1: 0.170112 (previous best: 0.000000)
loss: 1.115150, dev_acc: 34.26% (0.342584), dev_f1: 17.01% (0.170112), test_acc: 33.45% (0.334527), test_f1: 16.71% (0.167114)
Batch 60 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.176319 (previous best: 0.170112)
loss: 1.109969, dev_acc: 32.59% (0.325873), dev_f1: 17.63% (0.176319), test_acc: 33.09% (0.330946), test_f1: 17.85% (0.178522)
Batch 120 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.482476 (previous best: 0.176319)
loss: 1.084286, dev_acc: 51.39% (0.513876), dev_f1: 48.25% (0.482476), test_acc: 49.48% (0.494778), test_f1: 46.32% (0.463170)
Epoch 0 completed in 170.18 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 2.629489, dev_acc: 37.18% (0.371829), dev_f1: 23.44% (0.234376), test_acc: 35.39% (0.353924), test_f1: 21.56% (0.215595)
Batch 60 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.526845 (previous best: 0.482476)
loss: 0.806395, dev_acc: 54.01% (0.540137), dev_f1: 52.68% (0.526845), test_acc: 52.25% (0.522531), test_f1: 50.92% (0.509214)
Batch 120 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.529862 (previous best: 0.526845)
loss: 1.039166, dev_acc: 54.70% (0.547001), dev_f1: 52.99% (0.529862), test_acc: 53.72% (0.537153), test_f1: 51.91% (0.519150)
Epoch 1 completed in 169.53 seconds (2.83 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.941710, dev_acc: 52.94% (0.529394), dev_f1: 52.54% (0.525376), test_acc: 51.15% (0.511489), test_f1: 51.04% (0.510433)
Batch 60 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.531104 (previous best: 0.529862)
loss: 0.946095, dev_acc: 53.95% (0.539540), dev_f1: 53.11% (0.531104), test_acc: 53.18% (0.531782), test_f1: 52.28% (0.522766)
Batch 120 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.559513 (previous best: 0.531104)
loss: 0.785762, dev_acc: 55.66% (0.556550), dev_f1: 55.95% (0.559513), test_acc: 54.40% (0.544017), test_f1: 54.72% (0.547156)
Epoch 2 completed in 170.40 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.898706, dev_acc: 54.58% (0.545807), dev_f1: 53.15% (0.531483), test_acc: 53.80% (0.538048), test_f1: 51.89% (0.518950)
Batch 60 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.562134 (previous best: 0.559513)
loss: 0.894805, dev_acc: 56.76% (0.567592), dev_f1: 56.21% (0.562134), test_acc: 55.06% (0.550582), test_f1: 54.26% (0.542566)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.794975, dev_acc: 52.43% (0.524321), dev_f1: 50.94% (0.509398), test_acc: 52.34% (0.523426), test_f1: 50.37% (0.503733)
Epoch 3 completed in 170.30 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 1.035170, dev_acc: 54.49% (0.544912), dev_f1: 48.00% (0.480016), test_acc: 54.22% (0.542226), test_f1: 47.41% (0.474063)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.944003, dev_acc: 55.63% (0.556252), dev_f1: 52.95% (0.529544), test_acc: 55.18% (0.551776), test_f1: 52.93% (0.529350)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.761236, dev_acc: 57.03% (0.570278), dev_f1: 53.40% (0.533976), test_acc: 55.71% (0.557147), test_f1: 52.02% (0.520243)
Epoch 4 completed in 170.45 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 1.060097, dev_acc: 54.01% (0.540137), dev_f1: 51.38% (0.513834), test_acc: 52.61% (0.526112), test_f1: 49.65% (0.496468)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.843289, dev_acc: 53.24% (0.532378), dev_f1: 50.52% (0.505165), test_acc: 51.63% (0.516264), test_f1: 48.52% (0.485213)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.860957, dev_acc: 47.45% (0.474485), dev_f1: 46.04% (0.460433), test_acc: 46.85% (0.468517), test_f1: 45.30% (0.452970)
Epoch 5 completed in 170.02 seconds (2.83 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 1.080684, dev_acc: 49.12% (0.491197), dev_f1: 46.11% (0.461068), test_acc: 49.45% (0.494479), test_f1: 45.92% (0.459155)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.935911, dev_acc: 57.59% (0.575947), dev_f1: 55.56% (0.555624), test_acc: 55.60% (0.555953), test_f1: 53.57% (0.535728)
Batch 120 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.562973 (previous best: 0.562134)
loss: 0.848087, dev_acc: 56.25% (0.562519), dev_f1: 56.30% (0.562973), test_acc: 55.77% (0.557744), test_f1: 56.05% (0.560465)
Epoch 6 completed in 170.32 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.575240 (previous best: 0.562973)
loss: 0.681585, dev_acc: 57.33% (0.573262), dev_f1: 57.52% (0.575240), test_acc: 56.43% (0.564309), test_f1: 56.64% (0.566436)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.778746, dev_acc: 49.69% (0.496867), dev_f1: 48.94% (0.489392), test_acc: 49.27% (0.492689), test_f1: 48.61% (0.486129)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.732809, dev_acc: 57.06% (0.570576), dev_f1: 56.19% (0.561928), test_acc: 55.39% (0.553865), test_f1: 54.27% (0.542662)
Epoch 7 completed in 170.96 seconds (2.85 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.777793, dev_acc: 50.67% (0.506714), dev_f1: 50.08% (0.500797), test_acc: 50.07% (0.500746), test_f1: 49.12% (0.491193)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.808208, dev_acc: 57.45% (0.574455), dev_f1: 56.14% (0.561426), test_acc: 55.30% (0.552969), test_f1: 54.00% (0.540001)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.859779, dev_acc: 57.74% (0.577440), dev_f1: 57.38% (0.573786), test_acc: 55.36% (0.553566), test_f1: 55.03% (0.550293)
Epoch 8 completed in 170.40 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 1.722619, dev_acc: 38.82% (0.388242), dev_f1: 27.30% (0.273011), test_acc: 38.62% (0.386153), test_f1: 27.00% (0.270019)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.670078, dev_acc: 56.10% (0.561027), dev_f1: 56.13% (0.561327), test_acc: 55.51% (0.555058), test_f1: 55.57% (0.555660)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.895046, dev_acc: 58.88% (0.588779), dev_f1: 57.39% (0.573878), test_acc: 58.07% (0.580722), test_f1: 56.94% (0.569364)
Epoch 9 completed in 169.99 seconds (2.83 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.940150, dev_acc: 53.95% (0.539540), dev_f1: 53.68% (0.536809), test_acc: 53.18% (0.531782), test_f1: 52.89% (0.528916)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.836511, dev_acc: 50.34% (0.503432), dev_f1: 49.61% (0.496050), test_acc: 50.76% (0.507610), test_f1: 50.28% (0.502753)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.727954, dev_acc: 56.88% (0.568785), dev_f1: 54.62% (0.546183), test_acc: 54.85% (0.548493), test_f1: 53.11% (0.531139)
Epoch 10 completed in 170.23 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.916357, dev_acc: 47.84% (0.478365), dev_f1: 43.53% (0.435288), test_acc: 47.18% (0.471799), test_f1: 42.25% (0.422546)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.898739, dev_acc: 56.04% (0.560430), dev_f1: 54.71% (0.547145), test_acc: 54.37% (0.543718), test_f1: 52.80% (0.527981)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.841238, dev_acc: 56.25% (0.562519), dev_f1: 55.51% (0.555089), test_acc: 54.55% (0.545509), test_f1: 53.65% (0.536522)
Epoch 11 completed in 170.30 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.981291, dev_acc: 48.11% (0.481050), dev_f1: 42.78% (0.427782), test_acc: 47.03% (0.470307), test_f1: 41.50% (0.415041)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.805053, dev_acc: 55.92% (0.559236), dev_f1: 52.55% (0.525519), test_acc: 55.77% (0.557744), test_f1: 53.02% (0.530161)
Batch 120 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.586737 (previous best: 0.575240)
loss: 0.880540, dev_acc: 59.42% (0.594151), dev_f1: 58.67% (0.586737), test_acc: 56.64% (0.566398), test_f1: 56.11% (0.561071)
Epoch 12 completed in 170.35 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.820588, dev_acc: 45.99% (0.459863), dev_f1: 42.01% (0.420101), test_acc: 47.15% (0.471501), test_f1: 43.71% (0.437116)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.670673, dev_acc: 54.73% (0.547299), dev_f1: 54.15% (0.541501), test_acc: 53.03% (0.530289), test_f1: 52.37% (0.523725)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.741740, dev_acc: 57.86% (0.578633), dev_f1: 57.44% (0.574370), test_acc: 56.64% (0.566398), test_f1: 56.47% (0.564704)
Epoch 13 completed in 170.14 seconds (2.84 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.627214, dev_acc: 58.01% (0.580125), dev_f1: 57.88% (0.578817), test_acc: 55.21% (0.552074), test_f1: 55.28% (0.552785)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.704690, dev_acc: 56.91% (0.569084), dev_f1: 56.32% (0.563247), test_acc: 55.51% (0.555058), test_f1: 55.03% (0.550331)
Batch 120 completed in 0.61 seconds (0.01 minutes)
loss: 0.874798, dev_acc: 54.70% (0.547001), dev_f1: 53.30% (0.533021), test_acc: 53.95% (0.539540), test_f1: 52.77% (0.527710)
Epoch 14 completed in 170.18 seconds (2.84 minutes)
RESULT: Max Dev F1: 0.586737, Max Test F1: 0.561071
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/010_Nov-11-2024_03:00_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/010_Nov-11-2024_03:00_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/010_Nov-11-2024_03:00_PM/trainval_loss_curves.png
Total Completion Time: 54.91 minutes. (0.92 hours) 
