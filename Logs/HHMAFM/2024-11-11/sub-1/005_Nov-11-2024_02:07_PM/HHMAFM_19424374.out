SLURM Job ID: 19424374
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/005_Nov-11-2024_02:07_PM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts-undersampled
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f4748ca9620>
>>> learning_rate: 0.0003
>>> dropout_rate: 0.5
>>> weight_decay: 0.0
>>> num_epoch: 15
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/005_Nov-11-2024_02:07_PM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts-undersampled dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/train.tsv: 88.50 seconds (1.47 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/val.tsv: 36.48 seconds (0.61 minutes)
The number of problematic samples: 46
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/test.tsv: 28.63 seconds (0.48 minutes)
The number of problematic samples: 32
Total Training Samples: 4731
Number of Training Samples: 2838
Number of Development Samples: 946
Number of Test Samples: 947
Number of unique sentiment classes: 3
Building model
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.95 seconds (0.03 minutes)
New best dev_f1: 0.172801 (previous best: 0.000000)
loss: 1.076805, dev_acc: 34.99% (0.349894), dev_f1: 17.28% (0.172801), test_acc: 32.42% (0.324182), test_f1: 16.32% (0.163211)
Epoch 0 completed in 36.19 seconds (0.60 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.60 seconds (0.01 minutes)
New best dev_f1: 0.477548 (previous best: 0.172801)
loss: 0.877111, dev_acc: 47.57% (0.475687), dev_f1: 47.75% (0.477548), test_acc: 46.67% (0.466737), test_f1: 46.42% (0.464178)
Epoch 1 completed in 34.28 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.795475, dev_acc: 49.58% (0.495772), dev_f1: 45.20% (0.451984), test_acc: 48.79% (0.487856), test_f1: 45.24% (0.452374)
Epoch 2 completed in 34.58 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.540486 (previous best: 0.477548)
loss: 0.957761, dev_acc: 54.23% (0.542283), dev_f1: 54.05% (0.540486), test_acc: 51.00% (0.510032), test_f1: 51.10% (0.510958)
Epoch 3 completed in 34.59 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 1.117897, dev_acc: 52.33% (0.523256), dev_f1: 52.29% (0.522902), test_acc: 52.48% (0.524815), test_f1: 52.42% (0.524195)
Epoch 4 completed in 34.70 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.702515, dev_acc: 43.76% (0.437632), dev_f1: 41.21% (0.412068), test_acc: 48.15% (0.481521), test_f1: 45.04% (0.450391)
Epoch 5 completed in 34.46 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.764412, dev_acc: 50.21% (0.502114), dev_f1: 50.16% (0.501637), test_acc: 51.43% (0.514256), test_f1: 51.56% (0.515632)
Epoch 6 completed in 34.87 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.935497, dev_acc: 50.74% (0.507400), dev_f1: 49.10% (0.491014), test_acc: 49.31% (0.493136), test_f1: 48.40% (0.483967)
Epoch 7 completed in 34.49 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.486581, dev_acc: 50.32% (0.503171), dev_f1: 49.90% (0.498998), test_acc: 51.53% (0.515312), test_f1: 51.38% (0.513847)
Epoch 8 completed in 34.85 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.566388, dev_acc: 51.90% (0.519027), dev_f1: 49.48% (0.494784), test_acc: 47.84% (0.478353), test_f1: 46.18% (0.461792)
Epoch 9 completed in 34.75 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.365093, dev_acc: 51.69% (0.516913), dev_f1: 51.66% (0.516603), test_acc: 52.90% (0.529039), test_f1: 53.19% (0.531918)
Epoch 10 completed in 35.13 seconds (0.59 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.533793, dev_acc: 54.65% (0.546512), dev_f1: 50.40% (0.503952), test_acc: 50.48% (0.504752), test_f1: 47.23% (0.472317)
Epoch 11 completed in 34.69 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.524465, dev_acc: 49.05% (0.490486), dev_f1: 48.27% (0.482687), test_acc: 47.94% (0.479409), test_f1: 47.12% (0.471245)
Epoch 12 completed in 34.47 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.354045, dev_acc: 47.67% (0.476744), dev_f1: 44.07% (0.440663), test_acc: 46.57% (0.465681), test_f1: 43.34% (0.433370)
Epoch 13 completed in 34.79 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
Batch 0 completed in 0.71 seconds (0.01 minutes)
loss: 0.440360, dev_acc: 47.67% (0.476744), dev_f1: 47.57% (0.475693), test_acc: 47.10% (0.470961), test_f1: 47.17% (0.471745)
Epoch 14 completed in 34.85 seconds (0.58 minutes)
RESULT: Max Dev F1: 0.540486, Max Test F1: 0.510958
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/005_Nov-11-2024_02:07_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/005_Nov-11-2024_02:07_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-1/005_Nov-11-2024_02:07_PM/trainval_loss_curves.png
Total Completion Time: 11.79 minutes. (0.20 hours) 
