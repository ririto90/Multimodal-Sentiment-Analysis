HHMAFM_mfcchfusion4_mvsa-mts-undersampled_lr0.0001_dr0.5
SLURM Job ID: 19424711
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/003_Nov-11-2024_06:46_PM
> training arguments:
>>> rand_seed: 8
>>> model_fusion: mfcchfusion4
>>> dataset: mvsa-mts-undersampled
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f5406171620>
>>> learning_rate: 0.0001
>>> dropout_rate: 0.5
>>> weight_decay: 0.0
>>> num_epoch: 15
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/003_Nov-11-2024_06:46_PM
>>> model_class: <class 'models.mfcchfusion4.MFCCHFUSION4'>
Preparing mvsa-mts-undersampled dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/train.tsv: 63.88 seconds (1.06 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/val.tsv: 26.77 seconds (0.45 minutes)
The number of problematic samples: 46
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/test.tsv: 28.52 seconds (0.48 minutes)
The number of problematic samples: 32
Total Training Samples: 4731
Number of Training Samples: 2838
Number of Development Samples: 946
Number of Test Samples: 947
Number of unique sentiment classes: 3
Building model
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.82 seconds (0.03 minutes)
New best dev_f1: 0.152676 (previous best: 0.000000)
loss: 1.331073, dev_acc: 29.70% (0.297040), dev_f1: 15.27% (0.152676), test_acc: 33.90% (0.338965), test_f1: 16.88% (0.168770)
Epoch 0 completed in 36.25 seconds (0.60 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.275412 (previous best: 0.152676)
loss: 0.955978, dev_acc: 34.14% (0.341438), dev_f1: 27.54% (0.275412), test_acc: 39.60% (0.395987), test_f1: 31.40% (0.313997)
Epoch 1 completed in 34.54 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.493839 (previous best: 0.275412)
loss: 0.894609, dev_acc: 50.32% (0.503171), dev_f1: 49.38% (0.493839), test_acc: 49.52% (0.495248), test_f1: 49.12% (0.491239)
Epoch 2 completed in 35.15 seconds (0.59 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 1.078706, dev_acc: 48.52% (0.485201), dev_f1: 47.96% (0.479568), test_acc: 48.89% (0.488912), test_f1: 48.87% (0.488693)
Epoch 3 completed in 35.02 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.937643, dev_acc: 51.48% (0.514799), dev_f1: 47.05% (0.470474), test_acc: 49.84% (0.498416), test_f1: 46.14% (0.461441)
Epoch 4 completed in 35.05 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.843462, dev_acc: 48.94% (0.489429), dev_f1: 46.68% (0.466770), test_acc: 49.74% (0.497360), test_f1: 48.07% (0.480660)
Epoch 5 completed in 34.86 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.598206, dev_acc: 50.63% (0.506342), dev_f1: 46.51% (0.465133), test_acc: 49.21% (0.492080), test_f1: 45.55% (0.455484)
Epoch 6 completed in 35.08 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.889359, dev_acc: 49.68% (0.496829), dev_f1: 43.52% (0.435171), test_acc: 49.95% (0.499472), test_f1: 45.55% (0.455473)
Epoch 7 completed in 34.73 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.573800, dev_acc: 46.30% (0.463002), dev_f1: 45.83% (0.458258), test_acc: 49.00% (0.489968), test_f1: 48.63% (0.486275)
Epoch 8 completed in 35.14 seconds (0.59 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.618178, dev_acc: 50.42% (0.504228), dev_f1: 48.50% (0.485007), test_acc: 48.79% (0.487856), test_f1: 47.54% (0.475366)
Epoch 9 completed in 34.91 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.410443, dev_acc: 49.47% (0.494715), dev_f1: 47.76% (0.477604), test_acc: 49.31% (0.493136), test_f1: 48.60% (0.485953)
Epoch 10 completed in 35.02 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.441262, dev_acc: 49.47% (0.494715), dev_f1: 47.11% (0.471052), test_acc: 49.84% (0.498416), test_f1: 48.72% (0.487191)
Epoch 11 completed in 34.99 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.478543, dev_acc: 46.83% (0.468288), dev_f1: 46.79% (0.467860), test_acc: 48.47% (0.484688), test_f1: 48.45% (0.484477)
Epoch 12 completed in 34.88 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.362524, dev_acc: 49.15% (0.491543), dev_f1: 47.93% (0.479313), test_acc: 47.52% (0.475185), test_f1: 46.62% (0.466218)
Epoch 13 completed in 35.02 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.951654, dev_acc: 42.07% (0.420719), dev_f1: 39.91% (0.399109), test_acc: 44.35% (0.443506), test_f1: 41.66% (0.416632)
Epoch 14 completed in 34.77 seconds (0.58 minutes)
RESULT: Max Dev F1: 0.493839, Max Test F1: 0.491239
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/003_Nov-11-2024_06:46_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/003_Nov-11-2024_06:46_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/003_Nov-11-2024_06:46_PM/trainval_loss_curves.png
Total Completion Time: 11.18 minutes. (0.19 hours) 
