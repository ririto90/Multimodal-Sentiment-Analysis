HHMAFM_mfcchfusion4_mvsa-mts-undersampled_lr0.0005_dr0.1
SLURM Job ID: 19424710
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/002_Nov-11-2024_06:46_PM
> training arguments:
>>> rand_seed: 8
>>> model_fusion: mfcchfusion4
>>> dataset: mvsa-mts-undersampled
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7f0929aa9620>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.1
>>> weight_decay: 0.0
>>> num_epoch: 15
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/002_Nov-11-2024_06:46_PM
>>> model_class: <class 'models.mfcchfusion4.MFCCHFUSION4'>
Preparing mvsa-mts-undersampled dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/train.tsv: 96.12 seconds (1.60 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/val.tsv: 26.77 seconds (0.45 minutes)
The number of problematic samples: 46
-------------- Loading Datasets/MVSA-MTS/mvsa-mts-undersampled/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts-undersampled/test.tsv: 28.52 seconds (0.48 minutes)
The number of problematic samples: 32
Total Training Samples: 4731
Number of Training Samples: 2838
Number of Development Samples: 946
Number of Test Samples: 947
Number of unique sentiment classes: 3
Building model
n_trainable_params: 360213763, n_nontrainable_params: 0
No weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 1.84 seconds (0.03 minutes)
New best dev_f1: 0.152676 (previous best: 0.000000)
loss: 1.325320, dev_acc: 29.70% (0.297040), dev_f1: 15.27% (0.152676), test_acc: 33.90% (0.338965), test_f1: 16.88% (0.168770)
Epoch 0 completed in 36.08 seconds (0.60 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.60 seconds (0.01 minutes)
New best dev_f1: 0.323326 (previous best: 0.152676)
loss: 4.544297, dev_acc: 41.54% (0.415433), dev_f1: 32.33% (0.323326), test_acc: 40.76% (0.407603), test_f1: 32.39% (0.323903)
Epoch 1 completed in 34.28 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.324479 (previous best: 0.323326)
loss: 1.092075, dev_acc: 43.76% (0.437632), dev_f1: 32.45% (0.324479), test_acc: 40.65% (0.406547), test_f1: 31.12% (0.311195)
Epoch 2 completed in 34.67 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.342259 (previous best: 0.324479)
loss: 1.863835, dev_acc: 38.90% (0.389006), dev_f1: 34.23% (0.342259), test_acc: 41.08% (0.410771), test_f1: 34.46% (0.344561)
Epoch 3 completed in 34.59 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.394893 (previous best: 0.342259)
loss: 1.033168, dev_acc: 46.83% (0.468288), dev_f1: 39.49% (0.394893), test_acc: 46.78% (0.467793), test_f1: 40.52% (0.405177)
Epoch 4 completed in 34.63 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.494594 (previous best: 0.394893)
loss: 0.723357, dev_acc: 49.26% (0.492600), dev_f1: 49.46% (0.494594), test_acc: 50.48% (0.504752), test_f1: 50.96% (0.509612)
Epoch 5 completed in 34.36 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.562685, dev_acc: 49.37% (0.493658), dev_f1: 48.13% (0.481309), test_acc: 48.79% (0.487856), test_f1: 48.15% (0.481504)
Epoch 6 completed in 34.72 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 1.103785, dev_acc: 44.19% (0.441860), dev_f1: 38.88% (0.388769), test_acc: 43.08% (0.430834), test_f1: 38.63% (0.386285)
Epoch 7 completed in 34.45 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.553717, dev_acc: 46.72% (0.467230), dev_f1: 45.22% (0.452174), test_acc: 50.05% (0.500528), test_f1: 48.28% (0.482821)
Epoch 8 completed in 34.66 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 1.176322, dev_acc: 47.57% (0.475687), dev_f1: 44.28% (0.442849), test_acc: 46.46% (0.464625), test_f1: 43.56% (0.435558)
Epoch 9 completed in 34.57 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.440229, dev_acc: 49.47% (0.494715), dev_f1: 46.01% (0.460074), test_acc: 48.79% (0.487856), test_f1: 46.95% (0.469538)
Epoch 10 completed in 34.52 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.827354, dev_acc: 51.59% (0.515856), dev_f1: 48.79% (0.487917), test_acc: 49.74% (0.497360), test_f1: 48.16% (0.481643)
Epoch 11 completed in 34.57 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.496580 (previous best: 0.494594)
loss: 0.367525, dev_acc: 49.68% (0.496829), dev_f1: 49.66% (0.496580), test_acc: 48.36% (0.483633), test_f1: 48.54% (0.485393)
Epoch 12 completed in 34.28 seconds (0.57 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
Batch 0 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.496898 (previous best: 0.496580)
loss: 0.576133, dev_acc: 50.11% (0.501057), dev_f1: 49.69% (0.496898), test_acc: 48.68% (0.486800), test_f1: 48.69% (0.486927)
Epoch 13 completed in 34.69 seconds (0.58 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.541764, dev_acc: 47.57% (0.475687), dev_f1: 47.48% (0.474826), test_acc: 47.84% (0.478353), test_f1: 47.91% (0.479095)
Epoch 14 completed in 34.47 seconds (0.57 minutes)
RESULT: Max Dev F1: 0.496898, Max Test F1: 0.486927
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/002_Nov-11-2024_06:46_PM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/002_Nov-11-2024_06:46_PM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-11/sub-3/002_Nov-11-2024_06:46_PM/trainval_loss_curves.png
Total Completion Time: 11.62 minutes. (0.19 hours) 
