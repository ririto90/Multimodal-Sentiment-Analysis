SLURM Job ID: 19420646
Number of GPUs available: 1
Logs directory: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-10/sub-1/003_Nov-10-2024_01:54_AM
> training arguments:
>>> rand_seed: 8
>>> model_name: mfcchfusion2
>>> dataset: mvsa-mts
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7ff49dad9620>
>>> learning_rate: 0.0005
>>> dropout_rate: 0.2
>>> weight_decay: 0.0001
>>> num_epoch: 15
>>> batch_size: 64
>>> log_step: 60
>>> max_seq_len: 64
>>> polarities_dim: 3
>>> clip_grad: 5.0
>>> path_image: ./Datasets/MVSA-MTS/images-indexed
>>> crop_size: 224
>>> n_head: 8
>>> hidden_dim: 1024
>>> num_classes: 3
>>> log_dir: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-10/sub-1/003_Nov-10-2024_01:54_AM
>>> model_class: <class 'models.mfcchfusion2.MFCCHFUSION2'>
Preparing mvsa-mts dataset...
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/train.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/train.tsv: 267.84 seconds (4.46 minutes)
The number of problematic samples: 402
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/val.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/val.tsv: 88.16 seconds (1.47 minutes)
The number of problematic samples: 136
-------------- Loading Datasets/MVSA-MTS/mvsa-mts/test.tsv ---------------
Time taken to load Datasets/MVSA-MTS/mvsa-mts/test.tsv: 87.82 seconds (1.46 minutes)
The number of problematic samples: 142
Total Training Samples: 19600
Number of Training Samples: 11760
Number of Development Samples: 3920
Number of Test Samples: 3920
Number of unique sentiment classes: 3
Building model
n_trainable_params: 360213763, n_nontrainable_params: 0
Using weight decay
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
Batch 0 completed in 2.16 seconds (0.04 minutes)
New best dev_f1: 0.230675 (previous best: 0.000000)
loss: 1.260465, dev_acc: 52.91% (0.529082), dev_f1: 23.07% (0.230675), test_acc: 53.78% (0.537755), test_f1: 23.31% (0.233134)
Batch 60 completed in 0.61 seconds (0.01 minutes)
New best dev_f1: 0.252896 (previous best: 0.230675)
loss: 1.673368, dev_acc: 53.42% (0.534184), dev_f1: 25.29% (0.252896), test_acc: 53.72% (0.537245), test_f1: 24.83% (0.248272)
Batch 120 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.269447 (previous best: 0.252896)
loss: 0.938158, dev_acc: 54.59% (0.545918), dev_f1: 26.94% (0.269447), test_acc: 54.62% (0.546173), test_f1: 26.68% (0.266818)
Batch 180 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.343145 (previous best: 0.269447)
loss: 0.802199, dev_acc: 57.53% (0.575255), dev_f1: 34.31% (0.343145), test_acc: 58.01% (0.580102), test_f1: 34.78% (0.347848)
Epoch 0 completed in 224.75 seconds (3.75 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
Batch 0 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.356191 (previous best: 0.343145)
loss: 0.804066, dev_acc: 52.53% (0.525255), dev_f1: 35.62% (0.356191), test_acc: 51.45% (0.514541), test_f1: 35.04% (0.350362)
Batch 60 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.493192 (previous best: 0.356191)
loss: 0.898902, dev_acc: 57.70% (0.577041), dev_f1: 49.32% (0.493192), test_acc: 58.78% (0.587755), test_f1: 51.51% (0.515114)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.942231, dev_acc: 57.83% (0.578316), dev_f1: 39.31% (0.393062), test_acc: 58.39% (0.583929), test_f1: 40.02% (0.400232)
Batch 180 completed in 0.61 seconds (0.01 minutes)
loss: 0.693608, dev_acc: 59.21% (0.592092), dev_f1: 38.17% (0.381706), test_acc: 59.92% (0.599235), test_f1: 38.77% (0.387713)
Epoch 1 completed in 225.19 seconds (3.75 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.878261, dev_acc: 59.06% (0.590561), dev_f1: 39.12% (0.391246), test_acc: 59.57% (0.595663), test_f1: 39.28% (0.392821)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.780640, dev_acc: 51.33% (0.513265), dev_f1: 34.91% (0.349105), test_acc: 52.04% (0.520408), test_f1: 35.67% (0.356691)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.863651, dev_acc: 58.27% (0.582653), dev_f1: 39.22% (0.392223), test_acc: 59.72% (0.597194), test_f1: 40.24% (0.402409)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.850432, dev_acc: 60.13% (0.601276), dev_f1: 40.67% (0.406739), test_acc: 61.53% (0.615306), test_f1: 41.78% (0.417802)
Epoch 2 completed in 226.09 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.734702, dev_acc: 60.15% (0.601531), dev_f1: 41.57% (0.415665), test_acc: 61.71% (0.617092), test_f1: 43.53% (0.435302)
Batch 60 completed in 0.61 seconds (0.01 minutes)
loss: 0.799274, dev_acc: 56.84% (0.568367), dev_f1: 37.43% (0.374326), test_acc: 58.47% (0.584694), test_f1: 40.02% (0.400210)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.877122, dev_acc: 55.87% (0.558673), dev_f1: 45.14% (0.451376), test_acc: 56.68% (0.566837), test_f1: 46.45% (0.464451)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.686962, dev_acc: 59.39% (0.593878), dev_f1: 39.66% (0.396613), test_acc: 60.43% (0.604337), test_f1: 41.30% (0.413025)
Epoch 3 completed in 226.21 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.804158, dev_acc: 59.62% (0.596173), dev_f1: 40.67% (0.406697), test_acc: 60.51% (0.605102), test_f1: 41.11% (0.411086)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.810301, dev_acc: 57.73% (0.577296), dev_f1: 40.58% (0.405806), test_acc: 59.41% (0.594133), test_f1: 42.17% (0.421738)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.690381, dev_acc: 59.72% (0.597194), dev_f1: 40.09% (0.400905), test_acc: 61.48% (0.614796), test_f1: 42.71% (0.427073)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.818087, dev_acc: 58.42% (0.584184), dev_f1: 38.64% (0.386435), test_acc: 59.49% (0.594898), test_f1: 39.06% (0.390636)
Epoch 4 completed in 226.26 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.782171, dev_acc: 57.40% (0.573980), dev_f1: 39.18% (0.391835), test_acc: 58.98% (0.589796), test_f1: 43.32% (0.433240)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.697486, dev_acc: 57.88% (0.578827), dev_f1: 38.98% (0.389841), test_acc: 59.29% (0.592857), test_f1: 41.49% (0.414854)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.818729, dev_acc: 58.29% (0.582908), dev_f1: 40.93% (0.409325), test_acc: 60.23% (0.602296), test_f1: 44.30% (0.443009)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.649627, dev_acc: 59.49% (0.594898), dev_f1: 45.57% (0.455673), test_acc: 61.43% (0.614286), test_f1: 49.57% (0.495735)
Epoch 5 completed in 226.34 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.763834, dev_acc: 56.48% (0.564796), dev_f1: 46.80% (0.468046), test_acc: 57.45% (0.574490), test_f1: 47.74% (0.477395)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.694353, dev_acc: 57.65% (0.576531), dev_f1: 48.63% (0.486332), test_acc: 58.14% (0.581378), test_f1: 51.12% (0.511151)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.837840, dev_acc: 58.14% (0.581378), dev_f1: 41.78% (0.417762), test_acc: 60.51% (0.605102), test_f1: 46.04% (0.460431)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.879390, dev_acc: 57.70% (0.577041), dev_f1: 46.22% (0.462176), test_acc: 58.06% (0.580612), test_f1: 47.96% (0.479634)
Epoch 6 completed in 226.11 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.846016, dev_acc: 57.27% (0.572704), dev_f1: 36.25% (0.362520), test_acc: 58.37% (0.583673), test_f1: 38.35% (0.383516)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.667369, dev_acc: 57.45% (0.574490), dev_f1: 37.24% (0.372354), test_acc: 60.66% (0.606633), test_f1: 43.13% (0.431312)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 1.051417, dev_acc: 56.35% (0.563520), dev_f1: 33.45% (0.334499), test_acc: 57.81% (0.578061), test_f1: 35.68% (0.356847)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.800922, dev_acc: 59.69% (0.596939), dev_f1: 40.95% (0.409496), test_acc: 60.94% (0.609439), test_f1: 43.72% (0.437234)
Epoch 7 completed in 226.21 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.873488, dev_acc: 55.71% (0.557143), dev_f1: 42.22% (0.422212), test_acc: 56.71% (0.567092), test_f1: 44.80% (0.448030)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.854696, dev_acc: 58.52% (0.585204), dev_f1: 48.88% (0.488756), test_acc: 59.72% (0.597194), test_f1: 51.02% (0.510167)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.819552, dev_acc: 59.16% (0.591582), dev_f1: 41.79% (0.417877), test_acc: 59.82% (0.598214), test_f1: 44.66% (0.446638)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.636957, dev_acc: 55.77% (0.557653), dev_f1: 31.89% (0.318856), test_acc: 57.55% (0.575510), test_f1: 33.93% (0.339348)
Epoch 8 completed in 226.34 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.698209, dev_acc: 59.13% (0.591327), dev_f1: 44.26% (0.442570), test_acc: 60.94% (0.609439), test_f1: 48.54% (0.485403)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.663504, dev_acc: 58.67% (0.586735), dev_f1: 42.01% (0.420075), test_acc: 60.46% (0.604592), test_f1: 45.68% (0.456837)
Batch 120 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.495539 (previous best: 0.493192)
loss: 0.731862, dev_acc: 59.03% (0.590306), dev_f1: 49.55% (0.495539), test_acc: 60.03% (0.600255), test_f1: 50.85% (0.508527)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.861218, dev_acc: 57.93% (0.579337), dev_f1: 45.42% (0.454240), test_acc: 59.54% (0.595408), test_f1: 48.41% (0.484138)
Epoch 9 completed in 226.35 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
Batch 0 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.510918 (previous best: 0.495539)
loss: 0.795637, dev_acc: 60.56% (0.605612), dev_f1: 51.09% (0.510918), test_acc: 61.71% (0.617092), test_f1: 52.52% (0.525166)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.691368, dev_acc: 58.29% (0.582908), dev_f1: 45.48% (0.454772), test_acc: 60.15% (0.601531), test_f1: 48.44% (0.484422)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.798252, dev_acc: 60.38% (0.603827), dev_f1: 50.99% (0.509862), test_acc: 59.95% (0.599490), test_f1: 50.83% (0.508315)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.718107, dev_acc: 60.28% (0.602806), dev_f1: 45.38% (0.453762), test_acc: 61.20% (0.611990), test_f1: 48.93% (0.489301)
Epoch 10 completed in 226.12 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
Batch 0 completed in 0.62 seconds (0.01 minutes)
New best dev_f1: 0.511680 (previous best: 0.510918)
loss: 0.766191, dev_acc: 57.86% (0.578571), dev_f1: 51.17% (0.511680), test_acc: 57.70% (0.577041), test_f1: 51.73% (0.517317)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.711926, dev_acc: 59.01% (0.590051), dev_f1: 41.01% (0.410127), test_acc: 60.20% (0.602041), test_f1: 43.04% (0.430399)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.720196, dev_acc: 57.37% (0.573724), dev_f1: 48.63% (0.486350), test_acc: 58.44% (0.584439), test_f1: 50.01% (0.500122)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.968846, dev_acc: 58.37% (0.583673), dev_f1: 49.68% (0.496778), test_acc: 58.57% (0.585714), test_f1: 49.48% (0.494792)
Epoch 11 completed in 226.37 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.704746, dev_acc: 56.58% (0.565816), dev_f1: 47.16% (0.471643), test_acc: 57.30% (0.572959), test_f1: 48.23% (0.482326)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.628899, dev_acc: 57.04% (0.570408), dev_f1: 44.38% (0.443834), test_acc: 58.37% (0.583673), test_f1: 46.61% (0.466095)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.795200, dev_acc: 57.30% (0.572959), dev_f1: 40.22% (0.402168), test_acc: 57.63% (0.576276), test_f1: 40.67% (0.406723)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.829894, dev_acc: 59.82% (0.598214), dev_f1: 45.83% (0.458329), test_acc: 61.30% (0.613010), test_f1: 49.23% (0.492338)
Epoch 12 completed in 226.17 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
Batch 0 completed in 0.62 seconds (0.01 minutes)
loss: 0.798602, dev_acc: 59.36% (0.593622), dev_f1: 44.31% (0.443124), test_acc: 60.87% (0.608673), test_f1: 47.84% (0.478388)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.849061, dev_acc: 56.66% (0.566582), dev_f1: 44.16% (0.441570), test_acc: 57.40% (0.573980), test_f1: 47.58% (0.475790)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.961719, dev_acc: 55.74% (0.557398), dev_f1: 44.49% (0.444885), test_acc: 57.45% (0.574490), test_f1: 47.03% (0.470306)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.970935, dev_acc: 55.28% (0.552806), dev_f1: 37.40% (0.374006), test_acc: 57.53% (0.575255), test_f1: 41.33% (0.413268)
Epoch 13 completed in 226.15 seconds (3.77 minutes)
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
Batch 0 completed in 0.61 seconds (0.01 minutes)
loss: 0.639853, dev_acc: 56.76% (0.567602), dev_f1: 40.68% (0.406833), test_acc: 59.77% (0.597704), test_f1: 44.91% (0.449132)
Batch 60 completed in 0.62 seconds (0.01 minutes)
loss: 0.706750, dev_acc: 56.02% (0.560204), dev_f1: 42.26% (0.422613), test_acc: 58.95% (0.589541), test_f1: 47.72% (0.477150)
Batch 120 completed in 0.62 seconds (0.01 minutes)
loss: 0.755291, dev_acc: 58.93% (0.589286), dev_f1: 41.62% (0.416164), test_acc: 60.79% (0.607908), test_f1: 45.26% (0.452606)
Batch 180 completed in 0.62 seconds (0.01 minutes)
loss: 0.749654, dev_acc: 56.20% (0.561990), dev_f1: 42.24% (0.422392), test_acc: 58.27% (0.582653), test_f1: 45.27% (0.452657)
Epoch 14 completed in 226.23 seconds (3.77 minutes)
RESULT: Max Dev F1: 0.511680, Max Test F1: 0.517317
Training complete. Generating confusion matrix on the test set.
Confusion matrix saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-10/sub-1/003_Nov-10-2024_01:54_AM/confusion_matrix.png
Reading TensorBoard loss at each epoch:
Available tags: {'images': [], 'audio': [], 'histograms': [], 'scalars': ['Loss/train', 'Loss/val'], 'distributions': [], 'tensors': [], 'graph': False, 'meta_graph': False, 'run_metadata': []}
Output File: /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-10/sub-1/003_Nov-10-2024_01:54_AM/trainval_loss_curves.png
Training and validation loss curves saved to /home/rgg2706/Multimodal-Sentiment-Analysis/Logs/HHMAFM/2024-11-10/sub-1/003_Nov-10-2024_01:54_AM/trainval_loss_curves.png
Total Completion Time: 64.51 minutes. (1.08 hours) 
