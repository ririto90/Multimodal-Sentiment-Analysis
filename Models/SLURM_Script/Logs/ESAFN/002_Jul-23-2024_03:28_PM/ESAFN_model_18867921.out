PyTorch version: 2.1.1
CUDA available: True
CUDA version: 12.3
True
1
0
NVIDIA A100-PCIE-40GB
************no tfn layer************
> training arguments:
>>> rand_seed: 28
>>> model_name: mmfusion
>>> dataset: twitter
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fe11ec7dee0>
>>> learning_rate: 0.001
>>> dropout_rate: 0.5
>>> num_epoch: 100
>>> batch_size: 70
>>> log_step: 50
>>> logdir: log
>>> embed_dim: 100
>>> hidden_dim: 100
>>> max_seq_len: 27
>>> polarities_dim: 3
>>> hops: 3
>>> att_file: ./att_file/
>>> pred_file: ./pred_file/
>>> clip_grad: 5.0
>>> path_image: ../../Datasets/IJCAI2019_data/twitter2017_images
>>> crop_size: 224
>>> fine_tune_cnn: False
>>> att_mode: vis_concat_attimg_gate
>>> resnet_root: ./resnet
>>> checkpoint: ./checkpoint/
>>> load_check_point: False
>>> load_opt: False
>>> tfn: False
>>> model_class: <class 'models.mmfusion.MMFUSION'>
>>> inputs_cols: ['text_left_indicator', 'text_right_indicator', 'aspect_indices']
>>> device: cuda
Before model allocation:
Allocated: 0.00 MB
Cached:    0.00 MB
preparing twitter dataset...
loading word vectors...
building embedding_matrix: 100_twitter_embedding_matrix.dat
--------------./datasets/twitter/train.txt---------------
the number of problematic samples: 134
--------------./datasets/twitter/dev.txt---------------
the number of problematic samples: 29
--------------./datasets/twitter/test.txt---------------
the number of problematic samples: 62
building model
Before absa_dataset allocation:
Allocated: 230.28 MB
Cached:    244.00 MB
After model allocation:
Allocated: 238.11 MB
Cached:    268.00 MB
MMFUSION(
  (embed): Embedding(8490, 100)
  (lstm_aspect): DynamicLSTM(
    (RNN): LSTM(100, 100, batch_first=True)
  )
  (lstm_l): DynamicLSTM(
    (RNN): LSTM(100, 100, batch_first=True)
  )
  (lstm_r): DynamicLSTM(
    (RNN): LSTM(100, 100, batch_first=True)
  )
  (attention_l): Attention2(
    (proj): Linear(in_features=100, out_features=100, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (attention_r): Attention2(
    (proj): Linear(in_features=100, out_features=100, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (visaspect_att_l): MMAttention(
    (proj): Linear(in_features=100, out_features=100, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (visaspect_att_r): MMAttention(
    (proj): Linear(in_features=100, out_features=100, bias=True)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (ltext2hidden): Linear(in_features=100, out_features=100, bias=True)
  (laspect2hidden): Linear(in_features=100, out_features=100, bias=True)
  (rtext2hidden): Linear(in_features=100, out_features=100, bias=True)
  (raspect2hidden): Linear(in_features=100, out_features=100, bias=True)
  (dropout): Dropout(p=0.5, inplace=False)
  (aspect2text): Linear(in_features=100, out_features=100, bias=True)
  (vismap2text): Linear(in_features=2048, out_features=100, bias=True)
  (vis2text): Linear(in_features=2048, out_features=100, bias=True)
  (gate): Linear(in_features=2448, out_features=100, bias=True)
  (madality_attetion): Linear(in_features=100, out_features=1, bias=True)
  (text2hiddenvis): Linear(in_features=400, out_features=100, bias=True)
  (vis2hiddenvis): Linear(in_features=100, out_features=100, bias=True)
  (dense_6): Linear(in_features=600, out_features=3, bias=True)
)
n_trainable_params: 1200104, n_nontrainable_params: 849000
parameters only include text parts without word embeddings
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  0
loss: 0.8588, acc: 0.6359, dev_acc: 0.6037, test_acc: 0.6135
dev_f1: 0.4491, test_f1: 0.4514
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  1
loss: 0.9282, acc: 0.6786, dev_acc: 0.6267, test_acc: 0.6402
dev_f1: 0.5269, test_f1: 0.5391
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  2
loss: 0.7568, acc: 0.7226, dev_acc: 0.6327, test_acc: 0.6556
dev_f1: 0.5638, test_f1: 0.6063
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  3
loss: 0.6404, acc: 0.7532, dev_acc: 0.6216, test_acc: 0.6653
dev_f1: 0.5555, test_f1: 0.6184
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  4
loss: 0.6389, acc: 0.7793, dev_acc: 0.6327, test_acc: 0.6556
dev_f1: 0.5620, test_f1: 0.6141
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  5
loss: 0.5482, acc: 0.7993, dev_acc: 0.6182, test_acc: 0.6524
dev_f1: 0.5575, test_f1: 0.6187
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  6
loss: 0.5183, acc: 0.8675, dev_acc: 0.6131, test_acc: 0.6532
dev_f1: 0.5442, test_f1: 0.6052
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  7
loss: 0.4055, acc: 0.8914, dev_acc: 0.6369, test_acc: 0.6191
dev_f1: 0.5696, test_f1: 0.5600
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  8
loss: 0.4063, acc: 0.9225, dev_acc: 0.6182, test_acc: 0.6321
dev_f1: 0.5768, test_f1: 0.5992
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  9
loss: 0.2644, acc: 0.9141, dev_acc: 0.6190, test_acc: 0.6151
dev_f1: 0.5476, test_f1: 0.5608
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  10
loss: 0.1968, acc: 0.9486, dev_acc: 0.6207, test_acc: 0.6313
dev_f1: 0.5721, test_f1: 0.5889
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  11
loss: 0.2810, acc: 0.9700, dev_acc: 0.6148, test_acc: 0.6175
dev_f1: 0.5705, test_f1: 0.5836
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  12
loss: 0.1208, acc: 0.9773, dev_acc: 0.6080, test_acc: 0.6110
dev_f1: 0.5619, test_f1: 0.5641
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  13
loss: 0.0501, acc: 0.9742, dev_acc: 0.6088, test_acc: 0.6232
dev_f1: 0.5553, test_f1: 0.5749
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  14
loss: 0.0457, acc: 0.9781, dev_acc: 0.6003, test_acc: 0.6394
dev_f1: 0.5534, test_f1: 0.5937
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  15
loss: 0.0995, acc: 0.9874, dev_acc: 0.6080, test_acc: 0.6288
dev_f1: 0.5597, test_f1: 0.5786
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  16
loss: 0.0288, acc: 0.9941, dev_acc: 0.6063, test_acc: 0.6207
dev_f1: 0.5679, test_f1: 0.5715
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  17
loss: 0.1000, acc: 0.9919, dev_acc: 0.5901, test_acc: 0.6321
dev_f1: 0.5295, test_f1: 0.5724
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  18
loss: 0.0605, acc: 0.9938, dev_acc: 0.6054, test_acc: 0.6313
dev_f1: 0.5354, test_f1: 0.5729
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  19
loss: 0.0562, acc: 0.9896, dev_acc: 0.5969, test_acc: 0.6248
dev_f1: 0.5440, test_f1: 0.5791
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  20
loss: 0.0571, acc: 0.9944, dev_acc: 0.5901, test_acc: 0.6394
dev_f1: 0.5249, test_f1: 0.5782
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  21
loss: 0.0164, acc: 0.9935, dev_acc: 0.6046, test_acc: 0.6288
dev_f1: 0.5685, test_f1: 0.5980
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  22
loss: 0.1289, acc: 0.9955, dev_acc: 0.6012, test_acc: 0.6280
dev_f1: 0.5399, test_f1: 0.5789
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  23
loss: 0.0095, acc: 0.9983, dev_acc: 0.6046, test_acc: 0.6402
dev_f1: 0.5516, test_f1: 0.5967
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  24
loss: 0.0465, acc: 0.9989, dev_acc: 0.6054, test_acc: 0.6370
dev_f1: 0.5573, test_f1: 0.5980
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  25
loss: 0.0108, acc: 0.9949, dev_acc: 0.5867, test_acc: 0.6118
dev_f1: 0.5594, test_f1: 0.5777
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  26
loss: 0.0165, acc: 0.9899, dev_acc: 0.6063, test_acc: 0.6329
dev_f1: 0.5642, test_f1: 0.5967
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  27
loss: 0.0310, acc: 0.9964, dev_acc: 0.6114, test_acc: 0.6370
dev_f1: 0.5694, test_f1: 0.5977
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  28
loss: 0.0110, acc: 0.9972, dev_acc: 0.6165, test_acc: 0.6459
dev_f1: 0.5649, test_f1: 0.6011
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  29
loss: 0.0058, acc: 0.9980, dev_acc: 0.6190, test_acc: 0.6451
dev_f1: 0.5562, test_f1: 0.5918
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  30
loss: 0.1123, acc: 0.9983, dev_acc: 0.5995, test_acc: 0.6442
dev_f1: 0.5475, test_f1: 0.5996
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  31
loss: 0.0896, acc: 0.9978, dev_acc: 0.6012, test_acc: 0.6345
dev_f1: 0.5489, test_f1: 0.5888
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  32
loss: 0.0084, acc: 0.9952, dev_acc: 0.6080, test_acc: 0.6524
dev_f1: 0.5366, test_f1: 0.5868
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  33
loss: 0.0277, acc: 0.9972, dev_acc: 0.5901, test_acc: 0.6313
dev_f1: 0.5359, test_f1: 0.5851
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  34
loss: 0.0113, acc: 0.9989, dev_acc: 0.6063, test_acc: 0.6418
dev_f1: 0.5629, test_f1: 0.6024
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  35
loss: 0.0023, acc: 0.9989, dev_acc: 0.6037, test_acc: 0.6410
dev_f1: 0.5471, test_f1: 0.5898
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  36
loss: 0.0080, acc: 0.9992, dev_acc: 0.6122, test_acc: 0.6394
dev_f1: 0.5637, test_f1: 0.5965
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  37
loss: 0.0968, acc: 0.9969, dev_acc: 0.5986, test_acc: 0.6305
dev_f1: 0.5498, test_f1: 0.5916
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  38
loss: 0.0213, acc: 0.9964, dev_acc: 0.5910, test_acc: 0.6126
dev_f1: 0.5436, test_f1: 0.5745
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  39
loss: 0.0203, acc: 0.9916, dev_acc: 0.6012, test_acc: 0.6183
dev_f1: 0.5665, test_f1: 0.5808
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  40
loss: 0.0046, acc: 0.9969, dev_acc: 0.5995, test_acc: 0.6394
dev_f1: 0.5633, test_f1: 0.6019
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  41
loss: 0.0012, acc: 0.9994, dev_acc: 0.5944, test_acc: 0.6297
dev_f1: 0.5343, test_f1: 0.5749
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  42
loss: 0.0040, acc: 0.9994, dev_acc: 0.6097, test_acc: 0.6507
dev_f1: 0.5641, test_f1: 0.6071
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  43
loss: 0.0011, acc: 0.9997, dev_acc: 0.6241, test_acc: 0.6451
dev_f1: 0.5758, test_f1: 0.5944
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  44
loss: 0.0042, acc: 1.0000, dev_acc: 0.6088, test_acc: 0.6378
dev_f1: 0.5676, test_f1: 0.5921
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  45
loss: 0.0007, acc: 1.0000, dev_acc: 0.6148, test_acc: 0.6370
dev_f1: 0.5628, test_f1: 0.5856
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  46
loss: 0.0054, acc: 0.9992, dev_acc: 0.6012, test_acc: 0.6264
dev_f1: 0.5621, test_f1: 0.5859
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  47
loss: 0.0009, acc: 0.9992, dev_acc: 0.6165, test_acc: 0.6410
dev_f1: 0.5648, test_f1: 0.5926
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  48
loss: 0.0441, acc: 0.9978, dev_acc: 0.5927, test_acc: 0.6499
dev_f1: 0.5486, test_f1: 0.6038
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  49
loss: 0.0386, acc: 0.9949, dev_acc: 0.6054, test_acc: 0.6216
dev_f1: 0.5535, test_f1: 0.5567
loss: 0.0188, acc: 0.9916, dev_acc: 0.6173, test_acc: 0.6418
dev_f1: 0.5602, test_f1: 0.5967
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  50
loss: 0.1102, acc: 0.9944, dev_acc: 0.6029, test_acc: 0.6337
dev_f1: 0.5623, test_f1: 0.5959
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  51
loss: 0.0157, acc: 0.9969, dev_acc: 0.6012, test_acc: 0.6394
dev_f1: 0.5477, test_f1: 0.5924
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  52
loss: 0.0241, acc: 0.9986, dev_acc: 0.6173, test_acc: 0.6451
dev_f1: 0.5628, test_f1: 0.5905
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  53
loss: 0.0115, acc: 0.9972, dev_acc: 0.6148, test_acc: 0.6321
dev_f1: 0.5625, test_f1: 0.5855
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  54
loss: 0.0166, acc: 0.9975, dev_acc: 0.6301, test_acc: 0.6442
dev_f1: 0.5770, test_f1: 0.5978
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  55
loss: 0.0242, acc: 0.9958, dev_acc: 0.5935, test_acc: 0.6402
dev_f1: 0.5553, test_f1: 0.6060
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  56
loss: 0.0102, acc: 0.9969, dev_acc: 0.6284, test_acc: 0.6426
dev_f1: 0.5723, test_f1: 0.6005
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  57
loss: 0.0008, acc: 0.9955, dev_acc: 0.6131, test_acc: 0.6370
dev_f1: 0.5656, test_f1: 0.5982
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  58
loss: 0.0371, acc: 0.9992, dev_acc: 0.6233, test_acc: 0.6370
dev_f1: 0.5754, test_f1: 0.5925
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  59
loss: 0.0435, acc: 1.0000, dev_acc: 0.6165, test_acc: 0.6394
dev_f1: 0.5682, test_f1: 0.5901
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  60
loss: 0.0082, acc: 0.9989, dev_acc: 0.6224, test_acc: 0.6434
dev_f1: 0.5661, test_f1: 0.6023
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  61
loss: 0.0092, acc: 0.9994, dev_acc: 0.6190, test_acc: 0.6483
dev_f1: 0.5658, test_f1: 0.5982
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  62
loss: 0.0006, acc: 1.0000, dev_acc: 0.6224, test_acc: 0.6418
dev_f1: 0.5715, test_f1: 0.5944
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  63
loss: 0.0072, acc: 0.9997, dev_acc: 0.6199, test_acc: 0.6434
dev_f1: 0.5759, test_f1: 0.5980
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  64
loss: 0.0047, acc: 0.9992, dev_acc: 0.6182, test_acc: 0.6491
dev_f1: 0.5666, test_f1: 0.5950
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  65
loss: 0.0067, acc: 0.9972, dev_acc: 0.6088, test_acc: 0.6321
dev_f1: 0.5712, test_f1: 0.5913
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  66
loss: 0.0676, acc: 0.9958, dev_acc: 0.6156, test_acc: 0.6264
dev_f1: 0.5673, test_f1: 0.5766
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  67
loss: 0.0112, acc: 0.9941, dev_acc: 0.6250, test_acc: 0.6402
dev_f1: 0.5703, test_f1: 0.5848
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  68
loss: 0.0019, acc: 0.9964, dev_acc: 0.6318, test_acc: 0.6515
dev_f1: 0.5781, test_f1: 0.6077
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  69
loss: 0.1337, acc: 0.9992, dev_acc: 0.6250, test_acc: 0.6394
dev_f1: 0.5544, test_f1: 0.5944
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  70
loss: 0.0067, acc: 0.9994, dev_acc: 0.6139, test_acc: 0.6361
dev_f1: 0.5480, test_f1: 0.5755
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  71
loss: 0.0023, acc: 1.0000, dev_acc: 0.6012, test_acc: 0.6280
dev_f1: 0.5507, test_f1: 0.5840
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  72
loss: 0.0009, acc: 0.9994, dev_acc: 0.6037, test_acc: 0.6426
dev_f1: 0.5434, test_f1: 0.5922
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  73
loss: 0.0084, acc: 0.9997, dev_acc: 0.6054, test_acc: 0.6288
dev_f1: 0.5467, test_f1: 0.5810
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  74
loss: 0.0175, acc: 0.9952, dev_acc: 0.6080, test_acc: 0.6353
dev_f1: 0.5300, test_f1: 0.5645
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  75
loss: 0.0030, acc: 0.9888, dev_acc: 0.6284, test_acc: 0.6426
dev_f1: 0.5352, test_f1: 0.5580
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  76
loss: 0.0114, acc: 0.9986, dev_acc: 0.6003, test_acc: 0.6353
dev_f1: 0.5502, test_f1: 0.5830
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  77
loss: 0.0342, acc: 1.0000, dev_acc: 0.6029, test_acc: 0.6353
dev_f1: 0.5421, test_f1: 0.5826
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  78
loss: 0.0001, acc: 0.9997, dev_acc: 0.6020, test_acc: 0.6345
dev_f1: 0.5532, test_f1: 0.5839
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  79
loss: 0.0400, acc: 0.9955, dev_acc: 0.6207, test_acc: 0.6434
dev_f1: 0.5677, test_f1: 0.5996
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  80
loss: 0.0037, acc: 0.9978, dev_acc: 0.6131, test_acc: 0.6240
dev_f1: 0.5667, test_f1: 0.5844
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  81
loss: 0.0078, acc: 0.9978, dev_acc: 0.6131, test_acc: 0.6337
dev_f1: 0.5644, test_f1: 0.5856
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  82
loss: 0.0006, acc: 0.9986, dev_acc: 0.6071, test_acc: 0.6216
dev_f1: 0.5602, test_f1: 0.5759
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  83
loss: 0.0077, acc: 0.9958, dev_acc: 0.6012, test_acc: 0.6256
dev_f1: 0.5484, test_f1: 0.5798
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  84
loss: 0.0199, acc: 0.9978, dev_acc: 0.6276, test_acc: 0.6361
dev_f1: 0.5731, test_f1: 0.5793
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  85
loss: 0.0028, acc: 0.9978, dev_acc: 0.6216, test_acc: 0.6483
dev_f1: 0.5745, test_f1: 0.6001
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  86
loss: 0.0164, acc: 0.9986, dev_acc: 0.6301, test_acc: 0.6434
dev_f1: 0.5872, test_f1: 0.6028
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  87
loss: 0.0153, acc: 0.9986, dev_acc: 0.6182, test_acc: 0.6370
dev_f1: 0.5790, test_f1: 0.5933
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  88
loss: 0.0035, acc: 1.0000, dev_acc: 0.6207, test_acc: 0.6434
dev_f1: 0.5738, test_f1: 0.6009
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  89
loss: 0.0007, acc: 0.9992, dev_acc: 0.6310, test_acc: 0.6475
dev_f1: 0.5716, test_f1: 0.5894
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  90
loss: 0.0012, acc: 0.9997, dev_acc: 0.6216, test_acc: 0.6499
dev_f1: 0.5681, test_f1: 0.5963
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  91
loss: 0.0005, acc: 1.0000, dev_acc: 0.6276, test_acc: 0.6459
dev_f1: 0.5798, test_f1: 0.6002
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  92
loss: 0.0045, acc: 1.0000, dev_acc: 0.6241, test_acc: 0.6418
dev_f1: 0.5734, test_f1: 0.5995
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  93
loss: 0.0007, acc: 1.0000, dev_acc: 0.6216, test_acc: 0.6394
dev_f1: 0.5747, test_f1: 0.6007
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  94
loss: 0.0011, acc: 1.0000, dev_acc: 0.6165, test_acc: 0.6491
dev_f1: 0.5647, test_f1: 0.5966
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  95
loss: 0.0001, acc: 1.0000, dev_acc: 0.6199, test_acc: 0.6491
dev_f1: 0.5681, test_f1: 0.5950
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  96
loss: 0.0038, acc: 1.0000, dev_acc: 0.6250, test_acc: 0.6394
dev_f1: 0.5794, test_f1: 0.5960
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  97
loss: 0.0101, acc: 0.9994, dev_acc: 0.6054, test_acc: 0.6280
dev_f1: 0.5614, test_f1: 0.5833
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  98
loss: 0.0023, acc: 0.9975, dev_acc: 0.6293, test_acc: 0.6337
dev_f1: 0.5862, test_f1: 0.5906
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch:  99
loss: 0.0005, acc: 0.9952, dev_acc: 0.6046, test_acc: 0.6394
dev_f1: 0.5587, test_f1: 0.6013
loss: 0.0041, acc: 0.9930, dev_acc: 0.5918, test_acc: 0.6256
dev_f1: 0.5564, test_f1: 0.5854
max_dev_acc: 0.6369047619047619, test_acc: 0.6191247974068071
dev_p: 0.5986209985996721, dev_r: 0.5573187288432072, dev_f1: 0.5696192608306946, test_p: 0.5960043147543148, test_r: 0.5485341485694596, test_f1: 0.5600128176665408
